var e=Object.defineProperty,s=(s,t,a)=>((s,t,a)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a)(s,"symbol"!=typeof t?t+"":t,a);import{r as t,a,L as r,R as n,B as i,b as l,d as c,N as o}from"./vendor.DbhSSfjJ.js";import{c as d}from"./state._4fsKBsk.js";import{S as m,E as x,a as h,L as u,T as p,B as g,M as f,D as y,C as j,b,R as N,c as v,d as w,X as C,Y as k,e as _,f as S,P as T,g as A,h as E,i as R,j as L,k as I,A as M,l as P,m as D,n as O,o as $,p as B,q,Z as F,U,r as z,s as W,t as V,u as H,v as G,w as K,x as J,y as Q,z as Y,Q as X,F as Z,G as ee,H as se,I as te,J as ae,K as re,N as ne,O as ie,V as le,W as ce,_ as oe,$ as de,a0 as me,a1 as xe,a2 as he,a3 as ue,a4 as pe,a5 as ge,a6 as fe,a7 as ye,a8 as je,a9 as be,aa as Ne,ab as ve,ac as we,ad as Ce,ae as ke,af as _e,ag as Se,ah as Te,ai as Ae,aj as Ee,ak as Re,al as Le,am as Ie,an as Me,ao as Pe,ap as De,aq as Oe,ar as $e,as as Be,at as qe,au as Fe,av as Ue,aw as ze,ax as We,ay as Ve,az as He,aA as Ge,aB as Ke,aC as Je,aD as Qe,aE as Ye,aF as Xe,aG as Ze,aH as es,aI as ss,aJ as ts,aK as as,aL as rs,aM as ns,aN as is,aO as ls,aP as cs,aQ as os,aR as ds,aS as ms,aT as xs,aU as hs,aV as us}from"./ui.Dw2P1Ywb.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&s(e)}).observe(document,{childList:!0,subtree:!0})}function s(e){if(e.ep)return;e.ep=!0;const s=function(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?s.credentials="include":"anonymous"===e.crossOrigin?s.credentials="omit":s.credentials="same-origin",s}(e);fetch(e.href,s)}}();var ps={exports:{}},gs={},fs=t,ys=Symbol.for("react.element"),js=Symbol.for("react.fragment"),bs=Object.prototype.hasOwnProperty,Ns=fs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,vs={key:!0,ref:!0,__self:!0,__source:!0};function ws(e,s,t){var a,r={},n=null,i=null;for(a in void 0!==t&&(n=""+t),void 0!==s.key&&(n=""+s.key),void 0!==s.ref&&(i=s.ref),s)bs.call(s,a)&&!vs.hasOwnProperty(a)&&(r[a]=s[a]);if(e&&e.defaultProps)for(a in s=e.defaultProps)void 0===r[a]&&(r[a]=s[a]);return{$$typeof:ys,type:e,key:n,ref:i,props:r,_owner:Ns.current}}gs.Fragment=js,gs.jsx=ws,gs.jsxs=ws,ps.exports=gs;var Cs,ks=ps.exports,_s=a;Cs=_s.createRoot,_s.hydrateRoot;function Ss(e,s){let t;try{t=e()}catch(a){return}return{getItem:e=>{var s;const a=e=>null===e?null:JSON.parse(e,void 0),r=null!=(s=t.getItem(e))?s:null;return r instanceof Promise?r.then(a):a(r)},setItem:(e,s)=>t.setItem(e,JSON.stringify(s,void 0)),removeItem:e=>t.removeItem(e)}}const Ts=e=>s=>{try{const t=e(s);return t instanceof Promise?t:{then:e=>Ts(e)(t),catch(e){return this}}}catch(t){return{then(e){return this},catch:e=>Ts(e)(t)}}},As=(e,s)=>"getStorage"in s||"serialize"in s||"deserialize"in s?((e,s)=>(t,a,r)=>{let n={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:e=>e,version:0,merge:(e,s)=>({...s,...e}),...s},i=!1;const l=new Set,c=new Set;let o;try{o=n.getStorage()}catch(g){}if(!o)return e((...e)=>{t(...e)},a,r);const d=Ts(n.serialize),m=()=>{const e=n.partialize({...a()});let s;const t=d({state:e,version:n.version}).then(e=>o.setItem(n.name,e)).catch(e=>{s=e});if(s)throw s;return t},x=r.setState;r.setState=(e,s)=>{x(e,s),m()};const h=e((...e)=>{t(...e),m()},a,r);let u;const p=()=>{var e;if(!o)return;i=!1,l.forEach(e=>e(a()));const s=(null==(e=n.onRehydrateStorage)?void 0:e.call(n,a()))||void 0;return Ts(o.getItem.bind(o))(n.name).then(e=>{if(e)return n.deserialize(e)}).then(e=>{if(e){if("number"!=typeof e.version||e.version===n.version)return e.state;if(n.migrate)return n.migrate(e.state,e.version)}}).then(e=>{var s;return u=n.merge(e,null!=(s=a())?s:h),t(u,!0),m()}).then(()=>{null==s||s(u,void 0),i=!0,c.forEach(e=>e(u))}).catch(e=>{null==s||s(void 0,e)})};return r.persist={setOptions:e=>{n={...n,...e},e.getStorage&&(o=e.getStorage())},clearStorage:()=>{null==o||o.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>p(),hasHydrated:()=>i,onHydrate:e=>(l.add(e),()=>{l.delete(e)}),onFinishHydration:e=>(c.add(e),()=>{c.delete(e)})},p(),u||h})(e,s):((e,s)=>(t,a,r)=>{let n={storage:Ss(()=>localStorage),partialize:e=>e,version:0,merge:(e,s)=>({...s,...e}),...s},i=!1;const l=new Set,c=new Set;let o=n.storage;if(!o)return e((...e)=>{t(...e)},a,r);const d=()=>{const e=n.partialize({...a()});return o.setItem(n.name,{state:e,version:n.version})},m=r.setState;r.setState=(e,s)=>{m(e,s),d()};const x=e((...e)=>{t(...e),d()},a,r);let h;r.getInitialState=()=>x;const u=()=>{var e,s;if(!o)return;i=!1,l.forEach(e=>{var s;return e(null!=(s=a())?s:x)});const r=(null==(s=n.onRehydrateStorage)?void 0:s.call(n,null!=(e=a())?e:x))||void 0;return Ts(o.getItem.bind(o))(n.name).then(e=>{if(e){if("number"!=typeof e.version||e.version===n.version)return[!1,e.state];if(n.migrate)return[!0,n.migrate(e.state,e.version)]}return[!1,void 0]}).then(e=>{var s;const[r,i]=e;if(h=n.merge(i,null!=(s=a())?s:x),t(h,!0),r)return d()}).then(()=>{null==r||r(h,void 0),h=a(),i=!0,c.forEach(e=>e(h))}).catch(e=>{null==r||r(void 0,e)})};return r.persist={setOptions:e=>{n={...n,...e},e.storage&&(o=e.storage)},clearStorage:()=>{null==o||o.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>u(),hasHydrated:()=>i,onHydrate:e=>(l.add(e),()=>{l.delete(e)}),onFinishHydration:e=>(c.add(e),()=>{c.delete(e)})},n.skipHydration||u(),h||x})(e,s);const Es=new class{constructor(e){s(this,"baseURL"),this.baseURL=e}async request(e,s={}){const{user:t}=Ls.getState(),a=`${this.baseURL}/api${e}`,r={headers:{"Content-Type":"application/json",...t?.token&&{Authorization:`Bearer ${t.token}`},...t?.companyId&&{"X-Company-ID":t.companyId},...s.headers},...s};try{0;const e=await fetch(a,r);if(!e.ok){const s=await e.json().catch(()=>({}));throw new Error(s.error||`HTTP ${e.status}: ${e.statusText}`)}return await e.json()}catch(n){throw n}}async login(e,s,t){return this.request("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:s,userType:t})})}async register(e){return this.request("/auth/register",{method:"POST",body:JSON.stringify(e)})}async verifyToken(){return this.request("/auth/verify")}async getWhatsAppStatus(e){return this.request(`/whatsapp/status/${e}`)}async connectWhatsApp(e,s){return this.request(`/whatsapp/connect/${e}`,{method:"POST",body:JSON.stringify(s||{})})}async disconnectWhatsApp(e){return this.request(`/whatsapp/disconnect/${e}`,{method:"POST"})}async sendWhatsAppMessage(e,s,t,a="text"){return this.request(`/whatsapp/send/${e}`,{method:"POST",body:JSON.stringify({to:s,message:t,type:a})})}async getWhatsAppQRCode(e){return this.request(`/whatsapp/qr-code/${e}`)}async getWhatsAppSessions(e){return this.request(`/whatsapp/sessions/${e}`)}async getWhatsAppStats(e,s={}){const t=new URLSearchParams(s).toString();return this.request(`/whatsapp/stats/${e}?${t}`)}async getWhatsAppMonitoring(e,s){return this.request(`/whatsapp/monitoring/${e}/${s}`)}async getWhatsAppConnectionTypes(){return this.request("/whatsapp/connection-types")}async getSocialMediaStatus(e,s){return this.request(`/social-media/${s}/status/${e}`)}async connectSocialMedia(e,s,t){return this.request(`/social-media/${s}/connect/${e}`,{method:"POST",body:JSON.stringify(t)})}async disconnectSocialMedia(e,s){return this.request(`/social-media/${s}/disconnect/${e}`,{method:"POST"})}async getSocialMediaSessions(e,s){return this.request(`/social-media/${s}/sessions/${e}`)}async getSocialMediaStats(e,s,t={}){const a=new URLSearchParams(t).toString();return this.request(`/social-media/${s}/stats/${e}?${a}`)}async getConversations(e,s={}){const t=new URLSearchParams(s).toString();return this.request(`/conversations/${e}?${t}`)}async getConversationsReport(e,s={}){const t=new URLSearchParams(s).toString();return this.request(`/conversations/${e}/report?${t}`)}async getConversation(e,s){return this.request(`/conversations/${e}/${s}`)}async updateConversation(e,s,t){return this.request(`/conversations/${e}/${s}`,{method:"PUT",body:JSON.stringify(t)})}async getMessages(e,s,t=50,a=0){return this.request(`/conversations/${e}/${s}/messages?limit=${t}&offset=${a}`)}async sendMessage(e,s,t){return this.request(`/conversations/${e}/${s}/messages`,{method:"POST",body:JSON.stringify(t)})}async getUsers(e){return this.request(`/users/${e}`)}async getUsersReport(e,s={}){const t=new URLSearchParams(s).toString();return this.request(`/users/${e}/report?${t}`)}async createUser(e,s){return this.request(`/users/${e}`,{method:"POST",body:JSON.stringify(s)})}async updateUser(e,s,t){return this.request(`/users/${e}/${s}`,{method:"PUT",body:JSON.stringify(t)})}async deleteUser(e,s){return this.request(`/users/${e}/${s}`,{method:"DELETE"})}async getTags(e){return this.request(`/tags/${e}`)}async createTag(e,s){return this.request(`/tags/${e}`,{method:"POST",body:JSON.stringify(s)})}async updateTag(e,s,t){return this.request(`/tags/${e}/${s}`,{method:"PUT",body:JSON.stringify(t)})}async deleteTag(e,s){return this.request(`/tags/${e}/${s}`,{method:"DELETE"})}async getCampaigns(e){return this.request(`/campaigns/${e}`)}async createCampaign(e,s){return this.request(`/campaigns/${e}`,{method:"POST",body:JSON.stringify(s)})}async updateCampaign(e,s,t){return this.request(`/campaigns/${e}/${s}`,{method:"PUT",body:JSON.stringify(t)})}async deleteCampaign(e,s){return this.request(`/campaigns/${e}/${s}`,{method:"DELETE"})}async getAnalytics(e,s={}){const t=new URLSearchParams(s).toString();return this.request(`/analytics/${e}?${t}`)}async uploadFile(e,s,t="message"){const a=new FormData;return a.append("file",s),a.append("type",t),this.request(`/uploads/${e}`,{method:"POST",body:a,headers:{}})}async getCompanies(){return this.request("/companies")}async createCompany(e){return this.request("/companies",{method:"POST",body:JSON.stringify(e)})}async updateCompany(e,s){return this.request(`/companies/${e}`,{method:"PUT",body:JSON.stringify(s)})}async deleteCompany(e){return this.request(`/companies/${e}`,{method:"DELETE"})}}("http://localhost:3001"),Rs={admin:["manage_users","manage_campaigns","manage_settings","view_all_conversations","manage_integrations","view_analytics","manage_automations","manage_contacts","export_data","manage_billing","view_admin_dashboard"],supervisor:["manage_users","manage_campaigns","view_all_conversations","view_analytics","manage_automations","manage_contacts","export_data","view_admin_dashboard"],agent:["view_assigned_conversations","send_messages","view_contacts","basic_analytics","view_agent_dashboard"]},Ls=d()(As((e,s)=>({user:null,userType:null,isLoading:!1,login:async(s,t,a)=>{e({isLoading:!0});try{if("master"===a&&"admin@gybachat.com"===s&&"admin123"===t){return e({user:{id:"master-1",name:"Administrador Master",email:"admin@gybachat.com",role:"admin",permissions:["all"],status:"active",token:"demo-master-token"},userType:"master",isLoading:!1}),!0}const n={"admin@empresa.com":{id:"user-1",name:"João Silva - Admin",companyId:"company-1",companyName:"Empresa Demo",role:"admin",permissions:["manage_users","manage_campaigns","manage_settings","view_all_conversations"],status:"active",token:"demo-client-token"},"supervisor@empresa.com":{id:"user-2",name:"Maria Santos - Supervisora",companyId:"company-1",companyName:"Empresa Demo",role:"supervisor",permissions:["manage_users","view_all_conversations","view_analytics"],status:"active",token:"demo-supervisor-token"},"agente@empresa.com":{id:"user-3",name:"Carlos Lima - Agente",companyId:"company-1",companyName:"Empresa Demo",role:"agent",permissions:["view_assigned_conversations","send_messages"],status:"active",token:"demo-agent-token"}};if("client"===a&&n[s]&&"demo123"===t)return e({user:n[s],userType:"client",isLoading:!1}),!0;try{0;const r=await Es.login(s,t,a);if(r.success&&r.token&&r.user){localStorage.setItem("token",r.token);const s={id:r.user.id,name:r.user.name,email:r.user.email,avatar:r.user.avatar_url,companyId:r.user.company_id,companyName:r.user.companyName||"Empresa",role:r.user.role,permissions:r.user.permissions||Rs[r.user.role]||[],department:r.user.metadata?.department,phone:r.user.metadata?.phone,status:r.user.status||"active",lastLogin:(new Date).toISOString(),token:r.token};return e({user:s,userType:a,isLoading:!1}),!0}}catch(r){}return e({isLoading:!1}),!1}catch(n){return e({isLoading:!1}),!1}},logout:()=>{if(localStorage.removeItem("token"),window.socket)try{window.socket.disconnect()}catch(s){}e({user:null,userType:null}),window.location.pathname.includes("/master")?window.location.href="/master/login":window.location.href="/client/login"},hasPermission:e=>{const{user:t}=s();return!!t&&(!!t.permissions.includes("all")||(t.permissions?.includes(e)||!1))},isAdminOrSupervisor:()=>{const{user:e}=s();return"admin"===e?.role||"supervisor"===e?.role}}),{name:"gybachat-auth"})),Is={blue:{name:"blue",displayName:"Azul Corporativo",colors:{primary:{50:"#eff6ff",100:"#dbeafe",200:"#bfdbfe",300:"#93c5fd",400:"#60a5fa",500:"#3b82f6",600:"#2563eb",700:"#1d4ed8",800:"#1e40af",900:"#1e3a8a"}}},green:{name:"green",displayName:"Verde Natureza",colors:{primary:{50:"#f0fdf4",100:"#dcfce7",200:"#bbf7d0",300:"#86efac",400:"#4ade80",500:"#22c55e",600:"#16a34a",700:"#15803d",800:"#166534",900:"#14532d"}}},purple:{name:"purple",displayName:"Roxo Elegante",colors:{primary:{50:"#faf5ff",100:"#f3e8ff",200:"#e9d5ff",300:"#d8b4fe",400:"#c084fc",500:"#a855f7",600:"#9333ea",700:"#7c3aed",800:"#6b21a8",900:"#581c87"}}},orange:{name:"orange",displayName:"Laranja Vibrante",colors:{primary:{50:"#fff7ed",100:"#ffedd5",200:"#fed7aa",300:"#fdba74",400:"#fb923c",500:"#f97316",600:"#ea580c",700:"#c2410c",800:"#9a3412",900:"#7c2d12"}}},red:{name:"red",displayName:"Vermelho Dinâmico",colors:{primary:{50:"#fef2f2",100:"#fee2e2",200:"#fecaca",300:"#fca5a5",400:"#f87171",500:"#ef4444",600:"#dc2626",700:"#b91c1c",800:"#991b1b",900:"#7f1d1d"}}},teal:{name:"teal",displayName:"Azul Turquesa",colors:{primary:{50:"#f0fdfa",100:"#ccfbf1",200:"#99f6e4",300:"#5eead4",400:"#2dd4bf",500:"#14b8a6",600:"#0d9488",700:"#0f766e",800:"#115e59",900:"#134e4a"}}}},Ms={platformName:"Gybachat",companyName:"Gybachat",supportEmail:"suporte@gybachat.com",supportPhone:"+55 11 99999-9999",defaultTimezone:"America/Sao_Paulo",defaultLanguage:"pt-BR",defaultCurrency:"BRL",maintenanceMode:!1,allowNewRegistrations:!0,sessionTimeout:60,maxLoginAttempts:5,lockoutDuration:15,passwordStrength:"medium",require2FA:!1,enableAuditLogs:!0,enableEncryption:!0,maxUsersPerCompany:50,maxChatsPerUser:100,basicPlanMessageLimit:2e3,proPlanMessageLimit:1e4,enterprisePlanMessageLimit:1e5,maxFileSize:16,dataRetentionDays:365,apiRateLimit:100,enableWhatsApp:!0,enableTelegram:!0,enableInstagram:!1,enableFacebook:!1,enableWebChat:!0,enableEmail:!0,enableEmailNotifications:!0,enableSMSNotifications:!1,enablePushNotifications:!0,enableSlackIntegration:!1,enableDiscordIntegration:!1,enableBilling:!0,defaultPaymentMethod:"credit_card",invoicePrefix:"GYB",taxRate:0,trialPeriodDays:14,gracePeriodDays:7,enableChatbots:!0,enableAutoResponders:!0,enableWorkflowAutomation:!0,enableScheduledMessages:!0,enableSystemMonitoring:!0,enablePerformanceTracking:!0,enableErrorTracking:!0,enableUptime:!0,enableAutoBackup:!0,backupFrequency:"daily",backupRetention:30,logLevel:"info",enableLogRotation:!0,enablePublicAPI:!0,enableWebhooks:!0,webhookRetryAttempts:3,apiVersioning:!0,enableCDN:!0,enableCaching:!0,cacheTimeout:3600,enableCompression:!0,enableSSL:!0},Ps=d()(As((e,s)=>({currentTheme:Is.blue,availableThemes:Object.values(Is),globalSettings:Ms,setTheme:t=>{const a=Is[t];a&&(e({currentTheme:a}),s().applyThemeGlobally())},updateGlobalSettings:s=>{e(e=>({globalSettings:{...e.globalSettings,...s}}))},applyThemeGlobally:()=>{const{currentTheme:e}=s(),t=document.documentElement;Object.keys(Is).forEach(e=>{t.classList.remove(`theme-${e}`)}),t.classList.add(`theme-${e.name}`),Object.entries(e.colors.primary).forEach(([e,s])=>{t.style.setProperty(`--primary-${e}`,s)}),t.style.setProperty("--color-primary",e.colors.primary[600]),t.style.setProperty("--color-primary-hover",e.colors.primary[700]),t.style.setProperty("--color-primary-light",e.colors.primary[100]),t.style.setProperty("--color-primary-dark",e.colors.primary[800]),window.dispatchEvent(new CustomEvent("themeChanged",{detail:{theme:e}}))}}),{name:"gybachat-theme",onRehydrate:e=>{e&&setTimeout(()=>e.applyThemeGlobally(),0)}})),Ds={"/client/dashboard":["/assets/dashboard-icons.svg","/assets/client-dashboard-bg.webp"],"/client/conversations":["/assets/chat-icons.svg"],"/master/dashboard":["/assets/master-dashboard-bg.webp"]};function Os(e){if("undefined"==typeof document)return;({"/client/dashboard":["/client/conversations","/client/whatsapp","/client/tags"],"/client/conversations":["/client/dashboard","/client/tags","/client/queue"],"/master/dashboard":["/master/companies","/master/themes","/master/settings"]}[e]||[]).forEach(e=>{!function(e){if("undefined"==typeof document)return;(Ds[e]||[]).forEach(e=>{if(e.match(/\.(png|jpg|jpeg|gif|webp|svg)$/))(new Image).src=e;else{const s=document.createElement("link");s.rel="prefetch",s.href=e,document.head.appendChild(s)}})}(e);const s=document.createElement("link");s.rel="prefetch",s.href=e,document.head.appendChild(s)})}const $s="gybachat-cache-v1",Bs={match:/\.(js|css|svg|woff2?)$/},qs={match:/\.(png|jpe?g|gif|webp)$/},Fs={match:/\/api\//},Us={match:/\.(html)$/},zs=`\n// Instalação do Service Worker\nself.addEventListener('install', (event) => {\n  event.waitUntil(\n    caches.open('${$s}').then((cache) => {\n      return cache.addAll([\n        ${["/","/index.html","/manifest.json","/favicon.ico","/assets/logo.svg"].map(e=>`'${e}'`).join(",\n        ")}\n      ]);\n    })\n  );\n});\n\n// Ativação e limpeza de caches antigos\nself.addEventListener('activate', (event) => {\n  event.waitUntil(\n    caches.keys().then((cacheNames) => {\n      return Promise.all(\n        cacheNames.map((cacheName) => {\n          if (cacheName !== '${$s}') {\n            return caches.delete(cacheName);\n          }\n        })\n      );\n    })\n  );\n});\n\n// Interceptação de requisições\nself.addEventListener('fetch', (event) => {\n  // Ignorar requisições de socket\n  if (event.request.url.includes('/socket.io/')) {\n    return;\n  }\n\n  const url = new URL(event.request.url);\n  \n  // Estratégia para assets estáticos\n  if (${Bs.match}.test(url.pathname)) {\n    event.respondWith(cacheFirst(event.request));\n  }\n  // Estratégia para imagens\n  else if (${qs.match}.test(url.pathname)) {\n    event.respondWith(staleWhileRevalidate(event.request));\n  }\n  // Estratégia para API\n  else if (${Fs.match}.test(url.pathname)) {\n    event.respondWith(networkFirst(event.request));\n  }\n  // Estratégia para HTML\n  else if (${Us.match}.test(url.pathname) || url.pathname === '/') {\n    event.respondWith(networkFirst(event.request));\n  }\n  // Estratégia padrão\n  else {\n    event.respondWith(networkFirst(event.request));\n  }\n});\n\n// Estratégia: Cache First, fallback para rede\nasync function cacheFirst(request) {\n  const cachedResponse = await caches.match(request);\n  if (cachedResponse) {\n    return cachedResponse;\n  }\n  return fetch(request).then((response) => {\n    if (response.ok) {\n      const clonedResponse = response.clone();\n      caches.open('${$s}').then((cache) => {\n        cache.put(request, clonedResponse);\n      });\n    }\n    return response;\n  });\n}\n\n// Estratégia: Stale While Revalidate\nasync function staleWhileRevalidate(request) {\n  const cachedResponse = await caches.match(request);\n  \n  const fetchPromise = fetch(request).then((response) => {\n    if (response.ok) {\n      const clonedResponse = response.clone();\n      caches.open('${$s}').then((cache) => {\n        cache.put(request, clonedResponse);\n      });\n    }\n    return response;\n  }).catch(() => {\n    // Se a rede falhar e não tivermos cache, retornar uma resposta de fallback para imagens\n    if (request.url.match(${qs.match})) {\n      return caches.match('/assets/image-placeholder.svg');\n    }\n    throw new Error('Network and cache both failed');\n  });\n  \n  return cachedResponse || fetchPromise;\n}\n\n// Estratégia: Network First, fallback para cache\nasync function networkFirst(request) {\n  try {\n    const response = await fetch(request);\n    if (response.ok) {\n      const clonedResponse = response.clone();\n      caches.open('${$s}').then((cache) => {\n        cache.put(request, clonedResponse);\n      });\n    }\n    return response;\n  } catch (error) {\n    const cachedResponse = await caches.match(request);\n    if (cachedResponse) {\n      return cachedResponse;\n    }\n    \n    // Para HTML, retornar página offline\n    if (request.url.match(${Us.match}) || request.url.endsWith('/')) {\n      return caches.match('/offline.html');\n    }\n    \n    throw error;\n  }\n}\n\n// Sincronização em background\nself.addEventListener('sync', (event) => {\n  if (event.tag === 'sync-messages') {\n    event.waitUntil(syncMessages());\n  }\n});\n\n// Função para sincronizar mensagens pendentes\nasync function syncMessages() {\n  // Implementação de sincronização de mensagens pendentes\n  console.log('Syncing pending messages...');\n}\n`;const Ws=Object.create(null);Ws.open="0",Ws.close="1",Ws.ping="2",Ws.pong="3",Ws.message="4",Ws.upgrade="5",Ws.noop="6";const Vs=Object.create(null);Object.keys(Ws).forEach(e=>{Vs[Ws[e]]=e});const Hs={type:"error",data:"parser error"},Gs="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),Ks="function"==typeof ArrayBuffer,Js=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,Qs=({type:e,data:s},t,a)=>Gs&&s instanceof Blob?t?a(s):Ys(s,a):Ks&&(s instanceof ArrayBuffer||Js(s))?t?a(s):Ys(new Blob([s]),a):a(Ws[e]+(s||"")),Ys=(e,s)=>{const t=new FileReader;return t.onload=function(){const e=t.result.split(",")[1];s("b"+(e||""))},t.readAsDataURL(e)};function Xs(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let Zs;const et="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",st="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let Ga=0;Ga<64;Ga++)st[et.charCodeAt(Ga)]=Ga;const tt="function"==typeof ArrayBuffer,at=(e,s)=>{if("string"!=typeof e)return{type:"message",data:nt(e,s)};const t=e.charAt(0);if("b"===t)return{type:"message",data:rt(e.substring(1),s)};return Vs[t]?e.length>1?{type:Vs[t],data:e.substring(1)}:{type:Vs[t]}:Hs},rt=(e,s)=>{if(tt){const t=(e=>{let s,t,a,r,n,i=.75*e.length,l=e.length,c=0;"="===e[e.length-1]&&(i--,"="===e[e.length-2]&&i--);const o=new ArrayBuffer(i),d=new Uint8Array(o);for(s=0;s<l;s+=4)t=st[e.charCodeAt(s)],a=st[e.charCodeAt(s+1)],r=st[e.charCodeAt(s+2)],n=st[e.charCodeAt(s+3)],d[c++]=t<<2|a>>4,d[c++]=(15&a)<<4|r>>2,d[c++]=(3&r)<<6|63&n;return o})(e);return nt(t,s)}return{base64:!0,data:e}},nt=(e,s)=>"blob"===s?e instanceof Blob?e:new Blob([e]):e instanceof ArrayBuffer?e:e.buffer,it=String.fromCharCode(30);function lt(){return new TransformStream({transform(e,s){!function(e,s){Gs&&e.data instanceof Blob?e.data.arrayBuffer().then(Xs).then(s):Ks&&(e.data instanceof ArrayBuffer||Js(e.data))?s(Xs(e.data)):Qs(e,!1,e=>{Zs||(Zs=new TextEncoder),s(Zs.encode(e))})}(e,t=>{const a=t.length;let r;if(a<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,a);else if(a<65536){r=new Uint8Array(3);const e=new DataView(r.buffer);e.setUint8(0,126),e.setUint16(1,a)}else{r=new Uint8Array(9);const e=new DataView(r.buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(a))}e.data&&"string"!=typeof e.data&&(r[0]|=128),s.enqueue(r),s.enqueue(t)})}})}let ct;function ot(e){return e.reduce((e,s)=>e+s.length,0)}function dt(e,s){if(e[0].length===s)return e.shift();const t=new Uint8Array(s);let a=0;for(let r=0;r<s;r++)t[r]=e[0][a++],a===e[0].length&&(e.shift(),a=0);return e.length&&a<e[0].length&&(e[0]=e[0].slice(a)),t}function mt(e){if(e)return function(e){for(var s in mt.prototype)e[s]=mt.prototype[s];return e}(e)}mt.prototype.on=mt.prototype.addEventListener=function(e,s){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(s),this},mt.prototype.once=function(e,s){function t(){this.off(e,t),s.apply(this,arguments)}return t.fn=s,this.on(e,t),this},mt.prototype.off=mt.prototype.removeListener=mt.prototype.removeAllListeners=mt.prototype.removeEventListener=function(e,s){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var t,a=this._callbacks["$"+e];if(!a)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r=0;r<a.length;r++)if((t=a[r])===s||t.fn===s){a.splice(r,1);break}return 0===a.length&&delete this._callbacks["$"+e],this},mt.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var s=new Array(arguments.length-1),t=this._callbacks["$"+e],a=1;a<arguments.length;a++)s[a-1]=arguments[a];if(t){a=0;for(var r=(t=t.slice(0)).length;a<r;++a)t[a].apply(this,s)}return this},mt.prototype.emitReserved=mt.prototype.emit,mt.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},mt.prototype.hasListeners=function(e){return!!this.listeners(e).length};const xt="function"==typeof Promise&&"function"==typeof Promise.resolve?e=>Promise.resolve().then(e):(e,s)=>s(e,0),ht="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function ut(e,...s){return s.reduce((s,t)=>(e.hasOwnProperty(t)&&(s[t]=e[t]),s),{})}const pt=ht.setTimeout,gt=ht.clearTimeout;function ft(e,s){s.useNativeTimers?(e.setTimeoutFn=pt.bind(ht),e.clearTimeoutFn=gt.bind(ht)):(e.setTimeoutFn=ht.setTimeout.bind(ht),e.clearTimeoutFn=ht.clearTimeout.bind(ht))}function yt(e){return"string"==typeof e?function(e){let s=0,t=0;for(let a=0,r=e.length;a<r;a++)s=e.charCodeAt(a),s<128?t+=1:s<2048?t+=2:s<55296||s>=57344?t+=3:(a++,t+=4);return t}(e):Math.ceil(1.33*(e.byteLength||e.size))}function jt(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}class bt extends Error{constructor(e,s,t){super(e),this.description=s,this.context=t,this.type="TransportError"}}class Nt extends mt{constructor(e){super(),this.writable=!1,ft(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,s,t){return super.emitReserved("error",new bt(e,s,t)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const s=at(e,this.socket.binaryType);this.onPacket(s)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,s={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(s)}_hostname(){const e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){const s=function(e){let s="";for(let t in e)e.hasOwnProperty(t)&&(s.length&&(s+="&"),s+=encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return s}(e);return s.length?"?"+s:""}}class vt extends Nt{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const s=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let e=0;this._polling&&(e++,this.once("pollComplete",function(){--e||s()})),this.writable||(e++,this.once("drain",function(){--e||s()}))}else s()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){((e,s)=>{const t=e.split(it),a=[];for(let r=0;r<t.length;r++){const e=at(t[r],s);if(a.push(e),"error"===e.type)break}return a})(e,this.socket.binaryType).forEach(e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)}),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,((e,s)=>{const t=e.length,a=new Array(t);let r=0;e.forEach((e,n)=>{Qs(e,!1,e=>{a[n]=e,++r===t&&s(a.join(it))})})})(e,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",s=this.query||{};return!1!==this.opts.timestampRequests&&(s[this.opts.timestampParam]=jt()),this.supportsBinary||s.sid||(s.b64=1),this.createUri(e,s)}}let wt=!1;try{wt="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(Ha){}const Ct=wt;function kt(){}class _t extends vt{constructor(e){if(super(e),"undefined"!=typeof location){const s="https:"===location.protocol;let t=location.port;t||(t=s?"443":"80"),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||t!==e.port}}doWrite(e,s){const t=this.request({method:"POST",data:e});t.on("success",s),t.on("error",(e,s)=>{this.onError("xhr post error",e,s)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(e,s)=>{this.onError("xhr poll error",e,s)}),this.pollXhr=e}}class St extends mt{constructor(e,s,t){super(),this.createRequest=e,ft(this,t),this._opts=t,this._method=t.method||"GET",this._uri=s,this._data=void 0!==t.data?t.data:null,this._create()}_create(){var e;const s=ut(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");s.xdomain=!!this._opts.xd;const t=this._xhr=this.createRequest(s);try{t.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(let e in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(e)&&t.setRequestHeader(e,this._opts.extraHeaders[e])}}catch(a){}if("POST"===this._method)try{t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(a){}try{t.setRequestHeader("Accept","*/*")}catch(a){}null===(e=this._opts.cookieJar)||void 0===e||e.addCookies(t),"withCredentials"in t&&(t.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(t.timeout=this._opts.requestTimeout),t.onreadystatechange=()=>{var e;3===t.readyState&&(null===(e=this._opts.cookieJar)||void 0===e||e.parseCookies(t.getResponseHeader("set-cookie"))),4===t.readyState&&(200===t.status||1223===t.status?this._onLoad():this.setTimeoutFn(()=>{this._onError("number"==typeof t.status?t.status:0)},0))},t.send(this._data)}catch(a){return void this.setTimeoutFn(()=>{this._onError(a)},0)}"undefined"!=typeof document&&(this._index=St.requestsCount++,St.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(void 0!==this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=kt,e)try{this._xhr.abort()}catch(s){}"undefined"!=typeof document&&delete St.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}if(St.requestsCount=0,St.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",Tt);else if("function"==typeof addEventListener){addEventListener("onpagehide"in ht?"pagehide":"unload",Tt,!1)}function Tt(){for(let e in St.requests)St.requests.hasOwnProperty(e)&&St.requests[e].abort()}const At=function(){const e=Et({xdomain:!1});return e&&null!==e.responseType}();function Et(e){const s=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!s||Ct))return new XMLHttpRequest}catch(t){}if(!s)try{return new(ht[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}const Rt="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class Lt extends Nt{get name(){return"websocket"}doOpen(){const e=this.uri(),s=this.opts.protocols,t=Rt?{}:ut(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(t.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,s,t)}catch(Ha){return this.emitReserved("error",Ha)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let s=0;s<e.length;s++){const t=e[s],a=s===e.length-1;Qs(t,this.supportsBinary,e=>{try{this.doWrite(t,e)}catch(s){}a&&xt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){void 0!==this.ws&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",s=this.query||{};return this.opts.timestampRequests&&(s[this.opts.timestampParam]=jt()),this.supportsBinary||(s.b64=1),this.createUri(e,s)}}const It=ht.WebSocket||ht.MozWebSocket;const Mt={websocket:class extends Lt{createSocket(e,s,t){return Rt?new It(e,s,t):s?new It(e,s):new It(e)}doWrite(e,s){this.ws.send(s)}},webtransport:class extends Nt{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(Ha){return this.emitReserved("error",Ha)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const s=function(e,s){ct||(ct=new TextDecoder);const t=[];let a=0,r=-1,n=!1;return new TransformStream({transform(i,l){for(t.push(i);;){if(0===a){if(ot(t)<1)break;const e=dt(t,1);n=!(128&~e[0]),r=127&e[0],a=r<126?3:126===r?1:2}else if(1===a){if(ot(t)<2)break;const e=dt(t,2);r=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),a=3}else if(2===a){if(ot(t)<8)break;const e=dt(t,8),s=new DataView(e.buffer,e.byteOffset,e.length),n=s.getUint32(0);if(n>Math.pow(2,21)-1){l.enqueue(Hs);break}r=n*Math.pow(2,32)+s.getUint32(4),a=3}else{if(ot(t)<r)break;const e=dt(t,r);l.enqueue(at(n?e:ct.decode(e),s)),a=0}if(0===r||r>e){l.enqueue(Hs);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),t=e.readable.pipeThrough(s).getReader(),a=lt();a.readable.pipeTo(e.writable),this._writer=a.writable.getWriter();const r=()=>{t.read().then(({done:e,value:s})=>{e||(this.onPacket(s),r())}).catch(e=>{})};r();const n={type:"open"};this.query.sid&&(n.data=`{"sid":"${this.query.sid}"}`),this._writer.write(n).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let s=0;s<e.length;s++){const t=e[s],a=s===e.length-1;this._writer.write(t).then(()=>{a&&xt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;null===(e=this._transport)||void 0===e||e.close()}},polling:class extends _t{constructor(e){super(e);const s=e&&e.forceBase64;this.supportsBinary=At&&!s}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new St(Et,this.uri(),e)}}},Pt=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Dt=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Ot(e){if(e.length>8e3)throw"URI too long";const s=e,t=e.indexOf("["),a=e.indexOf("]");-1!=t&&-1!=a&&(e=e.substring(0,t)+e.substring(t,a).replace(/:/g,";")+e.substring(a,e.length));let r=Pt.exec(e||""),n={},i=14;for(;i--;)n[Dt[i]]=r[i]||"";return-1!=t&&-1!=a&&(n.source=s,n.host=n.host.substring(1,n.host.length-1).replace(/;/g,":"),n.authority=n.authority.replace("[","").replace("]","").replace(/;/g,":"),n.ipv6uri=!0),n.pathNames=function(e,s){const t=/\/{2,9}/g,a=s.replace(t,"/").split("/");"/"!=s.slice(0,1)&&0!==s.length||a.splice(0,1);"/"==s.slice(-1)&&a.splice(a.length-1,1);return a}(0,n.path),n.queryKey=function(e,s){const t={};return s.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(e,s,a){s&&(t[s]=a)}),t}(0,n.query),n}const $t="function"==typeof addEventListener&&"function"==typeof removeEventListener,Bt=[];$t&&addEventListener("offline",()=>{Bt.forEach(e=>e())},!1);class qt extends mt{constructor(e,s){if(super(),this.binaryType="arraybuffer",this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&"object"==typeof e&&(s=e,e=null),e){const t=Ot(e);s.hostname=t.host,s.secure="https"===t.protocol||"wss"===t.protocol,s.port=t.port,t.query&&(s.query=t.query)}else s.host&&(s.hostname=Ot(s.host).host);ft(this,s),this.secure=null!=s.secure?s.secure:"undefined"!=typeof location&&"https:"===location.protocol,s.hostname&&!s.port&&(s.port=this.secure?"443":"80"),this.hostname=s.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=s.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},s.transports.forEach(e=>{const s=e.prototype.name;this.transports.push(s),this._transportsByName[s]=e}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},s),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(e){let s={},t=e.split("&");for(let a=0,r=t.length;a<r;a++){let e=t[a].split("=");s[decodeURIComponent(e[0])]=decodeURIComponent(e[1])}return s}(this.opts.query)),$t&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Bt.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const s=Object.assign({},this.opts.query);s.EIO=4,s.transport=e,this.id&&(s.sid=this.id);const t=Object.assign({},this.opts,{query:s,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](t)}_open(){if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);const e=this.opts.rememberUpgrade&&qt.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";const s=this.createTransport(e);s.open(),this.setTransport(s)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",qt.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const s=new Error("server error");s.code=e.data,this._onError(s);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let s=0;s<this.writeBuffer.length;s++){const t=this.writeBuffer[s].data;if(t&&(e+=yt(t)),s>0&&e>this._maxPayload)return this.writeBuffer.slice(0,s);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,xt(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,s,t){return this._sendPacket("message",e,s,t),this}send(e,s,t){return this._sendPacket("message",e,s,t),this}_sendPacket(e,s,t,a){if("function"==typeof s&&(a=s,s=void 0),"function"==typeof t&&(a=t,t=null),"closing"===this.readyState||"closed"===this.readyState)return;(t=t||{}).compress=!1!==t.compress;const r={type:e,data:s,options:t};this.emitReserved("packetCreate",r),this.writeBuffer.push(r),a&&this.once("flush",a),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},s=()=>{this.off("upgrade",s),this.off("upgradeError",s),e()},t=()=>{this.once("upgrade",s),this.once("upgradeError",s)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?t():e()}):this.upgrading?t():e()),this}_onError(e){if(qt.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,s){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),$t&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const e=Bt.indexOf(this._offlineEventListener);-1!==e&&Bt.splice(e,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,s),this.writeBuffer=[],this._prevBufferLen=0}}}qt.protocol=4;class Ft extends qt{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let s=this.createTransport(e),t=!1;qt.priorWebsocketSuccess=!1;const a=()=>{t||(s.send([{type:"ping",data:"probe"}]),s.once("packet",e=>{if(!t)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",s),!s)return;qt.priorWebsocketSuccess="websocket"===s.name,this.transport.pause(()=>{t||"closed"!==this.readyState&&(o(),this.setTransport(s),s.send([{type:"upgrade"}]),this.emitReserved("upgrade",s),s=null,this.upgrading=!1,this.flush())})}else{const e=new Error("probe error");e.transport=s.name,this.emitReserved("upgradeError",e)}}))};function r(){t||(t=!0,o(),s.close(),s=null)}const n=e=>{const t=new Error("probe error: "+e);t.transport=s.name,r(),this.emitReserved("upgradeError",t)};function i(){n("transport closed")}function l(){n("socket closed")}function c(e){s&&e.name!==s.name&&r()}const o=()=>{s.removeListener("open",a),s.removeListener("error",n),s.removeListener("close",i),this.off("close",l),this.off("upgrading",c)};s.once("open",a),s.once("error",n),s.once("close",i),this.once("close",l),this.once("upgrading",c),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn(()=>{t||s.open()},200):s.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const s=[];for(let t=0;t<e.length;t++)~this.transports.indexOf(e[t])&&s.push(e[t]);return s}}let Ut=class extends Ft{constructor(e,s={}){const t="object"==typeof e?e:s;(!t.transports||t.transports&&"string"==typeof t.transports[0])&&(t.transports=(t.transports||["polling","websocket","webtransport"]).map(e=>Mt[e]).filter(e=>!!e)),super(e,t)}};const zt="function"==typeof ArrayBuffer,Wt=Object.prototype.toString,Vt="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Wt.call(Blob),Ht="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===Wt.call(File);function Gt(e){return zt&&(e instanceof ArrayBuffer||(e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer)(e))||Vt&&e instanceof Blob||Ht&&e instanceof File}function Kt(e,s){if(!e||"object"!=typeof e)return!1;if(Array.isArray(e)){for(let s=0,t=e.length;s<t;s++)if(Kt(e[s]))return!0;return!1}if(Gt(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return Kt(e.toJSON(),!0);for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&Kt(e[t]))return!0;return!1}function Jt(e){const s=[],t=e.data,a=e;return a.data=Qt(t,s),a.attachments=s.length,{packet:a,buffers:s}}function Qt(e,s){if(!e)return e;if(Gt(e)){const t={_placeholder:!0,num:s.length};return s.push(e),t}if(Array.isArray(e)){const t=new Array(e.length);for(let a=0;a<e.length;a++)t[a]=Qt(e[a],s);return t}if("object"==typeof e&&!(e instanceof Date)){const t={};for(const a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=Qt(e[a],s));return t}return e}function Yt(e,s){return e.data=Xt(e.data,s),delete e.attachments,e}function Xt(e,s){if(!e)return e;if(e&&!0===e._placeholder){if("number"==typeof e.num&&e.num>=0&&e.num<s.length)return s[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let t=0;t<e.length;t++)e[t]=Xt(e[t],s);else if("object"==typeof e)for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(e[t]=Xt(e[t],s));return e}const Zt=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];var ea,sa;(sa=ea||(ea={}))[sa.CONNECT=0]="CONNECT",sa[sa.DISCONNECT=1]="DISCONNECT",sa[sa.EVENT=2]="EVENT",sa[sa.ACK=3]="ACK",sa[sa.CONNECT_ERROR=4]="CONNECT_ERROR",sa[sa.BINARY_EVENT=5]="BINARY_EVENT",sa[sa.BINARY_ACK=6]="BINARY_ACK";function ta(e){return"[object Object]"===Object.prototype.toString.call(e)}class aa extends mt{constructor(e){super(),this.reviver=e}add(e){let s;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");s=this.decodeString(e);const t=s.type===ea.BINARY_EVENT;t||s.type===ea.BINARY_ACK?(s.type=t?ea.EVENT:ea.ACK,this.reconstructor=new ra(s),0===s.attachments&&super.emitReserved("decoded",s)):super.emitReserved("decoded",s)}else{if(!Gt(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");s=this.reconstructor.takeBinaryData(e),s&&(this.reconstructor=null,super.emitReserved("decoded",s))}}decodeString(e){let s=0;const t={type:Number(e.charAt(0))};if(void 0===ea[t.type])throw new Error("unknown packet type "+t.type);if(t.type===ea.BINARY_EVENT||t.type===ea.BINARY_ACK){const a=s+1;for(;"-"!==e.charAt(++s)&&s!=e.length;);const r=e.substring(a,s);if(r!=Number(r)||"-"!==e.charAt(s))throw new Error("Illegal attachments");t.attachments=Number(r)}if("/"===e.charAt(s+1)){const a=s+1;for(;++s;){if(","===e.charAt(s))break;if(s===e.length)break}t.nsp=e.substring(a,s)}else t.nsp="/";const a=e.charAt(s+1);if(""!==a&&Number(a)==a){const a=s+1;for(;++s;){const t=e.charAt(s);if(null==t||Number(t)!=t){--s;break}if(s===e.length)break}t.id=Number(e.substring(a,s+1))}if(e.charAt(++s)){const a=this.tryParse(e.substr(s));if(!aa.isPayloadValid(t.type,a))throw new Error("invalid payload");t.data=a}return t}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(s){return!1}}static isPayloadValid(e,s){switch(e){case ea.CONNECT:return ta(s);case ea.DISCONNECT:return void 0===s;case ea.CONNECT_ERROR:return"string"==typeof s||ta(s);case ea.EVENT:case ea.BINARY_EVENT:return Array.isArray(s)&&("number"==typeof s[0]||"string"==typeof s[0]&&-1===Zt.indexOf(s[0]));case ea.ACK:case ea.BINARY_ACK:return Array.isArray(s)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class ra{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=Yt(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const na=Object.freeze(Object.defineProperty({__proto__:null,Decoder:aa,Encoder:class{constructor(e){this.replacer=e}encode(e){return e.type!==ea.EVENT&&e.type!==ea.ACK||!Kt(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===ea.EVENT?ea.BINARY_EVENT:ea.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let s=""+e.type;return e.type!==ea.BINARY_EVENT&&e.type!==ea.BINARY_ACK||(s+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(s+=e.nsp+","),null!=e.id&&(s+=e.id),null!=e.data&&(s+=JSON.stringify(e.data,this.replacer)),s}encodeAsBinary(e){const s=Jt(e),t=this.encodeAsString(s.packet),a=s.buffers;return a.unshift(t),a}},get PacketType(){return ea},protocol:5},Symbol.toStringTag,{value:"Module"}));function ia(e,s,t){return e.on(s,t),function(){e.off(s,t)}}const la=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class ca extends mt{constructor(e,s,t){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=s,t&&t.auth&&(this.auth=t.auth),this._opts=Object.assign({},t),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[ia(e,"open",this.onopen.bind(this)),ia(e,"packet",this.onpacket.bind(this)),ia(e,"error",this.onerror.bind(this)),ia(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...s){var t,a,r;if(la.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(s.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(s),this;const n={type:ea.EVENT,data:s,options:{}};if(n.options.compress=!1!==this.flags.compress,"function"==typeof s[s.length-1]){const e=this.ids++,t=s.pop();this._registerAckCallback(e,t),n.id=e}const i=null===(a=null===(t=this.io.engine)||void 0===t?void 0:t.transport)||void 0===a?void 0:a.writable,l=this.connected&&!(null===(r=this.io.engine)||void 0===r?void 0:r._hasPingExpired());return this.flags.volatile&&!i||(l?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n)),this.flags={},this}_registerAckCallback(e,s){var t;const a=null!==(t=this.flags.timeout)&&void 0!==t?t:this._opts.ackTimeout;if(void 0===a)return void(this.acks[e]=s);const r=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let s=0;s<this.sendBuffer.length;s++)this.sendBuffer[s].id===e&&this.sendBuffer.splice(s,1);s.call(this,new Error("operation has timed out"))},a),n=(...e)=>{this.io.clearTimeoutFn(r),s.apply(this,e)};n.withError=!0,this.acks[e]=n}emitWithAck(e,...s){return new Promise((t,a)=>{const r=(e,s)=>e?a(e):t(s);r.withError=!0,s.push(r),this.emit(e,...s)})}_addToQueue(e){let s;"function"==typeof e[e.length-1]&&(s=e.pop());const t={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((e,...a)=>{if(t!==this._queue[0])return;return null!==e?t.tryCount>this._opts.retries&&(this._queue.shift(),s&&s(e)):(this._queue.shift(),s&&s(null,...a)),t.pending=!1,this._drainQueue()}),this._queue.push(t),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||0===this._queue.length)return;const s=this._queue[0];s.pending&&!e||(s.pending=!0,s.tryCount++,this.flags=s.flags,this.emit.apply(this,s.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:ea.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,s){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,s),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(s=>String(s.id)===e)){const s=this.acks[e];delete this.acks[e],s.withError&&s.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case ea.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case ea.EVENT:case ea.BINARY_EVENT:this.onevent(e);break;case ea.ACK:case ea.BINARY_ACK:this.onack(e);break;case ea.DISCONNECT:this.ondisconnect();break;case ea.CONNECT_ERROR:this.destroy();const s=new Error(e.data.message);s.data=e.data.data,this.emitReserved("connect_error",s)}}onevent(e){const s=e.data||[];null!=e.id&&s.push(this.ack(e.id)),this.connected?this.emitEvent(s):this.receiveBuffer.push(Object.freeze(s))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const s=this._anyListeners.slice();for(const t of s)t.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const s=this;let t=!1;return function(...a){t||(t=!0,s.packet({type:ea.ACK,id:e,data:a}))}}onack(e){const s=this.acks[e.id];"function"==typeof s&&(delete this.acks[e.id],s.withError&&e.data.unshift(null),s.apply(this,e.data))}onconnect(e,s){this.id=e,this.recovered=s&&this._pid===s,this._pid=s,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:ea.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const s=this._anyListeners;for(let t=0;t<s.length;t++)if(e===s[t])return s.splice(t,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const s=this._anyOutgoingListeners;for(let t=0;t<s.length;t++)if(e===s[t])return s.splice(t,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const s=this._anyOutgoingListeners.slice();for(const t of s)t.apply(this,e.data)}}}function oa(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}oa.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var s=Math.random(),t=Math.floor(s*this.jitter*e);e=1&Math.floor(10*s)?e+t:e-t}return 0|Math.min(e,this.max)},oa.prototype.reset=function(){this.attempts=0},oa.prototype.setMin=function(e){this.ms=e},oa.prototype.setMax=function(e){this.max=e},oa.prototype.setJitter=function(e){this.jitter=e};class da extends mt{constructor(e,s){var t;super(),this.nsps={},this.subs=[],e&&"object"==typeof e&&(s=e,e=void 0),(s=s||{}).path=s.path||"/socket.io",this.opts=s,ft(this,s),this.reconnection(!1!==s.reconnection),this.reconnectionAttempts(s.reconnectionAttempts||1/0),this.reconnectionDelay(s.reconnectionDelay||1e3),this.reconnectionDelayMax(s.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(t=s.randomizationFactor)&&void 0!==t?t:.5),this.backoff=new oa({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==s.timeout?2e4:s.timeout),this._readyState="closed",this.uri=e;const a=s.parser||na;this.encoder=new a.Encoder,this.decoder=new a.Decoder,this._autoConnect=!1!==s.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var s;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(s=this.backoff)||void 0===s||s.setMin(e),this)}randomizationFactor(e){var s;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(s=this.backoff)||void 0===s||s.setJitter(e),this)}reconnectionDelayMax(e){var s;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(s=this.backoff)||void 0===s||s.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Ut(this.uri,this.opts);const s=this.engine,t=this;this._readyState="opening",this.skipReconnect=!1;const a=ia(s,"open",function(){t.onopen(),e&&e()}),r=s=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",s),e?e(s):this.maybeReconnectOnOpen()},n=ia(s,"error",r);if(!1!==this._timeout){const e=this._timeout,t=this.setTimeoutFn(()=>{a(),r(new Error("timeout")),s.close()},e);this.opts.autoUnref&&t.unref(),this.subs.push(()=>{this.clearTimeoutFn(t)})}return this.subs.push(a),this.subs.push(n),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(ia(e,"ping",this.onping.bind(this)),ia(e,"data",this.ondata.bind(this)),ia(e,"error",this.onerror.bind(this)),ia(e,"close",this.onclose.bind(this)),ia(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(s){this.onclose("parse error",s)}}ondecoded(e){xt(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,s){let t=this.nsps[e];return t?this._autoConnect&&!t.active&&t.connect():(t=new ca(this,e,s),this.nsps[e]=t),t}_destroy(e){const s=Object.keys(this.nsps);for(const t of s){if(this.nsps[t].active)return}this._close()}_packet(e){const s=this.encoder.encode(e);for(let t=0;t<s.length;t++)this.engine.write(s[t],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,s){var t;this.cleanup(),null===(t=this.engine)||void 0===t||t.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,s),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const s=this.backoff.duration();this._reconnecting=!0;const t=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open(s=>{s?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",s)):e.onreconnect()}))},s);this.opts.autoUnref&&t.unref(),this.subs.push(()=>{this.clearTimeoutFn(t)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const ma={};function xa(e,s){"object"==typeof e&&(s=e,e=void 0);const t=function(e,s="",t){let a=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==t?t.protocol+"//"+e:"https://"+e),a=Ot(e)),a.port||(/^(http|ws)$/.test(a.protocol)?a.port="80":/^(http|ws)s$/.test(a.protocol)&&(a.port="443")),a.path=a.path||"/";const r=-1!==a.host.indexOf(":")?"["+a.host+"]":a.host;return a.id=a.protocol+"://"+r+":"+a.port+s,a.href=a.protocol+"://"+r+(t&&t.port===a.port?"":":"+a.port),a}(e,(s=s||{}).path||"/socket.io"),a=t.source,r=t.id,n=t.path,i=ma[r]&&n in ma[r].nsps;let l;return s.forceNew||s["force new connection"]||!1===s.multiplex||i?l=new da(a,s):(ma[r]||(ma[r]=new da(a,s)),l=ma[r]),t.query&&!s.query&&(s.query=t.queryKey),l.socket(t.path,s)}Object.assign(xa,{Manager:da,Socket:ca,io:xa,connect:xa});const ha=new class{constructor(){s(this,"socket",null),s(this,"isConnected",!1),s(this,"reconnectAttempts",0),s(this,"maxReconnectAttempts",5),s(this,"reconnectDelay",1e3)}connect(e,s,t,a){if(this.socket?.connected)return this.socket;return this.socket=xa("http://localhost:3001",{auth:{token:e,companyId:s,userId:t,role:a},transports:["websocket","polling"],timeout:parseInt("20000"),forceNew:!0,reconnectionAttempts:parseInt("5")}),window.socket=this.socket,this.setupEventListeners(),this.socket}setupEventListeners(){this.socket&&(this.socket.on("connect",()=>{this.isConnected=!0,this.reconnectAttempts=0,this.socket?.emit("authenticate",{userId:this.socket.auth.userId,companyId:this.socket.auth.companyId,role:this.socket.auth.role,token:this.socket.auth.token})}),this.socket.on("authenticated",e=>{this.socket?.emit("join-company",this.socket.auth.companyId)}),this.socket.on("authentication-error",e=>{}),this.socket.on("disconnect",e=>{this.isConnected=!1,"io server disconnect"===e&&this.reconnect()}),this.socket.on("connect_error",e=>{this.reconnect()}),this.socket.on("whatsapp:qr-code",e=>{window.dispatchEvent(new CustomEvent("whatsapp:qr-code",{detail:e}))}),this.socket.on("whatsapp:connected",e=>{window.dispatchEvent(new CustomEvent("whatsapp:connected",{detail:e}))}),this.socket.on("whatsapp:disconnected",e=>{window.dispatchEvent(new CustomEvent("whatsapp:disconnected",{detail:e}))}),this.socket.on("conversation:new-message",e=>{window.dispatchEvent(new CustomEvent("conversation:new-message",{detail:e}))}),this.socket.on("conversation:typing",e=>{window.dispatchEvent(new CustomEvent("conversation:typing",{detail:e}))}),this.socket.on("message:status-update",e=>{window.dispatchEvent(new CustomEvent("message:status-update",{detail:e}))}),this.socket.on("presence:update",e=>{window.dispatchEvent(new CustomEvent("presence:update",{detail:e}))}),this.socket.on("user:joined",e=>{window.dispatchEvent(new CustomEvent("user:joined",{detail:e}))}),this.socket.on("user:left",e=>{window.dispatchEvent(new CustomEvent("user:left",{detail:e}))}),this.socket.on("system:alert",e=>{window.dispatchEvent(new CustomEvent("system:alert",{detail:e}))}),this.socket.on("server:shutdown",e=>{window.dispatchEvent(new CustomEvent("server:shutdown",{detail:e}))}))}reconnect(){if(this.reconnectAttempts>=this.maxReconnectAttempts)return;this.reconnectAttempts++;const e=this.reconnectDelay*Math.pow(2,this.reconnectAttempts-1);setTimeout(()=>{this.socket?.connect()},e)}joinConversation(e){this.socket?.emit("conversation:join",e)}leaveConversation(e){this.socket?.emit("conversation:leave",e)}sendTyping(e,s,t){this.socket?.emit("conversation:typing",{conversationId:e,isTyping:s,userName:t})}updatePresence(e){this.socket?.emit("presence:update",e)}get connected(){return this.isConnected&&this.socket?.connected}get socketId(){return this.socket?.id}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null,window.socket=null,this.isConnected=!1,this.reconnectAttempts=0)}},ua=()=>{const[e,s]=t.useState("admin@gybachat.com"),[a,r]=t.useState("admin123"),[n,i]=t.useState(!1),[l,c]=t.useState(""),{login:o,isLoading:d}=Ls();return ks.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:ks.jsxs("div",{className:"max-w-md w-full space-y-8 p-8",children:[ks.jsxs("div",{className:"text-center",children:[ks.jsx("div",{className:"mx-auto h-16 w-16 bg-blue-600 rounded-full flex items-center justify-center",children:ks.jsx(m,{className:"h-8 w-8 text-white"})}),ks.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"Gestão de Contas"}),ks.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Acesse o painel administrativo do Gybachat"})]}),ks.jsx("form",{className:"mt-8 space-y-6",onSubmit:async s=>{s.preventDefault(),c("");try{await o(e,a,"master")?window.location.href="/master":c("Credenciais inválidas. Tente novamente.")}catch(Ha){c("Ocorreu um erro durante o login. Tente novamente.")}},children:ks.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 space-y-4",children:[ks.jsxs("div",{children:[ks.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),ks.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:e,onChange:e=>s(e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Digite seu email",autoComplete:"off"})]}),ks.jsxs("div",{children:[ks.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Senha"}),ks.jsxs("div",{className:"mt-1 relative",children:[ks.jsx("input",{id:"password",name:"password",type:n?"text":"password",required:!0,value:a,onChange:e=>r(e.target.value),className:"block w-full px-3 py-2 pr-10 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Digite sua senha",autoComplete:"off"}),ks.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>i(!n),children:n?ks.jsx(x,{className:"h-4 w-4 text-gray-400"}):ks.jsx(h,{className:"h-4 w-4 text-gray-400"})})]})]}),l&&ks.jsx("div",{className:"text-red-600 text-sm text-center bg-red-50 p-2 rounded",children:l}),ks.jsx("button",{type:"submit",disabled:d,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:d?ks.jsx(u,{className:"h-4 w-4 animate-spin"}):"Entrar no Painel de Gestão"})]})}),ks.jsx("div",{className:"text-center",children:ks.jsx("a",{href:"/client/login",className:"text-sm text-blue-600 hover:text-blue-500 mt-2 inline-block",children:"Acessar Painel do Cliente →"})})]})})},pa=()=>{const e=[{month:"Jan",empresas:45,mensagens:125e3,receita:85e3},{month:"Fev",empresas:52,mensagens:145e3,receita:98e3},{month:"Mar",empresas:61,mensagens:165e3,receita:112e3},{month:"Abr",empresas:68,mensagens:185e3,receita:125e3},{month:"Mai",empresas:75,mensagens:205e3,receita:138e3},{month:"Jun",empresas:82,mensagens:225e3,receita:152e3}],s=[{name:"Básico",value:45,color:"#3B82F6"},{name:"Profissional",value:28,color:"#10B981"},{name:"Enterprise",value:9,color:"#8B5CF6"}],t=e=>{switch(e){case"error":return ks.jsx(P,{className:"h-4 w-4 text-red-500"});case"warning":return ks.jsx(P,{className:"h-4 w-4 text-yellow-500"});case"success":return ks.jsx(j,{className:"h-4 w-4 text-green-500"});default:return ks.jsx(M,{className:"h-4 w-4 text-blue-500"})}};return ks.jsxs("div",{className:"space-y-6",children:[ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total de Empresas"}),ks.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"82"}),ks.jsxs("p",{className:"text-xs text-green-600 flex items-center mt-1",children:[ks.jsx(p,{className:"h-3 w-3 mr-1"}),"+9.3% este mês"]})]}),ks.jsx(g,{className:"h-8 w-8 text-blue-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Mensagens/Mês"}),ks.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"225K"}),ks.jsxs("p",{className:"text-xs text-green-600 flex items-center mt-1",children:[ks.jsx(p,{className:"h-3 w-3 mr-1"}),"+21.5% este mês"]})]}),ks.jsx(f,{className:"h-8 w-8 text-green-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Receita Mensal"}),ks.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"R$ 152K"}),ks.jsxs("p",{className:"text-xs text-green-600 flex items-center mt-1",children:[ks.jsx(p,{className:"h-3 w-3 mr-1"}),"+10.1% este mês"]})]}),ks.jsx(y,{className:"h-8 w-8 text-purple-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Uptime Sistema"}),ks.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"99.9%"}),ks.jsxs("p",{className:"text-xs text-green-600 flex items-center mt-1",children:[ks.jsx(j,{className:"h-3 w-3 mr-1"}),"Excelente"]})]}),ks.jsx(b,{className:"h-8 w-8 text-orange-600"})]})})]}),ks.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Crescimento Mensal"}),ks.jsx(N,{width:"100%",height:300,children:ks.jsxs(v,{data:e,children:[ks.jsx(w,{strokeDasharray:"3 3"}),ks.jsx(C,{dataKey:"month"}),ks.jsx(k,{}),ks.jsx(_,{}),ks.jsx(S,{type:"monotone",dataKey:"empresas",stroke:"#3B82F6",strokeWidth:2,name:"Empresas"}),ks.jsx(S,{type:"monotone",dataKey:"mensagens",stroke:"#10B981",strokeWidth:2,name:"Mensagens (K)"})]})})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Distribuição de Planos"}),ks.jsx("div",{className:"flex items-center justify-center",children:ks.jsx(N,{width:"100%",height:300,children:ks.jsxs(T,{children:[ks.jsx(A,{data:s,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:5,dataKey:"value",children:s.map((e,s)=>ks.jsx(E,{fill:e.color},`cell-${s}`))}),ks.jsx(_,{})]})})}),ks.jsx("div",{className:"flex justify-center space-x-6 mt-4",children:s.map(e=>ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),ks.jsxs("span",{className:"text-sm text-gray-600",children:[e.name," (",e.value,")"]})]},e.name))})]})]}),ks.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Métricas do Servidor"}),ks.jsx("div",{className:"space-y-4",children:[{name:"CPU",usage:65,status:"normal"},{name:"Memória",usage:78,status:"warning"},{name:"Disco",usage:45,status:"normal"},{name:"Rede",usage:32,status:"normal"}].map(e=>{return ks.jsxs("div",{children:[ks.jsxs("div",{className:"flex justify-between items-center mb-2",children:[ks.jsx("span",{className:"text-sm font-medium text-gray-700",children:e.name}),ks.jsxs("span",{className:"text-sm text-gray-500",children:[e.usage,"%"]})]}),ks.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:ks.jsx("div",{className:"h-2 rounded-full "+(s=e.usage,t=e.status,"warning"===t||s>80?"bg-red-500":s>60?"bg-yellow-500":"bg-green-500"),style:{width:`${e.usage}%`}})})]},e.name);var s,t})})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Alertas Recentes"}),ks.jsx("div",{className:"space-y-3",children:[{id:1,type:"warning",message:'Empresa "TechCorp" atingiu 90% do limite de mensagens',time:"5 min atrás"},{id:2,type:"error",message:'Falha na conexão WhatsApp - Empresa "StartupXYZ"',time:"12 min atrás"},{id:3,type:"info",message:'Nova empresa cadastrada: "InovaCorp"',time:"1 hora atrás"},{id:4,type:"success",message:"Backup automático concluído com sucesso",time:"2 horas atrás"}].map(e=>ks.jsxs("div",{className:"flex items-start space-x-3 p-3 rounded-lg bg-gray-50",children:[t(e.type),ks.jsxs("div",{className:"flex-1 min-w-0",children:[ks.jsx("p",{className:"text-sm text-gray-900",children:e.message}),ks.jsxs("p",{className:"text-xs text-gray-500 mt-1 flex items-center",children:[ks.jsx(R,{className:"h-3 w-3 mr-1"}),e.time]})]})]},e.id))}),ks.jsx("div",{className:"mt-4 text-center",children:ks.jsx("button",{className:"text-sm text-blue-600 hover:text-blue-700",children:"Ver todos os alertas"})})]})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Receita Mensal (R$)"}),ks.jsx(N,{width:"100%",height:300,children:ks.jsxs(L,{data:e,children:[ks.jsx(w,{strokeDasharray:"3 3"}),ks.jsx(C,{dataKey:"month"}),ks.jsx(k,{}),ks.jsx(_,{formatter:e=>[`R$ ${e.toLocaleString()}`,"Receita"]}),ks.jsx(I,{dataKey:"receita",fill:"#8B5CF6",radius:[4,4,0,0]})]})})]})]})},ga=()=>ks.jsx("div",{children:ks.jsx(pa,{})}),fa=()=>{const[e,s]=t.useState("admin@empresa.com"),[a,r]=t.useState("demo123"),[n,i]=t.useState(!1),[l,c]=t.useState(""),{login:o,isLoading:d}=Ls();return ks.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-green-50 to-blue-100",children:ks.jsxs("div",{className:"max-w-md w-full space-y-8 p-8",children:[ks.jsxs("div",{className:"text-center",children:[ks.jsx("div",{className:"mx-auto h-16 w-16 bg-green-600 rounded-full flex items-center justify-center",children:ks.jsx(f,{className:"h-8 w-8 text-white"})}),ks.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"Gybachat"}),ks.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Faça login na sua conta empresarial"})]}),ks.jsx("form",{className:"mt-8 space-y-6",onSubmit:async s=>{s.preventDefault(),c("");try{await o(e,a,"client")?window.location.href="/client":c("Credenciais inválidas. Tente novamente.")}catch(Ha){c("Ocorreu um erro durante o login. Tente novamente.")}},children:ks.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 space-y-4",children:[ks.jsxs("div",{children:[ks.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),ks.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:e,onChange:e=>s(e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500",placeholder:"Digite seu email",autoComplete:"off"})]}),ks.jsxs("div",{children:[ks.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Senha"}),ks.jsxs("div",{className:"mt-1 relative",children:[ks.jsx("input",{id:"password",name:"password",type:n?"text":"password",required:!0,value:a,onChange:e=>r(e.target.value),className:"block w-full px-3 py-2 pr-10 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500",placeholder:"Digite sua senha",autoComplete:"off"}),ks.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>i(!n),children:n?ks.jsx(x,{className:"h-4 w-4 text-gray-400"}):ks.jsx(h,{className:"h-4 w-4 text-gray-400"})})]})]}),l&&ks.jsx("div",{className:"text-red-600 text-sm text-center bg-red-50 p-2 rounded",children:l}),ks.jsx("button",{type:"submit",disabled:d,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed",children:d?ks.jsx(u,{className:"h-4 w-4 animate-spin"}):"Entrar"})]})}),ks.jsx("div",{className:"text-center",children:ks.jsx("a",{href:"/master/login",className:"text-sm text-green-600 hover:text-green-500 mt-2 inline-block",children:"← Voltar ao Painel Master"})})]})})},ya=()=>{const{user:e}=Ls(),s={conversations:23,avgResponseTime:"1m 45s",resolutionRate:92,satisfaction:4.7,messagesHandled:156,activeTime:"7h 23m"},t={conversations:127,messagesHandled:892,activeTime:"38h 15m"},a={conversations:542,messagesHandled:3847,activeTime:"162h 45m"},r=[{name:"Suporte Técnico",value:45,color:"#3B82F6"},{name:"Vendas",value:30,color:"#10B981"},{name:"Dúvidas Gerais",value:15,color:"#F59E0B"},{name:"Reclamações",value:10,color:"#EF4444"}],n=e=>e>=100?"bg-green-500":e>=80?"bg-yellow-500":"bg-red-500";return ks.jsxs("div",{className:"space-y-6",children:[ks.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg text-white p-6",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsxs("h1",{className:"text-2xl font-bold",children:["Olá, ",e?.name?.split(" ")[0],"! 👋"]}),ks.jsx("p",{className:"text-blue-100 mt-1",children:"Aqui está seu desempenho de hoje - Continue assim!"})]}),ks.jsxs("div",{className:"text-right",children:[ks.jsx("div",{className:"text-3xl font-bold",children:s.conversations}),ks.jsx("div",{className:"text-blue-100 text-sm",children:"conversas hoje"})]})]})}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tempo Médio Resposta"}),ks.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.avgResponseTime}),ks.jsxs("p",{className:"text-xs text-green-600 flex items-center mt-1",children:[ks.jsx(p,{className:"h-3 w-3 mr-1"}),"15% melhor que ontem"]})]}),ks.jsx(D,{className:"h-8 w-8 text-blue-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Taxa de Resolução"}),ks.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[s.resolutionRate,"%"]}),ks.jsxs("p",{className:"text-xs text-green-600 flex items-center mt-1",children:[ks.jsx(j,{className:"h-3 w-3 mr-1"}),"Acima da meta"]})]}),ks.jsx(O,{className:"h-8 w-8 text-green-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Satisfação Média"}),ks.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.satisfaction}),ks.jsx("div",{className:"flex items-center mt-1",children:[1,2,3,4,5].map(e=>ks.jsx($,{className:"h-3 w-3 "+(e<=Math.floor(s.satisfaction)?"text-yellow-400 fill-current":"text-gray-300")},e))})]}),ks.jsx(B,{className:"h-8 w-8 text-purple-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tempo Ativo"}),ks.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.activeTime}),ks.jsxs("p",{className:"text-xs text-blue-600 flex items-center mt-1",children:[ks.jsx(M,{className:"h-3 w-3 mr-1"}),"Online agora"]})]}),ks.jsx(R,{className:"h-8 w-8 text-orange-600"})]})})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[ks.jsx(q,{className:"h-5 w-5 mr-2 text-yellow-500"}),"Suas Metas Hoje"]}),ks.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[{name:"Conversas/Dia",current:23,target:25,percentage:92},{name:"Tempo Resposta",current:105,target:120,percentage:112},{name:"Satisfação",current:4.7,target:4.5,percentage:104},{name:"Taxa Resolução",current:92,target:90,percentage:102}].map(e=>{return ks.jsxs("div",{className:"space-y-2",children:[ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsx("span",{className:"text-sm font-medium text-gray-700",children:e.name}),ks.jsxs("span",{className:"text-sm font-bold "+(s=e.percentage,s>=100?"text-green-600":s>=80?"text-yellow-600":"text-red-600"),children:[e.percentage,"%"]})]}),ks.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:ks.jsx("div",{className:`h-2 rounded-full ${n(e.percentage)}`,style:{width:`${Math.min(e.percentage,100)}%`}})}),ks.jsxs("div",{className:"text-xs text-gray-500",children:[e.current," / ",e.target," ","Tempo Resposta"===e.name?"segundos":""]})]},e.name);var s})})]}),ks.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Performance da Semana"}),ks.jsx(N,{width:"100%",height:300,children:ks.jsxs(v,{data:[{day:"Seg",conversations:18,satisfaction:4.2,responseTime:145},{day:"Ter",conversations:25,satisfaction:4.5,responseTime:132},{day:"Qua",conversations:22,satisfaction:4.8,responseTime:98},{day:"Qui",conversations:28,satisfaction:4.6,responseTime:115},{day:"Sex",conversations:31,satisfaction:4.9,responseTime:87},{day:"Sáb",conversations:15,satisfaction:4.3,responseTime:156},{day:"Dom",conversations:8,satisfaction:4.7,responseTime:134}],children:[ks.jsx(w,{strokeDasharray:"3 3"}),ks.jsx(C,{dataKey:"day"}),ks.jsx(k,{}),ks.jsx(_,{}),ks.jsx(S,{type:"monotone",dataKey:"conversations",stroke:"#3B82F6",strokeWidth:2,name:"Conversas"}),ks.jsx(S,{type:"monotone",dataKey:"satisfaction",stroke:"#10B981",strokeWidth:2,name:"Satisfação"})]})})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Tipos de Atendimento"}),ks.jsx("div",{className:"flex items-center justify-center",children:ks.jsx(N,{width:"100%",height:300,children:ks.jsxs(T,{children:[ks.jsx(A,{data:r,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:5,dataKey:"value",children:r.map((e,s)=>ks.jsx(E,{fill:e.color},`cell-${s}`))}),ks.jsx(_,{})]})})}),ks.jsx("div",{className:"grid grid-cols-2 gap-2 mt-4",children:r.map(e=>ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),ks.jsxs("span",{className:"text-sm text-gray-600",children:[e.name," (",e.value,"%)"]})]},e.name))})]})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Sua Atividade por Horário"}),ks.jsx(N,{width:"100%",height:300,children:ks.jsxs(L,{data:[{hour:"08h",activity:12},{hour:"09h",activity:28},{hour:"10h",activity:35},{hour:"11h",activity:42},{hour:"12h",activity:25},{hour:"13h",activity:18},{hour:"14h",activity:38},{hour:"15h",activity:45},{hour:"16h",activity:52},{hour:"17h",activity:38},{hour:"18h",activity:22}],children:[ks.jsx(w,{strokeDasharray:"3 3"}),ks.jsx(C,{dataKey:"hour"}),ks.jsx(k,{}),ks.jsx(_,{}),ks.jsx(I,{dataKey:"activity",fill:"#8B5CF6",radius:[4,4,0,0]})]})})]}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Hoje"}),ks.jsxs("div",{className:"space-y-3",children:[ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Conversas"}),ks.jsx("span",{className:"text-sm font-medium",children:s.conversations})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Mensagens"}),ks.jsx("span",{className:"text-sm font-medium",children:s.messagesHandled})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Tempo Ativo"}),ks.jsx("span",{className:"text-sm font-medium",children:s.activeTime})]})]})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Esta Semana"}),ks.jsxs("div",{className:"space-y-3",children:[ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Conversas"}),ks.jsx("span",{className:"text-sm font-medium",children:t.conversations})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Mensagens"}),ks.jsx("span",{className:"text-sm font-medium",children:t.messagesHandled})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Tempo Ativo"}),ks.jsx("span",{className:"text-sm font-medium",children:t.activeTime})]})]})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Este Mês"}),ks.jsxs("div",{className:"space-y-3",children:[ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Conversas"}),ks.jsx("span",{className:"text-sm font-medium",children:a.conversations})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Mensagens"}),ks.jsx("span",{className:"text-sm font-medium",children:a.messagesHandled})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Tempo Ativo"}),ks.jsx("span",{className:"text-sm font-medium",children:a.activeTime})]})]})]})]}),ks.jsx("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 border border-green-200 rounded-lg p-6",children:ks.jsxs("div",{className:"flex items-start space-x-3",children:[ks.jsx(F,{className:"h-5 w-5 text-green-600 mt-0.5"}),ks.jsxs("div",{children:[ks.jsx("h3",{className:"text-sm font-semibold text-green-900 mb-2",children:"💡 Dicas para Melhorar seu Desempenho"}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm text-green-800",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(j,{className:"h-4 w-4 text-green-600"}),ks.jsx("span",{children:"Mantenha respostas rápidas nos horários de pico"})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(j,{className:"h-4 w-4 text-green-600"}),ks.jsx("span",{children:"Use templates para dúvidas frequentes"})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(j,{className:"h-4 w-4 text-green-600"}),ks.jsx("span",{children:"Peça feedback ao finalizar atendimentos"})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(j,{className:"h-4 w-4 text-green-600"}),ks.jsx("span",{children:"Mantenha-se atualizado com produtos/serviços"})]})]})]})]})})]})},ja=()=>{const{user:e}=Ls(),s={today:{totalConversations:127,activeAgents:8,avgResponseTime:"2m 34s",resolutionRate:94.2,satisfaction:4.6,messagesHandled:1247,peakHour:"15:00",conversionRate:12.5},thisWeek:{totalConversations:892,satisfaction:4.5,newCustomers:156,revenue:45600},thisMonth:{totalConversations:3847,newCustomers:678,revenue:198500}},t=[{name:"WhatsApp",value:65,color:"#25D366",conversations:2498},{name:"Web Chat",value:20,color:"#3B82F6",conversations:769},{name:"Telegram",value:10,color:"#0088CC",conversations:385},{name:"Instagram",value:5,color:"#E4405F",conversations:192}],a=e=>{switch(e){case"excellent":return"text-green-600 bg-green-100";case"good":return"text-blue-600 bg-blue-100";case"warning":return"text-yellow-600 bg-yellow-100";case"poor":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},r=e=>{switch(e){case"up":return ks.jsx(Q,{className:"h-3 w-3 text-green-600"});case"down":return ks.jsx(J,{className:"h-3 w-3 text-red-600"});case"stable":return ks.jsx(K,{className:"h-3 w-3 text-gray-600"});default:return null}};return ks.jsxs("div",{className:"space-y-6",children:[ks.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 rounded-lg text-white p-6",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("h1",{className:"text-2xl font-bold",children:"Dashboard Executivo"}),ks.jsxs("p",{className:"text-purple-100 mt-1",children:["Visão geral da operação - ",e?.companyName]})]}),ks.jsxs("div",{className:"text-right",children:[ks.jsx("div",{className:"text-3xl font-bold",children:s.today.totalConversations}),ks.jsx("div",{className:"text-purple-100 text-sm",children:"conversas hoje"})]})]})}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Agentes Online"}),ks.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[s.today.activeAgents,"/12"]}),ks.jsxs("p",{className:"text-xs text-green-600 flex items-center mt-1",children:[ks.jsx(U,{className:"h-3 w-3 mr-1"}),"67% da equipe"]})]}),ks.jsx(z,{className:"h-8 w-8 text-blue-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tempo Médio Resposta"}),ks.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.today.avgResponseTime}),ks.jsxs("p",{className:"text-xs text-green-600 flex items-center mt-1",children:[ks.jsx(p,{className:"h-3 w-3 mr-1"}),"8% melhor que ontem"]})]}),ks.jsx(D,{className:"h-8 w-8 text-green-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Taxa de Resolução"}),ks.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[s.today.resolutionRate,"%"]}),ks.jsxs("p",{className:"text-xs text-green-600 flex items-center mt-1",children:[ks.jsx(j,{className:"h-3 w-3 mr-1"}),"Meta: 90%"]})]}),ks.jsx(O,{className:"h-8 w-8 text-purple-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Satisfação Geral"}),ks.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.today.satisfaction}),ks.jsx("div",{className:"flex items-center mt-1",children:[1,2,3,4,5].map(e=>ks.jsx($,{className:"h-3 w-3 "+(e<=Math.floor(s.today.satisfaction)?"text-yellow-400 fill-current":"text-gray-300")},e))})]}),ks.jsx(B,{className:"h-8 w-8 text-orange-600"})]})})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[ks.jsx(W,{className:"h-5 w-5 mr-2 text-yellow-500"}),"Métricas de Qualidade"]}),ks.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[{metric:"Tempo Primeira Resposta",current:"45s",target:"60s",status:"good",trend:"up"},{metric:"Taxa de Resolução",current:"94.2%",target:"90%",status:"excellent",trend:"up"},{metric:"Satisfação do Cliente",current:"4.6/5",target:"4.5/5",status:"good",trend:"stable"},{metric:"Taxa de Abandono",current:"3.2%",target:"5%",status:"excellent",trend:"down"},{metric:"Retrabalho",current:"8.5%",target:"10%",status:"good",trend:"down"},{metric:"Escalação",current:"12%",target:"15%",status:"good",trend:"stable"}].map(e=>ks.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[ks.jsxs("div",{className:"flex items-center justify-between mb-2",children:[ks.jsx("span",{className:"text-sm font-medium text-gray-700",children:e.metric}),r(e.trend)]}),ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsx("span",{className:"text-lg font-bold text-gray-900",children:e.current}),ks.jsxs("span",{className:`text-xs px-2 py-1 rounded-full ${a(e.status)}`,children:["Meta: ",e.target]})]})]},e.metric))})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Ranking de Performance dos Agentes"}),ks.jsx("div",{className:"overflow-x-auto",children:ks.jsxs("table",{className:"min-w-full",children:[ks.jsx("thead",{children:ks.jsxs("tr",{className:"border-b border-gray-200",children:[ks.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Agente"}),ks.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-700",children:"Conversas"}),ks.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-700",children:"Satisfação"}),ks.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-700",children:"Tempo Resposta"}),ks.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-700",children:"Eficiência"})]})}),ks.jsx("tbody",{children:[{name:"Carlos Lima",conversations:156,satisfaction:4.8,responseTime:95,efficiency:96},{name:"Maria Santos",conversations:142,satisfaction:4.7,responseTime:105,efficiency:94},{name:"João Silva",conversations:138,satisfaction:4.6,responseTime:120,efficiency:92},{name:"Ana Costa",conversations:134,satisfaction:4.5,responseTime:135,efficiency:89},{name:"Pedro Oliveira",conversations:128,satisfaction:4.4,responseTime:145,efficiency:87},{name:"Lucia Ferreira",conversations:125,satisfaction:4.3,responseTime:155,efficiency:85}].map((e,s)=>ks.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[ks.jsx("td",{className:"py-3 px-4",children:ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold text-white "+(0===s?"bg-yellow-500":1===s?"bg-gray-400":2===s?"bg-orange-500":"bg-blue-500"),children:s+1}),ks.jsx("span",{className:"font-medium text-gray-900",children:e.name})]})}),ks.jsx("td",{className:"text-center py-3 px-4 text-gray-900",children:e.conversations}),ks.jsx("td",{className:"text-center py-3 px-4",children:ks.jsxs("div",{className:"flex items-center justify-center space-x-1",children:[ks.jsx("span",{className:"text-gray-900",children:e.satisfaction}),ks.jsx($,{className:"h-3 w-3 text-yellow-400 fill-current"})]})}),ks.jsxs("td",{className:"text-center py-3 px-4 text-gray-900",children:[e.responseTime,"s"]}),ks.jsx("td",{className:"text-center py-3 px-4",children:ks.jsxs("div",{className:"flex items-center justify-center",children:[ks.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:ks.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${e.efficiency}%`}})}),ks.jsxs("span",{className:"text-sm text-gray-900",children:[e.efficiency,"%"]})]})})]},e.name))})]})})]}),ks.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Volume de Atendimento por Horário"}),ks.jsx(N,{width:"100%",height:300,children:ks.jsxs(V,{data:[{hour:"08h",volume:45,agents:3},{hour:"09h",volume:78,agents:5},{hour:"10h",volume:95,agents:6},{hour:"11h",volume:112,agents:7},{hour:"12h",volume:85,agents:5},{hour:"13h",volume:68,agents:4},{hour:"14h",volume:125,agents:8},{hour:"15h",volume:145,agents:9},{hour:"16h",volume:138,agents:8},{hour:"17h",volume:95,agents:6},{hour:"18h",volume:72,agents:4}],children:[ks.jsx(w,{strokeDasharray:"3 3"}),ks.jsx(C,{dataKey:"hour"}),ks.jsx(k,{}),ks.jsx(_,{}),ks.jsx(H,{type:"monotone",dataKey:"volume",stroke:"#8B5CF6",fill:"#8B5CF6",fillOpacity:.3,name:"Volume de Conversas"}),ks.jsx(H,{type:"monotone",dataKey:"agents",stroke:"#10B981",fill:"#10B981",fillOpacity:.3,name:"Agentes Online"})]})})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Distribuição por Canal"}),ks.jsx("div",{className:"flex items-center justify-center",children:ks.jsx(N,{width:"100%",height:300,children:ks.jsxs(T,{children:[ks.jsx(A,{data:t,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:5,dataKey:"value",children:t.map((e,s)=>ks.jsx(E,{fill:e.color},`cell-${s}`))}),ks.jsx(_,{})]})})}),ks.jsx("div",{className:"grid grid-cols-2 gap-2 mt-4",children:t.map(e=>ks.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),ks.jsx("span",{className:"text-sm text-gray-600",children:e.name})]}),ks.jsxs("div",{className:"text-right",children:[ks.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[e.value,"%"]}),ks.jsx("div",{className:"text-xs text-gray-500",children:e.conversations})]})]},e.name))})]})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Tendência de Performance Semanal"}),ks.jsx(N,{width:"100%",height:400,children:ks.jsxs(v,{data:[{day:"Seg",conversations:118,satisfaction:4.2,responseTime:145,agents:7},{day:"Ter",conversations:125,satisfaction:4.5,responseTime:132,agents:8},{day:"Qua",conversations:142,satisfaction:4.8,responseTime:98,agents:8},{day:"Qui",conversations:138,satisfaction:4.6,responseTime:115,agents:9},{day:"Sex",conversations:151,satisfaction:4.9,responseTime:87,agents:9},{day:"Sáb",conversations:95,satisfaction:4.3,responseTime:156,agents:6},{day:"Dom",conversations:78,satisfaction:4.7,responseTime:134,agents:5}],children:[ks.jsx(w,{strokeDasharray:"3 3"}),ks.jsx(C,{dataKey:"day"}),ks.jsx(k,{}),ks.jsx(_,{}),ks.jsx(S,{type:"monotone",dataKey:"conversations",stroke:"#3B82F6",strokeWidth:3,name:"Conversas"}),ks.jsx(S,{type:"monotone",dataKey:"satisfaction",stroke:"#10B981",strokeWidth:3,name:"Satisfação"}),ks.jsx(S,{type:"monotone",dataKey:"agents",stroke:"#F59E0B",strokeWidth:3,name:"Agentes Online"})]})})]}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsxs("h4",{className:"text-sm font-semibold text-gray-900 mb-4 flex items-center",children:[ks.jsx(G,{className:"h-4 w-4 mr-2"}),"Hoje"]}),ks.jsxs("div",{className:"space-y-3",children:[ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Conversas"}),ks.jsx("span",{className:"text-sm font-medium",children:s.today.totalConversations})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Mensagens"}),ks.jsx("span",{className:"text-sm font-medium",children:s.today.messagesHandled})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Horário Pico"}),ks.jsx("span",{className:"text-sm font-medium",children:s.today.peakHour})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Conversão"}),ks.jsxs("span",{className:"text-sm font-medium",children:[s.today.conversionRate,"%"]})]})]})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Esta Semana"}),ks.jsxs("div",{className:"space-y-3",children:[ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Conversas"}),ks.jsx("span",{className:"text-sm font-medium",children:s.thisWeek.totalConversations})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Novos Clientes"}),ks.jsx("span",{className:"text-sm font-medium",children:s.thisWeek.newCustomers})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Receita"}),ks.jsxs("span",{className:"text-sm font-medium",children:["R$ ",s.thisWeek.revenue.toLocaleString()]})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Satisfação"}),ks.jsxs("span",{className:"text-sm font-medium",children:[s.thisWeek.satisfaction,"/5"]})]})]})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Este Mês"}),ks.jsxs("div",{className:"space-y-3",children:[ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Conversas"}),ks.jsx("span",{className:"text-sm font-medium",children:s.thisMonth.totalConversations})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Novos Clientes"}),ks.jsx("span",{className:"text-sm font-medium",children:s.thisMonth.newCustomers})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Receita"}),ks.jsxs("span",{className:"text-sm font-medium",children:["R$ ",s.thisMonth.revenue.toLocaleString()]})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Crescimento"}),ks.jsx("span",{className:"text-sm font-medium text-green-600",children:"+23.5%"})]})]})]})]}),ks.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 border border-orange-200 rounded-lg p-6",children:ks.jsxs("div",{className:"flex items-start space-x-3",children:[ks.jsx(P,{className:"h-5 w-5 text-orange-600 mt-0.5"}),ks.jsxs("div",{children:[ks.jsx("h3",{className:"text-sm font-semibold text-orange-900 mb-2",children:"🚨 Alertas e Recomendações Inteligentes"}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm text-orange-800",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(F,{className:"h-4 w-4 text-orange-600"}),ks.jsx("span",{children:"Pico de volume às 15h - considere escalar mais agentes"})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(z,{className:"h-4 w-4 text-orange-600"}),ks.jsx("span",{children:"3 agentes com tempo resposta acima da meta"})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(f,{className:"h-4 w-4 text-orange-600"}),ks.jsx("span",{children:"WhatsApp representa 65% do volume - otimizar templates"})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(p,{className:"h-4 w-4 text-orange-600"}),ks.jsx("span",{children:"Satisfação em alta - momento ideal para campanhas"})]})]})]})]})})]})},ba=()=>{const{isAdminOrSupervisor:e}=Ls();return ks.jsx("div",{children:e()?ks.jsx(ja,{}):ks.jsx(ya,{})})},Na=({companyId:e})=>{const{user:s}=Ls(),[a,n]=t.useState("disconnected"),[i,l]=t.useState(""),[c,o]=t.useState(!1),[d,m]=t.useState(null),[x,h]=t.useState(null),[p,g]=t.useState(0),[f,y]=t.useState(!1),[b,N]=t.useState({}),[v,w]=t.useState([]),[C,k]=t.useState("evolution");t.useEffect(()=>{(async()=>{try{w([{id:"evolution",name:"Evolution API",description:"Conexão via QR Code usando Evolution API (recomendado)"},{id:"official",name:"API Oficial",description:"Conexão via API Oficial do WhatsApp Business"}])}catch(Ha){}})()},[]),t.useEffect(()=>(_(),window.addEventListener("whatsapp:qr-code",S),window.addEventListener("whatsapp:connected",T),window.addEventListener("whatsapp:disconnected",A),()=>{window.removeEventListener("whatsapp:qr-code",S),window.removeEventListener("whatsapp:connected",T),window.removeEventListener("whatsapp:disconnected",A)}),[e]);const _=async()=>{try{o(!0),m(null);const s=await Es.getWhatsAppStatus(e);s.success&&(n(s.data.connected?"connected":"disconnected"),h(s.data.phoneNumber||null),s.data.qrCode&&(l(s.data.qrCode),n("connecting")),s.data.connectionType&&k(s.data.connectionType),s.data.connected&&N({uptime:Math.floor(86400*Math.random()),connectedSince:new Date(Date.now()-864e5*Math.random()),reconnectCount:Math.floor(5*Math.random()),messagesSent:Math.floor(500*Math.random()),messagesReceived:Math.floor(800*Math.random())}))}catch(Ha){m("Não foi possível verificar o status da conexão"),n("error")}finally{o(!1)}},S=s=>{const t=s;t.detail&&t.detail.companyId===e&&(l(t.detail.qrCode),n("connecting"),m(null))},T=s=>{const t=s;t.detail&&t.detail.companyId===e&&(n("connected"),h(t.detail.phoneNumber||null),l(""),m(null),g(0),N({uptime:0,connectedSince:new Date,reconnectCount:0,messagesSent:0,messagesReceived:0}))},A=s=>{const t=s;t.detail&&t.detail.companyId===e&&(n("disconnected"),h(null),l(""),N({}))},E=async()=>{try{o(!0),m(null);const s=await Es.getWhatsAppQRCode(e);s.success&&s.data.qrCode?(l(s.data.qrCode),n("connecting"),g(0)):p<3?(g(e=>e+1),setTimeout(()=>E(),3e3)):m("Não foi possível obter novo QR Code após várias tentativas. Tente reiniciar o processo.")}catch(Ha){m("Erro ao atualizar QR Code")}finally{o(!1)}},R=e=>{if(!e)return"N/A";const s=Math.floor(e/86400),t=Math.floor(e%86400/3600),a=Math.floor(e%3600/60);return s>0?`${s}d ${t}h ${a}m`:t>0?`${t}h ${a}m`:`${a}m`};return ks.jsxs("div",{className:"max-w-2xl mx-auto",children:[ks.jsx("div",{className:`rounded-lg border-2 p-6 mb-6 ${(()=>{switch(a){case"connected":return"bg-green-50 border-green-200";case"connecting":return"bg-yellow-50 border-yellow-200";default:return"bg-red-50 border-red-200"}})()}`,children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[(()=>{switch(a){case"connected":return ks.jsx(j,{className:"h-5 w-5 text-green-500"});case"connecting":return ks.jsx(Z,{className:"h-5 w-5 text-yellow-500 animate-spin"});default:return ks.jsx(se,{className:"h-5 w-5 text-red-500"})}})(),ks.jsxs("div",{children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:(()=>{switch(a){case"connected":return"WhatsApp Conectado";case"connecting":return"Conectando...";case"error":return"Erro na Conexão";default:return"WhatsApp Desconectado"}})()}),ks.jsx("p",{className:"text-sm text-gray-600",children:(()=>{switch(a){case"connected":return`Seu WhatsApp está conectado ao número ${x||"desconhecido"}`;case"connecting":return"evolution"===C?"Escaneie o QR Code com seu WhatsApp para conectar":"Conectando via API Oficial...";case"error":return"Ocorreu um erro ao conectar com o WhatsApp";default:return"Conecte seu WhatsApp para começar a receber mensagens"}})()}),d&&ks.jsx("p",{className:"text-sm text-red-600 mt-1",children:d})]})]}),ks.jsx("div",{className:"flex space-x-2",children:"connected"===a?ks.jsxs("div",{className:"flex space-x-2",children:[ks.jsxs("button",{onClick:()=>y(!f),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 flex items-center space-x-2",children:[ks.jsx(M,{className:"h-4 w-4"}),ks.jsx("span",{children:"Monitoramento"})]}),ks.jsx("button",{onClick:async()=>{try{o(!0),m(null);(await Es.disconnectWhatsApp(e)).success?(n("disconnected"),l(""),h(null),N({})):m("Não foi possível desconectar")}catch(Ha){m("Erro ao desconectar WhatsApp")}finally{o(!1)}},disabled:c,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:opacity-50",children:c?ks.jsx(u,{className:"h-4 w-4 animate-spin"}):"Desconectar"})]}):ks.jsx("button",{onClick:async()=>{try{o(!0),m(null);const s=await Es.connectWhatsApp(e,{connectionType:C});s.success?(n("connecting"),s.data&&s.data.qrCode?l(s.data.qrCode):setTimeout(()=>E(),2e3)):m("Não foi possível iniciar a conexão")}catch(Ha){m("Erro ao iniciar conexão com WhatsApp")}finally{o(!1)}},disabled:c,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50",children:c?ks.jsx(u,{className:"h-4 w-4 animate-spin"}):"Conectar WhatsApp"})})]})}),"disconnected"===a&&ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Escolha o Tipo de Conexão"}),ks.jsx("div",{className:"space-y-4",children:v.map(e=>ks.jsxs("div",{className:"flex items-start space-x-3 p-4 rounded-lg border-2 cursor-pointer transition-all "+(C===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),onClick:()=>k(e.id),children:[ks.jsx("div",{className:"flex items-center h-5 mt-1",children:ks.jsx("input",{type:"radio",checked:C===e.id,onChange:()=>k(e.id),className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"})}),ks.jsxs("div",{className:"flex-1",children:[ks.jsx("label",{className:"text-sm font-medium text-gray-900 cursor-pointer",children:e.name}),ks.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.description})]})]},e.id))}),ks.jsx("div",{className:"mt-4 text-sm text-gray-600",children:ks.jsxs("p",{className:"flex items-center",children:[ks.jsx(Y,{className:"h-4 w-4 mr-2 text-blue-600"}),ks.jsx("span",{children:"Você pode mudar o tipo de conexão a qualquer momento, mas precisará reconectar o WhatsApp."})]})})]}),"connecting"===a&&"evolution"===C&&ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-8 text-center",children:[ks.jsxs("div",{className:"mb-6",children:[ks.jsx(X,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),ks.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Escaneie o QR Code"}),ks.jsx("p",{className:"text-gray-600",children:"Abra o WhatsApp no seu celular e escaneie o código abaixo"})]}),ks.jsx("div",{className:"bg-gray-50 rounded-lg p-8 mb-6 inline-block",children:i?ks.jsx("div",{className:"w-64 h-64 bg-white rounded-lg flex items-center justify-center border-2 border-gray-300",children:ks.jsx("img",{src:i,alt:"QR Code para conexão do WhatsApp",className:"w-full h-full object-contain"})}):ks.jsx("div",{className:"w-64 h-64 bg-gray-100 rounded-lg animate-pulse flex items-center justify-center",children:ks.jsx("p",{className:"text-sm text-gray-500",children:"Carregando QR Code..."})})}),ks.jsx("button",{onClick:E,disabled:c,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 mb-6",children:c?ks.jsx(u,{className:"h-4 w-4 animate-spin"}):ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(Z,{className:"h-4 w-4"}),ks.jsx("span",{children:"Atualizar QR Code"})]})}),ks.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:ks.jsxs("div",{className:"flex items-start space-x-3",children:[ks.jsx(ee,{className:"h-5 w-5 text-blue-600 mt-0.5"}),ks.jsxs("div",{className:"text-left",children:[ks.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Como conectar:"}),ks.jsxs("ol",{className:"text-sm text-blue-800 space-y-1",children:[ks.jsx("li",{children:"1. Abra o WhatsApp no seu celular"}),ks.jsx("li",{children:'2. Toque em "Mais opções" (⋮) e depois em "Aparelhos conectados"'}),ks.jsx("li",{children:'3. Toque em "Conectar um aparelho"'}),ks.jsx("li",{children:"4. Aponte a câmera para este QR code"})]})]})]})})]}),"connecting"===a&&"official"===C&&ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-8 text-center",children:[ks.jsxs("div",{className:"mb-6",children:[ks.jsx(ee,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),ks.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Conectando via API Oficial"}),ks.jsx("p",{className:"text-gray-600",children:"Aguarde enquanto configuramos sua conexão com a API Oficial do WhatsApp"})]}),ks.jsx("div",{className:"bg-gray-50 rounded-lg p-8 mb-6 inline-block",children:ks.jsxs("div",{className:"w-64 h-64 flex flex-col items-center justify-center",children:[ks.jsx(u,{className:"h-16 w-16 text-blue-500 animate-spin mb-4"}),ks.jsx("p",{className:"text-sm text-gray-700",children:"Estabelecendo conexão..."}),ks.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Isso pode levar alguns minutos"})]})}),ks.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:ks.jsxs("div",{className:"flex items-start space-x-3",children:[ks.jsx(se,{className:"h-5 w-5 text-blue-600 mt-0.5"}),ks.jsxs("div",{className:"text-left",children:[ks.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Informações sobre a API Oficial:"}),ks.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[ks.jsx("li",{children:"• A API Oficial requer verificação e aprovação da Meta"}),ks.jsx("li",{children:"• Não é necessário escanear QR Code"}),ks.jsx("li",{children:"• Oferece maior estabilidade e suporte oficial"}),ks.jsx("li",{children:"• Requer um plano de assinatura da API do WhatsApp Business"})]})]})]})})]}),"connected"===a&&!f&&ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:ks.jsxs("div",{className:"text-center",children:[ks.jsx(j,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),ks.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"WhatsApp Conectado com Sucesso!"}),ks.jsx("p",{className:"text-gray-600 mb-6",children:"Agora você pode receber e enviar mensagens através da plataforma"}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[ks.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[ks.jsx("div",{className:"font-semibold text-green-900",children:"Status"}),ks.jsx("div",{className:"text-green-700",children:"Online"})]}),ks.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[ks.jsx("div",{className:"font-semibold text-blue-900",children:"Número"}),ks.jsx("div",{className:"text-blue-700",children:x||"Não disponível"})]}),ks.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[ks.jsx("div",{className:"font-semibold text-purple-900",children:"Tipo de Conexão"}),ks.jsx("div",{className:"text-purple-700",children:"evolution"===C?"Evolution API":"API Oficial"})]})]}),void 0!==b.uptime&&ks.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[ks.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[ks.jsx("div",{className:"font-semibold text-gray-900",children:"Tempo Conectado"}),ks.jsx("div",{className:"text-gray-700",children:R(b.uptime)})]}),ks.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[ks.jsx("div",{className:"font-semibold text-gray-900",children:"Mensagens Enviadas"}),ks.jsx("div",{className:"text-gray-700",children:b.messagesSent})]}),ks.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[ks.jsx("div",{className:"font-semibold text-gray-900",children:"Mensagens Recebidas"}),ks.jsx("div",{className:"text-gray-700",children:b.messagesReceived})]})]}),ks.jsx("div",{className:"mt-6",children:ks.jsxs(r,{to:"/client/whatsapp-monitoring",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 inline-flex items-center space-x-2",children:[ks.jsx(te,{className:"h-4 w-4"}),ks.jsx("span",{children:"Acessar Monitoramento Avançado"})]})})]})}),"connected"===a&&f&&ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsxs("div",{className:"flex items-center justify-between mb-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Monitoramento do WhatsApp"}),ks.jsx("button",{onClick:()=>y(!1),className:"text-sm text-gray-500 hover:text-gray-700",children:"Voltar"})]}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[ks.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-xs font-medium text-blue-600",children:"Tempo Conectado"}),ks.jsx("p",{className:"text-xl font-bold text-blue-800",children:R(b.uptime)})]}),ks.jsx(Clock,{className:"h-8 w-8 text-blue-500"})]})}),ks.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-xs font-medium text-green-600",children:"Mensagens Enviadas"}),ks.jsx("p",{className:"text-xl font-bold text-green-800",children:b.messagesSent})]}),ks.jsx(Send,{className:"h-8 w-8 text-green-500"})]})}),ks.jsx("div",{className:"bg-purple-50 rounded-lg p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-xs font-medium text-purple-600",children:"Mensagens Recebidas"}),ks.jsx("p",{className:"text-xl font-bold text-purple-800",children:b.messagesReceived})]}),ks.jsx(MessageCircle,{className:"h-8 w-8 text-purple-500"})]})}),ks.jsx("div",{className:"bg-yellow-50 rounded-lg p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-xs font-medium text-yellow-600",children:"Reconexões"}),ks.jsx("p",{className:"text-xl font-bold text-yellow-800",children:b.reconnectCount||0})]}),ks.jsx(Z,{className:"h-8 w-8 text-yellow-500"})]})})]}),ks.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[ks.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Status da Conexão"}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:ks.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"95%"}})}),ks.jsx("span",{className:"text-sm font-medium text-green-600",children:"Excelente"})]})]}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[ks.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Informações do Dispositivo"}),ks.jsxs("div",{className:"space-y-2",children:[ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Plataforma:"}),ks.jsx("span",{className:"text-sm font-medium",children:"Android"})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Modelo:"}),ks.jsx("span",{className:"text-sm font-medium",children:"Samsung Galaxy S21"})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Versão do WhatsApp:"}),ks.jsx("span",{className:"text-sm font-medium",children:"2.22.24.78"})]}),ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Bateria:"}),ks.jsxs("div",{className:"flex items-center",children:[ks.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:ks.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"85%"}})}),ks.jsx("span",{className:"text-sm font-medium",children:"85%"})]})]})]})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[ks.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Estatísticas de Mensagens"}),ks.jsxs("div",{className:"space-y-2",children:[ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Taxa de Entrega:"}),ks.jsx("span",{className:"text-sm font-medium text-green-600",children:"98.5%"})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Taxa de Leitura:"}),ks.jsx("span",{className:"text-sm font-medium text-green-600",children:"87.2%"})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Taxa de Resposta:"}),ks.jsx("span",{className:"text-sm font-medium text-yellow-600",children:"76.4%"})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Tempo Médio de Resposta:"}),ks.jsx("span",{className:"text-sm font-medium",children:"2m 34s"})]})]})]})]}),ks.jsx("div",{className:"mt-6",children:ks.jsxs(r,{to:"/client/whatsapp-monitoring",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 inline-flex items-center space-x-2",children:[ks.jsx(te,{className:"h-4 w-4"}),ks.jsx("span",{children:"Acessar Monitoramento Avançado"})]})})]}),ks.jsx("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-6",children:ks.jsxs("div",{className:"flex items-start space-x-3",children:[ks.jsx(F,{className:"h-5 w-5 text-blue-600 mt-0.5"}),ks.jsxs("div",{children:[ks.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Dicas para uma conexão estável"}),ks.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[ks.jsxs("li",{className:"flex items-start",children:[ks.jsx(j,{className:"h-4 w-4 text-green-600 mr-2 mt-0.5"}),ks.jsx("span",{children:"Mantenha o celular conectado à energia e Wi-Fi estável"})]}),ks.jsxs("li",{className:"flex items-start",children:[ks.jsx(j,{className:"h-4 w-4 text-green-600 mr-2 mt-0.5"}),ks.jsx("span",{children:"Não desconecte o WhatsApp Web em outros dispositivos"})]}),ks.jsxs("li",{className:"flex items-start",children:[ks.jsx(j,{className:"h-4 w-4 text-green-600 mr-2 mt-0.5"}),ks.jsx("span",{children:"Mantenha o aplicativo do WhatsApp aberto no celular"})]}),ks.jsxs("li",{className:"flex items-start",children:[ks.jsx(j,{className:"h-4 w-4 text-green-600 mr-2 mt-0.5"}),ks.jsx("span",{children:"Evite trocar de rede Wi-Fi ou 4G durante a conexão"})]})]})]})]})})]})},va=()=>{const{user:e}=Ls(),[s,a]=t.useState([]),[n,i]=t.useState(!1),[l,c]=t.useState(null),[o,d]=t.useState(30),[m,x]=t.useState(!0),[p,g]=t.useState(new Date),[y,b]=t.useState(null),[N,v]=t.useState(!1),[w,C]=t.useState(null),[k,_]=t.useState(!1);t.useEffect(()=>{e?.companyId&&S()},[e?.companyId]),t.useEffect(()=>{if(!m)return;const e=setInterval(()=>{if(S(),y&&s.length>0){const e=s.find(e=>e.id===y);e&&T(e.session_name)}g(new Date)},1e3*o);return()=>clearInterval(e)},[m,o,y,s]),t.useEffect(()=>{if(y&&s.length>0){const e=s.find(e=>e.id===y);e&&T(e.session_name)}},[y,s]);const S=async()=>{if(e?.companyId)try{i(!0),c(null);const s=[{id:"1",company_id:e.companyId,session_name:"instance_"+e.companyId,status:"connected",phone_number:"+5511999991234",last_seen:(new Date).toISOString(),created_at:new Date(Date.now()-2592e6).toISOString(),updated_at:(new Date).toISOString(),device_info:{platform:"android",phone_version:"Android 12",device_manufacturer:"Samsung",device_model:"Galaxy S21",os_version:"12.0",wa_version:"2.22.24.78",battery:85},connection_stats:{uptime:86400,connected_since:new Date(Date.now()-864e5).toISOString(),reconnect_count:2,last_reconnect:new Date(Date.now()-72e5).toISOString()},message_stats:{sent_today:156,received_today:243,sent_total:3456,received_total:4567,delivery_rate:98.5,read_rate:87.2,response_rate:76.4},health_status:{status:"healthy",issues:[],last_check:(new Date).toISOString()}}];a(s),1!==s.length||y||b(s[0].id),i(!1)}catch(Ha){c("Failed to load WhatsApp sessions. Please try again later."),i(!1)}},T=async s=>{if(e?.companyId)try{_(!0);const e={instance_name:s,status:"connected",phone:"+5511999991234",battery:{level:85,charging:!0},connection:{type:"wifi",strength:90},memory_usage:{used:1.2,total:4},cpu_usage:15,messages:{sent_today:156,received_today:243,sent_total:3456,received_total:4567,delivery_rate:98.5,read_rate:87.2},uptime:86400,version:"2.22.24.78",last_activity:(new Date).toISOString(),health_score:95,issues:[]};C(e),_(!1)}catch(Ha){_(!1)}},A=e=>{const s=Math.floor(e/86400),t=Math.floor(e%86400/3600),a=Math.floor(e%3600/60);return s>0?`${s}d ${t}h ${a}m`:t>0?`${t}h ${a}m`:`${a}m`},E=e=>new Date(e).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),L=e=>{switch(e){case"connected":return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[ks.jsx(j,{className:"h-3 w-3 mr-1"}),"Conectado"]});case"connecting":return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[ks.jsx(Z,{className:"h-3 w-3 mr-1 animate-spin"}),"Conectando"]});case"disconnected":return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[ks.jsx(me,{className:"h-3 w-3 mr-1"}),"Desconectado"]});default:return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[ks.jsx(P,{className:"h-3 w-3 mr-1"}),"Erro"]})}},I=e=>{switch(e){case"healthy":return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[ks.jsx(j,{className:"h-3 w-3 mr-1"}),"Saudável"]});case"warning":return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[ks.jsx(P,{className:"h-3 w-3 mr-1"}),"Atenção"]});case"critical":return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[ks.jsx(P,{className:"h-3 w-3 mr-1"}),"Crítico"]});default:return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[ks.jsx(h,{className:"h-3 w-3 mr-1"}),"Desconhecido"]})}},D=e=>{if(!e.message_stats)return null;const s=e.message_stats,t=(s.sent_today>0?Math.round(s.sent_today/s.sent_total*100):0)>20,a=(s.received_today>0?Math.round(s.received_today/s.received_total*100):0)>20;return ks.jsxs("div",{className:"flex items-center space-x-4",children:[ks.jsxs("div",{className:"flex items-center",children:[ks.jsx(ne,{className:"h-4 w-4 text-blue-500 mr-1"}),ks.jsx("span",{className:"text-sm text-gray-700",children:s.sent_today}),t?ks.jsx(xe,{className:"h-3 w-3 text-green-500 ml-1"}):ks.jsx(he,{className:"h-3 w-3 text-red-500 ml-1"})]}),ks.jsxs("div",{className:"flex items-center",children:[ks.jsx(f,{className:"h-4 w-4 text-purple-500 mr-1"}),ks.jsx("span",{className:"text-sm text-gray-700",children:s.received_today}),a?ks.jsx(xe,{className:"h-3 w-3 text-green-500 ml-1"}):ks.jsx(he,{className:"h-3 w-3 text-red-500 ml-1"})]})]})},O=y?s.find(e=>e.id===y):null;return ks.jsxs("div",{className:"space-y-6",children:[ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx(ee,{className:"h-6 w-6 text-gray-600"}),ks.jsxs("div",{children:[ks.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Monitoramento de WhatsApp"}),ks.jsxs("p",{className:"text-sm text-gray-600",children:[s.length," ",1===s.length?"sessão":"sessões"," encontradas"]})]})]}),ks.jsxs("div",{className:"flex items-center space-x-4",children:[ks.jsxs(r,{to:"/client/whatsapp",className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900",children:[ks.jsx(ae,{className:"h-4 w-4"}),ks.jsx("span",{children:"Voltar para Conexão"})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("span",{className:"text-sm text-gray-500",children:"Auto-refresh:"}),ks.jsxs("select",{value:o,onChange:e=>d(Number(e.target.value)),className:"text-sm border border-gray-300 rounded-md p-1",disabled:!m,children:[ks.jsx("option",{value:"10",children:"10s"}),ks.jsx("option",{value:"30",children:"30s"}),ks.jsx("option",{value:"60",children:"1m"}),ks.jsx("option",{value:"300",children:"5m"})]}),ks.jsxs("label",{className:"inline-flex items-center cursor-pointer",children:[ks.jsx("input",{type:"checkbox",checked:m,onChange:()=>x(!m),className:"sr-only peer"}),ks.jsx("div",{className:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),ks.jsx("button",{onClick:()=>{if(S(),y&&s.length>0){const e=s.find(e=>e.id===y);e&&T(e.session_name)}g(new Date)},disabled:n,className:"p-2 text-gray-600 hover:text-gray-900 bg-white border border-gray-300 rounded-md hover:bg-gray-50",title:"Atualizar",children:n?ks.jsx(u,{className:"h-5 w-5 animate-spin"}):ks.jsx(Z,{className:"h-5 w-5"})})]})]}),l&&ks.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:l}),ks.jsxs("div",{className:"text-xs text-gray-500 text-right",children:["Última atualização: ",p.toLocaleTimeString()]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Visão Geral das Sessões"}),n&&0===s.length?ks.jsx("div",{className:"flex items-center justify-center py-12",children:ks.jsx(u,{className:"h-8 w-8 text-gray-400 animate-spin"})}):0===s.length?ks.jsxs("div",{className:"text-center py-12",children:[ks.jsx(ee,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),ks.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma sessão encontrada"}),ks.jsx("p",{className:"text-gray-500",children:"Conecte seu WhatsApp para começar a monitorar"}),ks.jsx(r,{to:"/client/whatsapp",className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Conectar WhatsApp"})]}):ks.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(e=>ks.jsxs("div",{className:"bg-white rounded-lg border-2 p-4 cursor-pointer transition-all hover:shadow-md "+(y===e.id?"border-blue-500 shadow-md":"border-gray-200"),onClick:()=>b(e.id),children:[ks.jsxs("div",{className:"flex items-center justify-between mb-3",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(ee,{className:"h-5 w-5 text-gray-600"}),ks.jsx("h4",{className:"text-md font-medium text-gray-900",children:e.session_name})]}),L(e.status)]}),ks.jsxs("div",{className:"space-y-2",children:[ks.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[ks.jsx(re,{className:"h-4 w-4 text-gray-400"}),ks.jsx("span",{className:"text-gray-700",children:e.phone_number||"Não conectado"})]}),e.connection_stats&&ks.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[ks.jsx(R,{className:"h-4 w-4 text-gray-400"}),ks.jsxs("span",{className:"text-gray-700",children:["Uptime: ",A(e.connection_stats.uptime)]})]}),e.message_stats&&D(e),e.health_status&&ks.jsx("div",{className:"flex items-center space-x-2 text-sm mt-2",children:I(e.health_status.status)})]})]},e.id))})]}),O&&ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[ks.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50 flex justify-between items-center",children:[ks.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Detalhes da Sessão: ",O.session_name]}),ks.jsx("button",{onClick:()=>v(!N),className:"text-sm text-blue-600 hover:text-blue-800",children:N?"Mostrar Menos":"Mostrar Mais"})]}),ks.jsxs("div",{className:"p-6",children:[ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[ks.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[ks.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Informações Básicas"}),ks.jsxs("div",{className:"space-y-2",children:[ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),ks.jsx("span",{className:"text-sm font-medium",children:L(O.status)})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Número:"}),ks.jsx("span",{className:"text-sm font-medium",children:O.phone_number||"N/A"})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Criado em:"}),ks.jsx("span",{className:"text-sm font-medium",children:E(O.created_at)})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Última atividade:"}),ks.jsx("span",{className:"text-sm font-medium",children:O.last_seen?E(O.last_seen):"N/A"})]})]})]}),O.connection_stats&&ks.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[ks.jsx("h4",{className:"text-sm font-semibold text-blue-700 mb-3",children:"Estatísticas de Conexão"}),ks.jsxs("div",{className:"space-y-2",children:[ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-blue-600",children:"Uptime:"}),ks.jsx("span",{className:"text-sm font-medium",children:A(O.connection_stats.uptime)})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-blue-600",children:"Conectado desde:"}),ks.jsx("span",{className:"text-sm font-medium",children:E(O.connection_stats.connected_since)})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-blue-600",children:"Reconexões:"}),ks.jsx("span",{className:"text-sm font-medium",children:O.connection_stats.reconnect_count})]}),O.connection_stats.last_reconnect&&ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-blue-600",children:"Última reconexão:"}),ks.jsx("span",{className:"text-sm font-medium",children:E(O.connection_stats.last_reconnect)})]})]})]}),O.message_stats&&ks.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[ks.jsx("h4",{className:"text-sm font-semibold text-green-700 mb-3",children:"Estatísticas de Mensagens"}),ks.jsxs("div",{className:"space-y-2",children:[ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-green-600",children:"Enviadas hoje:"}),ks.jsx("span",{className:"text-sm font-medium",children:O.message_stats.sent_today})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-green-600",children:"Recebidas hoje:"}),ks.jsx("span",{className:"text-sm font-medium",children:O.message_stats.received_today})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-green-600",children:"Taxa de entrega:"}),ks.jsxs("span",{className:"text-sm font-medium",children:[O.message_stats.delivery_rate,"%"]})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-green-600",children:"Taxa de leitura:"}),ks.jsxs("span",{className:"text-sm font-medium",children:[O.message_stats.read_rate,"%"]})]})]})]})]}),N&&ks.jsxs("div",{className:"mt-6",children:[ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[O.device_info&&ks.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[ks.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Informações do Dispositivo"}),ks.jsxs("div",{className:"space-y-2",children:[ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Plataforma:"}),ks.jsx("span",{className:"text-sm font-medium",children:O.device_info.platform||"N/A"})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Fabricante:"}),ks.jsx("span",{className:"text-sm font-medium",children:O.device_info.device_manufacturer||"N/A"})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Modelo:"}),ks.jsx("span",{className:"text-sm font-medium",children:O.device_info.device_model||"N/A"})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Versão do OS:"}),ks.jsx("span",{className:"text-sm font-medium",children:O.device_info.os_version||"N/A"})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Versão do WhatsApp:"}),ks.jsx("span",{className:"text-sm font-medium",children:O.device_info.wa_version||"N/A"})]}),O.device_info.battery&&ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Bateria:"}),ks.jsxs("div",{className:"flex items-center",children:[ks.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:ks.jsx("div",{className:"h-2 rounded-full "+(O.device_info.battery>50?"bg-green-500":O.device_info.battery>20?"bg-yellow-500":"bg-red-500"),style:{width:`${O.device_info.battery}%`}})}),ks.jsxs("span",{className:"text-sm font-medium",children:[O.device_info.battery,"%"]})]})]})]})]}),O.health_status&&ks.jsxs("div",{className:"rounded-lg p-4 "+("healthy"===O.health_status.status?"bg-green-50":"warning"===O.health_status.status?"bg-yellow-50":"bg-red-50"),children:[ks.jsx("h4",{className:"text-sm font-semibold mb-3 "+("healthy"===O.health_status.status?"text-green-700":"warning"===O.health_status.status?"text-yellow-700":"text-red-700"),children:"Status de Saúde"}),ks.jsxs("div",{className:"space-y-2",children:[ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm "+("healthy"===O.health_status.status?"text-green-600":"warning"===O.health_status.status?"text-yellow-600":"text-red-600"),children:"Status:"}),ks.jsx("span",{className:"text-sm font-medium",children:I(O.health_status.status)})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm "+("healthy"===O.health_status.status?"text-green-600":"warning"===O.health_status.status?"text-yellow-600":"text-red-600"),children:"Última verificação:"}),ks.jsx("span",{className:"text-sm font-medium",children:E(O.health_status.last_check)})]}),O.health_status.issues.length>0&&ks.jsxs("div",{className:"mt-2",children:[ks.jsx("span",{className:"text-sm "+("warning"===O.health_status.status?"text-yellow-600":"text-red-600"),children:"Problemas detectados:"}),ks.jsx("ul",{className:"mt-1 space-y-1",children:O.health_status.issues.map((e,s)=>ks.jsxs("li",{className:"text-sm flex items-start",children:[ks.jsx(P,{className:"h-4 w-4 mr-1 mt-0.5 text-red-500"}),ks.jsx("span",{children:e})]},s))})]})]})]})]}),O.message_stats&&ks.jsxs("div",{className:"mt-6 bg-white rounded-lg border border-gray-200 p-4",children:[ks.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Estatísticas Detalhadas de Mensagens"}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[ks.jsx("div",{className:"bg-blue-50 rounded-lg p-3",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-xs font-medium text-blue-600",children:"Total Enviadas"}),ks.jsx("p",{className:"text-xl font-bold text-blue-800",children:O.message_stats.sent_total.toLocaleString()})]}),ks.jsx(ne,{className:"h-8 w-8 text-blue-500"})]})}),ks.jsx("div",{className:"bg-purple-50 rounded-lg p-3",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-xs font-medium text-purple-600",children:"Total Recebidas"}),ks.jsx("p",{className:"text-xl font-bold text-purple-800",children:O.message_stats.received_total.toLocaleString()})]}),ks.jsx(f,{className:"h-8 w-8 text-purple-500"})]})}),ks.jsx("div",{className:"bg-green-50 rounded-lg p-3",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-xs font-medium text-green-600",children:"Taxa de Entrega"}),ks.jsxs("p",{className:"text-xl font-bold text-green-800",children:[O.message_stats.delivery_rate,"%"]})]}),ks.jsx(j,{className:"h-8 w-8 text-green-500"})]})}),ks.jsx("div",{className:"bg-orange-50 rounded-lg p-3",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-xs font-medium text-orange-600",children:"Taxa de Resposta"}),ks.jsxs("p",{className:"text-xl font-bold text-orange-800",children:[O.message_stats.response_rate,"%"]})]}),ks.jsx(ie,{className:"h-8 w-8 text-orange-500"})]})})]}),ks.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-4",children:[ks.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[ks.jsx("h5",{className:"text-xs font-medium text-gray-700 mb-2",children:"Qualidade da Conexão"}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(le,{className:"h-5 w-5 text-green-500"}),ks.jsx("div",{className:"flex-1",children:ks.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:ks.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"90%"}})})}),ks.jsx("span",{className:"text-sm font-medium",children:"Excelente"})]})]}),ks.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[ks.jsx("h5",{className:"text-xs font-medium text-gray-700 mb-2",children:"Status da Rede"}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(ce,{className:"h-5 w-5 text-green-500"}),ks.jsx("span",{className:"text-sm font-medium",children:"Conectado"})]})]}),ks.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[ks.jsx("h5",{className:"text-xs font-medium text-gray-700 mb-2",children:"Saúde da Sessão"}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(oe,{className:"h-5 w-5 text-green-500"}),ks.jsx("span",{className:"text-sm font-medium",children:"Ótima"})]})]})]})]}),w&&ks.jsxs("div",{className:"mt-6 bg-white rounded-lg border border-gray-200 p-4",children:[ks.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[ks.jsx(M,{className:"h-4 w-4 mr-2 text-blue-600"}),"Monitoramento Avançado"]}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[ks.jsxs("div",{className:"space-y-4",children:[ks.jsxs("div",{children:[ks.jsx("h5",{className:"text-xs font-medium text-gray-700 mb-2",children:"Uso de Recursos"}),ks.jsxs("div",{className:"space-y-3",children:[ks.jsxs("div",{children:[ks.jsxs("div",{className:"flex justify-between items-center mb-1",children:[ks.jsx("span",{className:"text-xs text-gray-600",children:"CPU"}),ks.jsxs("span",{className:"text-xs text-gray-600",children:[w.cpu_usage,"%"]})]}),ks.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:ks.jsx("div",{className:"h-2 rounded-full "+(w.cpu_usage>80?"bg-red-500":w.cpu_usage>50?"bg-yellow-500":"bg-green-500"),style:{width:`${w.cpu_usage}%`}})})]}),ks.jsxs("div",{children:[ks.jsxs("div",{className:"flex justify-between items-center mb-1",children:[ks.jsx("span",{className:"text-xs text-gray-600",children:"Memória"}),ks.jsxs("span",{className:"text-xs text-gray-600",children:[w.memory_usage.used.toFixed(1)," / ",w.memory_usage.total," GB"]})]}),ks.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:ks.jsx("div",{className:"h-2 rounded-full "+(w.memory_usage.used/w.memory_usage.total>.8?"bg-red-500":w.memory_usage.used/w.memory_usage.total>.5?"bg-yellow-500":"bg-green-500"),style:{width:w.memory_usage.used/w.memory_usage.total*100+"%"}})})]})]})]}),ks.jsxs("div",{children:[ks.jsx("h5",{className:"text-xs font-medium text-gray-700 mb-2",children:"Conexão"}),ks.jsxs("div",{className:"flex items-center space-x-2",children:["wifi"===w.connection.type?ks.jsx(ce,{className:"h-4 w-4 text-green-500"}):ks.jsx(le,{className:"h-4 w-4 text-blue-500"}),ks.jsxs("span",{className:"text-sm text-gray-700",children:[w.connection.type.toUpperCase()," - ",w.connection.strength,"% de sinal"]})]})]})]}),ks.jsxs("div",{className:"space-y-4",children:[ks.jsxs("div",{children:[ks.jsx("h5",{className:"text-xs font-medium text-gray-700 mb-2",children:"Saúde do Sistema"}),ks.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[ks.jsx(oe,{className:"h-5 w-5 text-green-500"}),ks.jsxs("span",{className:"text-sm font-medium",children:["Score de Saúde: ",w.health_score,"/100"]})]}),w.issues.length>0?ks.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg",children:[ks.jsx("h6",{className:"text-xs font-medium text-yellow-800 mb-1",children:"Problemas Detectados:"}),ks.jsx("ul",{className:"space-y-1",children:w.issues.map((e,s)=>ks.jsxs("li",{className:"text-xs text-yellow-700 flex items-start",children:[ks.jsx(P,{className:"h-3 w-3 mr-1 mt-0.5 text-yellow-500"}),ks.jsx("span",{children:e})]},s))})]}):ks.jsx("div",{className:"bg-green-50 p-3 rounded-lg",children:ks.jsxs("div",{className:"flex items-center",children:[ks.jsx(j,{className:"h-4 w-4 mr-1 text-green-500"}),ks.jsx("span",{className:"text-xs text-green-700",children:"Nenhum problema detectado"})]})})]}),ks.jsxs("div",{children:[ks.jsx("h5",{className:"text-xs font-medium text-gray-700 mb-2",children:"Atividade"}),ks.jsxs("div",{className:"text-sm text-gray-700",children:["Última atividade: ",E(w.last_activity)]}),ks.jsxs("div",{className:"text-sm text-gray-700",children:["Versão: ",w.version]})]})]})]})]}),ks.jsxs("div",{className:"mt-6 flex flex-wrap gap-4",children:[ks.jsxs("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center space-x-2",children:[ks.jsx(Z,{className:"h-4 w-4"}),ks.jsx("span",{children:"Reconectar"})]}),ks.jsxs("button",{className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 flex items-center space-x-2",children:[ks.jsx(de,{className:"h-4 w-4"}),ks.jsx("span",{children:"Backup da Sessão"})]}),ks.jsxs("button",{className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 flex items-center space-x-2",children:[ks.jsx(M,{className:"h-4 w-4"}),ks.jsx("span",{children:"Diagnóstico Completo"})]}),ks.jsxs("button",{className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 flex items-center space-x-2",children:[ks.jsx(me,{className:"h-4 w-4"}),ks.jsx("span",{children:"Desconectar"})]})]})]})]})]}),ks.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:ks.jsxs("div",{className:"flex items-start space-x-3",children:[ks.jsx(F,{className:"h-6 w-6 text-blue-600 mt-0.5"}),ks.jsxs("div",{children:[ks.jsx("h3",{className:"text-md font-semibold text-blue-900 mb-2",children:"Dicas para Manter seu WhatsApp Saudável"}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-800",children:[ks.jsxs("div",{className:"flex items-start space-x-2",children:[ks.jsx(j,{className:"h-4 w-4 text-green-600 mt-0.5"}),ks.jsx("span",{children:"Mantenha o celular conectado à energia e Wi-Fi estável"})]}),ks.jsxs("div",{className:"flex items-start space-x-2",children:[ks.jsx(j,{className:"h-4 w-4 text-green-600 mt-0.5"}),ks.jsx("span",{children:"Evite enviar mais de 20 mensagens por minuto"})]}),ks.jsxs("div",{className:"flex items-start space-x-2",children:[ks.jsx(j,{className:"h-4 w-4 text-green-600 mt-0.5"}),ks.jsx("span",{children:"Mantenha o WhatsApp do celular atualizado"})]}),ks.jsxs("div",{className:"flex items-start space-x-2",children:[ks.jsx(j,{className:"h-4 w-4 text-green-600 mt-0.5"}),ks.jsx("span",{children:"Faça backup regular da sessão para evitar perda de conexão"})]})]})]})]})})]})},wa=()=>{const{user:e}=Ls(),[s,a]=t.useState(null),[r,i]=t.useState([]),[l,c]=t.useState([]),[o,d]=t.useState(""),[x,h]=t.useState(""),[p,g]=t.useState([]),[y,j]=t.useState(!1),[b,N]=t.useState(!1),[v,w]=t.useState(!1),[C,k]=t.useState(!1),[_,S]=t.useState(""),[T,A]=t.useState("#3B82F6"),[E,R]=t.useState(!0),[L,I]=t.useState(!0),[M,P]=t.useState([]),[D,O]=t.useState(!1),[B,q]=t.useState(!1),[F,U]=t.useState(null),W=t.useRef(null);t.useEffect(()=>{e?.companyId&&(V(),G())},[e?.companyId]),t.useEffect(()=>{s&&H(s)},[s]),t.useEffect(()=>{K()},[l]),t.useEffect(()=>{if(!L||!E)return;const t=setInterval(()=>{e?.companyId&&(V(),s&&H(s))},1e4);return()=>clearInterval(t)},[L,E,e?.companyId,s]);const V=async()=>{if(e?.companyId)try{O(!0),U(null);const s=await Es.getConversations(e.companyId);if(s.success&&s.data){const e=s.data.map(e=>({...e,last_message_time:new Date(e.last_message_time),created_at:new Date(e.created_at),updated_at:new Date(e.updated_at)}));i(e)}}catch(Ha){U("Não foi possível carregar as conversas. Tente novamente mais tarde.")}finally{O(!1)}},H=async s=>{if(e?.companyId)try{q(!0);const t=await Es.getMessages(e.companyId,s);if(t.success&&t.data){const a=t.data.map(e=>({...e,timestamp:new Date(e.timestamp)}));c(a),await Es.updateConversation(e.companyId,s,{unread_count:0}),V()}}catch(Ha){}finally{q(!1)}},G=async()=>{if(e?.companyId)try{const s=await Es.getTags(e.companyId);s.success&&s.data&&P(s.data.map(e=>({id:e.id,name:e.name,color:e.color,category:e.category,description:e.description,isDefault:e.is_default})))}catch(Ha){}},K=()=>{W.current?.scrollIntoView({behavior:"smooth"})},J=async()=>{if(o.trim()&&s&&e?.companyId)try{w(!0);const t={content:o,message_type:"text",sender_name:e.name};(await Es.sendMessage(e.companyId,s,t)).success&&(d(""),H(s))}catch(Ha){}finally{w(!1)}},Q=e=>{g(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},Y=()=>{g([]),h("")},X=n.useMemo(()=>[{id:"critical",name:"Críticas",icon:ks.jsx(ue,{className:"h-4 w-4"}),count:r.filter(e=>"urgent"===e.priority).length,color:"bg-red-500",description:"Conversas que precisam de atenção imediata",condition:e=>"urgent"===e.priority,priority:1},{id:"hot-leads",name:"Hot Leads",icon:ks.jsx(pe,{className:"h-4 w-4"}),count:r.filter(e=>e.tags.includes("hot-lead")).length,color:"bg-green-500",description:"Clientes com alta intenção de compra",condition:e=>e.tags.includes("hot-lead"),priority:2},{id:"vip-customers",name:"VIP",icon:ks.jsx(ge,{className:"h-4 w-4"}),count:r.filter(e=>e.tags.includes("vip")).length,color:"bg-purple-500",description:"Clientes VIP",condition:e=>e.tags.includes("vip"),priority:3},{id:"unassigned",name:"Não Atribuídas",icon:ks.jsx(z,{className:"h-4 w-4"}),count:r.filter(e=>!e.assigned_agent_id&&"waiting"===e.status).length,color:"bg-blue-500",description:"Conversas aguardando atribuição",condition:e=>!e.assigned_agent_id&&"waiting"===e.status,priority:6},{id:"new-customers",name:"Novos",icon:ks.jsx($,{className:"h-4 w-4"}),count:r.filter(e=>e.tags.includes("novo-cliente")).length,color:"bg-cyan-500",description:"Novos clientes - primeira interação",condition:e=>e.tags.includes("novo-cliente"),priority:7},{id:"support-issues",name:"Suporte",icon:ks.jsx(m,{className:"h-4 w-4"}),count:r.filter(e=>e.tags.includes("suporte")).length,color:"bg-indigo-500",description:"Questões de suporte técnico",condition:e=>e.tags.includes("suporte"),priority:8}],[r]),Z=n.useMemo(()=>{let e=r;return x&&(e=e.filter(e=>e.customer_name.toLowerCase().includes(x.toLowerCase())||e.customer_phone.includes(x)||e.customer_email?.toLowerCase().includes(x.toLowerCase())||e.last_message.toLowerCase().includes(x.toLowerCase())||e.tags.some(e=>e.toLowerCase().includes(x.toLowerCase())))),p.length>0&&(e=e.filter(e=>p.some(s=>{const t=X.find(e=>e.id===s);return!!t&&t.condition(e)}))),e.sort((e,s)=>{const t={urgent:3,high:2,medium:1,low:0},a=t[s.priority]-t[e.priority];return 0!==a?a:e.unread_count!==s.unread_count?s.unread_count-e.unread_count:s.last_message_time.getTime()-e.last_message_time.getTime()})},[r,x,p,X]),ee=r.find(e=>e.id===s),se=({tag:e,onRemove:s,onClick:t,size:a="sm",showRemove:r=!1})=>{const n=(e=>{const s=M.find(s=>s.name===e);return s?.color||"#6B7280"})(e),i=M.find(s=>s.name===e);return ks.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium cursor-pointer transition-all hover:scale-105 "+("md"===a?"px-3 py-1.5 text-sm":"px-2 py-1 text-xs"),style:{backgroundColor:n+"20",color:n,border:`1px solid ${n}40`},onClick:t,title:i?.description,children:[ks.jsx(Se,{className:"h-3 w-3"}),e,r&&s&&ks.jsx("button",{onClick:e=>{e.stopPropagation(),s()},className:"ml-1 hover:bg-red-100 rounded-full p-0.5",children:ks.jsx(be,{className:"h-3 w-3"})})]})},te=()=>ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 mb-4",children:[ks.jsxs("div",{className:"flex items-center justify-between mb-4",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx(Te,{className:"h-5 w-5 text-blue-600"}),ks.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Filtros Inteligentes"}),E&&ks.jsxs("div",{className:"flex items-center space-x-1 text-green-600",children:[ks.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),ks.jsx("span",{className:"text-xs font-medium",children:"TEMPO REAL"})]})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("button",{onClick:()=>R(!E),className:"px-3 py-1 rounded-full text-xs font-medium transition-colors "+(E?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"),children:E?"Tempo Real ON":"Tempo Real OFF"}),p.length>0&&ks.jsxs("button",{onClick:Y,className:"px-3 py-1 bg-red-100 text-red-800 rounded-full text-xs font-medium hover:bg-red-200 transition-colors",children:["Limpar (",p.length,")"]})]})]}),ks.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-2 mb-4",children:X.sort((e,s)=>e.priority-s.priority).map(e=>ks.jsxs("button",{onClick:()=>Q(e.id),className:"relative flex items-center space-x-2 p-3 rounded-lg border-2 transition-all duration-200 hover:scale-105 "+(p.includes(e.id)?"border-blue-500 bg-blue-50 shadow-md":"border-gray-200 bg-white hover:border-gray-300"),title:e.description,children:[ks.jsx("div",{className:`p-1 rounded ${e.color} text-white`,children:e.icon}),ks.jsxs("div",{className:"flex-1 text-left",children:[ks.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name}),ks.jsxs("div",{className:"text-xs text-gray-500",children:[e.count," itens"]})]}),e.count>0&&ks.jsx("div",{className:`absolute -top-1 -right-1 w-5 h-5 ${e.color} text-white text-xs rounded-full flex items-center justify-center font-bold`,children:e.count}),p.includes(e.id)&&ks.jsx("div",{className:"absolute inset-0 border-2 border-blue-500 rounded-lg animate-pulse"})]},e.id))})]});return ks.jsx("div",{className:"h-[calc(100vh-12rem)] bg-white rounded-lg border border-gray-200 overflow-hidden",children:ks.jsxs("div",{className:"flex h-full",children:[ks.jsxs("div",{className:(s?"hidden lg:block":"block")+" w-full lg:w-80 border-r border-gray-200 flex flex-col",children:[ks.jsxs("div",{className:"p-4 border-b border-gray-200",children:[ks.jsxs("div",{className:"flex items-center justify-between mb-4",children:[ks.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Conversas"}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("button",{onClick:()=>N(!b),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",title:"Gerenciar Tags",children:ks.jsx(fe,{className:"h-4 w-4"})}),ks.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:ks.jsx(ye,{className:"h-4 w-4"})})]})]}),ks.jsxs("div",{className:"relative mb-3",children:[ks.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),ks.jsx("input",{type:"text",placeholder:"Busca inteligente: nome, tags, sentimentos...",value:x,onChange:e=>h(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),x&&ks.jsx("button",{onClick:()=>h(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:ks.jsx(be,{className:"h-4 w-4"})})]}),ks.jsx("div",{className:"grid grid-cols-2 gap-2 mb-3",children:X.slice(0,4).map(e=>ks.jsxs("button",{onClick:()=>Q(e.id),className:"flex items-center space-x-2 p-2 rounded-lg text-xs transition-all "+(p.includes(e.id)?"bg-blue-50 text-blue-800 border border-blue-200":"bg-gray-50 text-gray-600 hover:bg-gray-100"),children:[ks.jsx("div",{className:`p-1 rounded ${e.color} text-white`,children:e.icon}),ks.jsxs("span",{children:[e.name," (",e.count,")"]})]},e.id))})]}),ks.jsx("div",{className:"flex-1 overflow-y-auto",children:D?ks.jsx("div",{className:"flex items-center justify-center h-full",children:ks.jsx(u,{className:"h-8 w-8 text-gray-400 animate-spin"})}):Z.length>0?Z.map(e=>ks.jsx("div",{onClick:()=>a(e.id),className:"p-4 border-b border-gray-100 cursor-pointer hover:bg-gray-50 transition-colors "+(s===e.id?"bg-primary-50 border-primary-200":""),children:ks.jsxs("div",{className:"flex items-start space-x-3",children:[ks.jsx("div",{className:"relative",children:e.customer_avatar_url?ks.jsx("img",{src:e.customer_avatar_url,alt:e.customer_name,className:"w-10 h-10 rounded-full"}):ks.jsx("div",{className:"w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center",children:ks.jsx(Ne,{className:"h-5 w-5 text-gray-600"})})}),ks.jsxs("div",{className:"flex-1 min-w-0",children:[ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsx("h3",{className:"text-sm font-medium text-gray-900 truncate",children:e.customer_name}),ks.jsx("span",{className:"text-xs text-gray-500",children:e.last_message_time.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})]}),ks.jsx("p",{className:"text-sm text-gray-600 truncate mt-1",children:e.last_message}),e.tags.length>0&&ks.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[e.tags.slice(0,3).map(e=>ks.jsx(se,{tag:e,size:"sm"},e)),e.tags.length>3&&ks.jsxs("span",{className:"text-xs text-gray-500",children:["+",e.tags.length-3]})]}),e.unread_count>0&&ks.jsx("div",{className:"flex justify-end mt-1",children:ks.jsx("span",{className:"inline-flex items-center justify-center w-5 h-5 text-xs font-medium text-white bg-primary-600 rounded-full",children:e.unread_count})})]})]})},e.id)):ks.jsxs("div",{className:"text-center py-12",children:[ks.jsx(f,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),ks.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma conversa encontrada"}),ks.jsx("p",{className:"text-gray-500",children:x||p.length>0?"Tente ajustar os filtros de busca":"Aguardando novas conversas..."})]})})]}),s?ks.jsxs("div",{className:"flex-1 flex flex-col",children:[ks.jsxs("div",{className:"p-4 border-b border-gray-200 bg-white",children:[ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx("button",{onClick:()=>a(null),className:"lg:hidden p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:ks.jsx(ae,{className:"h-4 w-4"})}),ks.jsxs("div",{className:"flex items-center space-x-3",children:[ee?.customer_avatar_url?ks.jsx("img",{src:ee.customer_avatar_url,alt:ee.customer_name,className:"w-10 h-10 rounded-full"}):ks.jsx("div",{className:"w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center",children:ks.jsx(Ne,{className:"h-5 w-5 text-gray-600"})}),ks.jsxs("div",{children:[ks.jsx("h3",{className:"text-sm font-medium text-gray-900",children:ee?.customer_name}),ks.jsx("div",{className:"flex items-center space-x-2 text-xs text-gray-500",children:ks.jsx("span",{children:ee?.customer_phone})})]})]})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("button",{onClick:()=>k(!C),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",title:"Editar Tags",children:ks.jsx(fe,{className:"h-4 w-4"})}),ks.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:ks.jsx(re,{className:"h-4 w-4"})}),ks.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:ks.jsx(ve,{className:"h-4 w-4"})}),ks.jsx("button",{onClick:()=>j(!y),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:ks.jsx(we,{className:"h-4 w-4"})})]})]}),ee&&ee.tags.length>0&&ks.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:ee.tags.map(s=>ks.jsx(se,{tag:s,size:"md",showRemove:C,onRemove:()=>(async(s,t)=>{if(e?.companyId)try{const a=r.find(e=>e.id===s);if(!a)return;const n=a.tags.filter(e=>e!==t);await Es.updateConversation(e.companyId,s,{tags:n}),V()}catch(Ha){}})(ee.id,s)},s))})]}),ks.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[B?ks.jsx("div",{className:"flex items-center justify-center h-full",children:ks.jsx(u,{className:"h-8 w-8 text-gray-400 animate-spin"})}):l.length>0?l.map(e=>ks.jsx("div",{className:"mb-4 flex "+("customer"===e.sender?"justify-start":"justify-end"),children:ks.jsxs("div",{className:"max-w-[80%] rounded-lg p-3 "+("customer"===e.sender?"bg-gray-100 text-gray-800":"bot"===e.sender?"bg-purple-100 text-purple-800":"bg-primary-100 text-primary-800"),children:[ks.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[ks.jsx("span",{className:"text-xs font-medium",children:e.sender_name}),ks.jsx("span",{className:"text-xs text-gray-500",children:new Date(e.timestamp).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})]}),"text"===e.message_type?ks.jsx("p",{className:"text-sm",children:e.content}):"image"===e.message_type&&e.file_url?ks.jsxs("div",{children:[ks.jsx("img",{src:e.file_url,alt:"Imagem",className:"rounded-md max-h-60 mb-1"}),e.content&&ks.jsx("p",{className:"text-sm mt-1",children:e.content})]}):"file"===e.message_type&&e.file_url?ks.jsxs("div",{className:"bg-white rounded-md p-2 flex items-center space-x-2",children:[ks.jsx(Ce,{className:"h-5 w-5 text-gray-500"}),ks.jsxs("div",{className:"flex-1 min-w-0",children:[ks.jsx("p",{className:"text-sm font-medium truncate",children:e.file_name}),ks.jsx("p",{className:"text-xs text-gray-500",children:e.file_size?`${Math.round(e.file_size/1024)} KB`:"Arquivo"})]}),ks.jsx("a",{href:e.file_url,target:"_blank",rel:"noopener noreferrer",className:"p-1 text-blue-600 hover:text-blue-800",children:ks.jsx(de,{className:"h-4 w-4"})})]}):ks.jsx("p",{className:"text-sm",children:e.content})]})},e.id)):ks.jsx("div",{className:"text-center py-4",children:ks.jsx("p",{className:"text-sm text-gray-500",children:"Nenhuma mensagem nesta conversa"})}),ks.jsx("div",{ref:W})]}),ks.jsx("div",{className:"p-4 border-t border-gray-200 bg-white",children:ks.jsxs("div",{className:"flex items-end space-x-2",children:[ks.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:ks.jsx(ke,{className:"h-4 w-4"})}),ks.jsx("div",{className:"flex-1 relative",children:ks.jsx("textarea",{value:o,onChange:e=>d(e.target.value),placeholder:"Digite sua mensagem...",rows:1,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 resize-none",onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),J())}})}),ks.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:ks.jsx(_e,{className:"h-4 w-4"})}),ks.jsx("button",{onClick:J,disabled:!o.trim()||v,className:"p-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"var(--color-primary)"},children:v?ks.jsx(u,{className:"h-4 w-4 animate-spin"}):ks.jsx(ne,{className:"h-4 w-4"})})]})})]}):ks.jsxs("div",{className:"flex-1 flex flex-col",children:[ks.jsx("div",{className:"p-6",children:ks.jsx(te,{})}),ks.jsx("div",{className:"flex-1 flex items-center justify-center bg-gray-50",children:ks.jsxs("div",{className:"text-center",children:[ks.jsx(f,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),ks.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Selecione uma conversa"}),ks.jsx("p",{className:"text-gray-500",children:"Use os filtros inteligentes para encontrar conversas específicas"})]})})]}),y&&ee&&ks.jsxs("div",{className:"w-80 border-l border-gray-200 bg-white p-4 overflow-y-auto",children:[ks.jsxs("div",{className:"flex items-center justify-between mb-4",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Informações"}),ks.jsx("button",{onClick:()=>j(!1),className:"p-1 text-gray-400 hover:text-gray-600",children:ks.jsx(be,{className:"h-4 w-4"})})]}),ks.jsxs("div",{className:"space-y-4",children:[ks.jsxs("div",{children:[ks.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Cliente"}),ks.jsxs("div",{className:"space-y-2 text-sm",children:[ks.jsxs("div",{children:[ks.jsx("span",{className:"text-gray-500",children:"Nome:"}),ks.jsx("span",{className:"ml-2 text-gray-900",children:ee.customer_name})]}),ks.jsxs("div",{children:[ks.jsx("span",{className:"text-gray-500",children:"Telefone:"}),ks.jsx("span",{className:"ml-2 text-gray-900",children:ee.customer_phone})]}),ee.customer_email&&ks.jsxs("div",{children:[ks.jsx("span",{className:"text-gray-500",children:"Email:"}),ks.jsx("span",{className:"ml-2 text-gray-900",children:ee.customer_email})]})]})]}),ks.jsxs("div",{children:[ks.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Tags"}),ks.jsxs("div",{className:"flex flex-wrap gap-2",children:[ee.tags.map(e=>ks.jsx(se,{tag:e,size:"md"},e)),0===ee.tags.length&&ks.jsx("span",{className:"text-sm text-gray-500 italic",children:"Nenhuma tag"})]}),ks.jsx("button",{onClick:()=>k(!0),className:"mt-2 text-sm text-blue-600 hover:text-blue-700",children:"Editar tags"})]}),ks.jsxs("div",{children:[ks.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Notas Internas"}),ks.jsx("textarea",{placeholder:"Adicionar nota interna...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500",rows:3,defaultValue:ee.internal_notes,onBlur:async s=>{if(s.target.value!==ee.internal_notes&&e?.companyId)try{await Es.updateConversation(e.companyId,ee.id,{internal_notes:s.target.value}),V()}catch(Ha){}}})]})]})]})]})})},Ca=()=>{const{user:e}=Ls(),[s,a]=t.useState(""),[r,n]=t.useState("all"),[i,l]=t.useState(!1),[c,o]=t.useState(null),[d,x]=t.useState(""),[h,p]=t.useState("#3B82F6"),[g,f]=t.useState("custom"),[y,b]=t.useState(""),[N,v]=t.useState([]),[w,C]=t.useState(!1),[k,_]=t.useState("usage"),[S,T]=t.useState("desc"),[A,E]=t.useState(!1),[L,I]=t.useState(null),[D,O]=t.useState([]);t.useEffect(()=>{e?.companyId&&B()},[e?.companyId]);const B=async()=>{if(e?.companyId)try{E(!0),I(null);const s=await Es.getTags(e.companyId);if(s.success&&s.data){const e=s.data.map(e=>({id:e.id,name:e.name,color:e.color,category:e.category,description:e.description,isDefault:e.is_default,usageCount:e.usage_count||0,createdAt:new Date(e.created_at),createdBy:e.created_by_name||"Sistema",lastUsed:e.last_used?new Date(e.last_used):void 0,aiSuggested:"ai-generated"===e.category,keywords:e.keywords||[]}));O(e)}}catch(Ha){I("Não foi possível carregar as tags. Tente novamente mais tarde.")}finally{E(!1)}},q=t.useMemo(()=>({totalTags:D.length,activelyUsed:D.filter(e=>e.usageCount>0).length,mostUsed:[...D].sort((e,s)=>s.usageCount-e.usageCount).slice(0,5),recentlyCreated:[...D].sort((e,s)=>s.createdAt.getTime()-e.createdAt.getTime()).slice(0,5),categoryDistribution:D.reduce((e,s)=>(e[s.category]=(e[s.category]||0)+1,e),{}),usageTrend:[{date:"2024-11-15",count:45},{date:"2024-11-16",count:52},{date:"2024-11-17",count:48},{date:"2024-11-18",count:67},{date:"2024-11-19",count:73},{date:"2024-11-20",count:89},{date:"2024-11-21",count:94}]}),[D]),F=t.useMemo(()=>{let e=D.filter(e=>{const t=e.name.toLowerCase().includes(s.toLowerCase())||e.description?.toLowerCase().includes(s.toLowerCase())||e.keywords?.some(e=>e.toLowerCase().includes(s.toLowerCase())),a="all"===r||e.category===r;return t&&a});return e.sort((e,s)=>{let t=0;switch(k){case"name":t=e.name.localeCompare(s.name);break;case"usage":default:t=e.usageCount-s.usageCount;break;case"created":t=e.createdAt.getTime()-s.createdAt.getTime();break;case"category":t=e.category.localeCompare(s.category)}return"asc"===S?t:-t}),e},[D,s,r,k,S]),U=()=>{v([])},V=e=>{const s={status:ks.jsx(j,{className:"h-3 w-3 mr-1"}),priority:ks.jsx(P,{className:"h-3 w-3 mr-1"}),department:ks.jsx(z,{className:"h-3 w-3 mr-1"}),custom:ks.jsx($,{className:"h-3 w-3 mr-1"}),"ai-generated":ks.jsx(Ee,{className:"h-3 w-3 mr-1"})};return ks.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${{status:"bg-green-100 text-green-800",priority:"bg-red-100 text-red-800",department:"bg-blue-100 text-blue-800",custom:"bg-purple-100 text-purple-800","ai-generated":"bg-indigo-100 text-indigo-800"}[e]}`,children:[s[e],{status:"Status",priority:"Prioridade",department:"Departamento",custom:"Personalizada","ai-generated":"IA Gerada"}[e]]})};return ks.jsxs("div",{className:"space-y-6 p-6",children:[ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx(fe,{className:"h-6 w-6 text-gray-600"}),ks.jsxs("div",{children:[ks.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Gerenciamento de Tags"}),ks.jsx("p",{className:"text-sm text-gray-600",children:"Organize e gerencie todas as tags do sistema"})]})]}),ks.jsx("div",{className:"flex items-center space-x-2",children:ks.jsxs("button",{onClick:()=>{o(null),x(""),b(""),p("#3B82F6"),f("custom"),l(!0)},className:"flex items-center space-x-2 px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors",style:{backgroundColor:"var(--color-primary)"},children:[ks.jsx(Ae,{className:"h-4 w-4"}),ks.jsx("span",{children:"Nova Tag"})]})})]}),L&&ks.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:L}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total de Tags"}),ks.jsx("p",{className:"text-2xl font-bold text-gray-900",children:q.totalTags})]}),ks.jsx(fe,{className:"h-8 w-8 text-blue-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Em Uso"}),ks.jsx("p",{className:"text-2xl font-bold text-green-600",children:q.activelyUsed})]}),ks.jsx(M,{className:"h-8 w-8 text-green-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Geradas por IA"}),ks.jsx("p",{className:"text-2xl font-bold text-purple-600",children:q.categoryDistribution["ai-generated"]||0})]}),ks.jsx(Ee,{className:"h-8 w-8 text-purple-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Mais Usada"}),ks.jsxs("p",{className:"text-lg font-bold text-orange-600",children:[q.mostUsed[0]?.usageCount||0," usos"]}),ks.jsx("p",{className:"text-xs text-gray-500",children:q.mostUsed[0]?.name})]}),ks.jsx(W,{className:"h-8 w-8 text-orange-600"})]})})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[ks.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4 mb-4",children:[ks.jsxs("div",{className:"flex-1 relative",children:[ks.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),ks.jsx("input",{type:"text",placeholder:"Buscar por nome, descrição ou palavras-chave...",value:s,onChange:e=>a(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),ks.jsxs("select",{value:r,onChange:e=>n(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"all",children:"Todas as Categorias"}),ks.jsx("option",{value:"status",children:"Status"}),ks.jsx("option",{value:"priority",children:"Prioridade"}),ks.jsx("option",{value:"department",children:"Departamento"}),ks.jsx("option",{value:"custom",children:"Personalizada"}),ks.jsx("option",{value:"ai-generated",children:"IA Gerada"})]}),ks.jsxs("select",{value:`${k}-${S}`,onChange:e=>{const[s,t]=e.target.value.split("-");_(s),T(t)},className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"usage-desc",children:"Mais Usadas"}),ks.jsx("option",{value:"usage-asc",children:"Menos Usadas"}),ks.jsx("option",{value:"name-asc",children:"Nome A-Z"}),ks.jsx("option",{value:"name-desc",children:"Nome Z-A"}),ks.jsx("option",{value:"created-desc",children:"Mais Recentes"}),ks.jsx("option",{value:"created-asc",children:"Mais Antigas"}),ks.jsx("option",{value:"category-asc",children:"Categoria A-Z"})]})]}),N.length>0&&ks.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[ks.jsxs("span",{className:"text-sm text-blue-800",children:[N.length," tag(s) selecionada(s)"]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("button",{onClick:async()=>{if(e?.companyId&&window.confirm(`Tem certeza que deseja excluir ${N.length} tags selecionadas?`))try{E(!0);for(const s of N)await Es.deleteTag(e.companyId,s);v([]),B()}catch(Ha){I("Não foi possível excluir as tags selecionadas. Tente novamente mais tarde.")}finally{E(!1)}},className:"px-3 py-1 bg-red-100 text-red-800 rounded-md text-sm hover:bg-red-200",children:"Excluir Selecionadas"}),ks.jsx("button",{onClick:U,className:"px-3 py-1 bg-gray-100 text-gray-800 rounded-md text-sm hover:bg-gray-200",children:"Limpar Seleção"})]})]})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[ks.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Tags (",F.length,")"]}),ks.jsx("div",{className:"flex items-center space-x-2",children:ks.jsx("button",{onClick:N.length===F.length?U:()=>{v(F.map(e=>e.id))},className:"text-sm text-blue-600 hover:text-blue-700",children:N.length===F.length?"Desmarcar Todas":"Selecionar Todas"})})]})}),A&&0===F.length?ks.jsx("div",{className:"flex items-center justify-center py-12",children:ks.jsx(u,{className:"h-8 w-8 text-gray-400 animate-spin"})}):ks.jsx("div",{className:"divide-y divide-gray-200",children:F.map(s=>{const t=0===(a=s.usageCount)?{color:"text-gray-400",label:"Não usada"}:a<10?{color:"text-yellow-600",label:"Pouco usada"}:a<50?{color:"text-blue-600",label:"Moderadamente usada"}:a<100?{color:"text-green-600",label:"Muito usada"}:{color:"text-purple-600",label:"Extremamente usada"};var a;return ks.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-4",children:[ks.jsx("input",{type:"checkbox",checked:N.includes(s.id),onChange:()=>{return e=s.id,void v(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e]);var e},className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1.5 rounded-full text-sm font-medium",style:{backgroundColor:s.color+"20",color:s.color,border:`1px solid ${s.color}40`},children:[ks.jsx(Se,{className:"h-3 w-3"}),s.name]}),s.aiSuggested&&ks.jsxs("div",{className:"flex items-center space-x-1 text-purple-600",children:[ks.jsx(Ee,{className:"h-3 w-3"}),ks.jsx("span",{className:"text-xs",children:"IA"})]})]}),ks.jsxs("div",{className:"flex-1",children:[ks.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[ks.jsx("h4",{className:"text-sm font-medium text-gray-900",children:s.name}),V(s.category),s.isDefault&&ks.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-800",children:[ks.jsx(m,{className:"h-3 w-3 mr-1"}),"Padrão"]})]}),s.description&&ks.jsx("p",{className:"text-sm text-gray-600 mb-2",children:s.description}),ks.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[ks.jsxs("span",{className:"flex items-center space-x-1",children:[ks.jsx(te,{className:"h-3 w-3"}),ks.jsxs("span",{className:t.color,children:[s.usageCount," usos (",t.label,")"]})]}),ks.jsxs("span",{className:"flex items-center space-x-1",children:[ks.jsx(R,{className:"h-3 w-3"}),ks.jsxs("span",{children:["Criada em ",s.createdAt.toLocaleDateString("pt-BR")]})]}),ks.jsxs("span",{className:"flex items-center space-x-1",children:[ks.jsx(z,{className:"h-3 w-3"}),ks.jsxs("span",{children:["por ",s.createdBy]})]}),s.lastUsed&&ks.jsxs("span",{className:"flex items-center space-x-1",children:[ks.jsx(M,{className:"h-3 w-3"}),ks.jsxs("span",{children:["Última vez: ",s.lastUsed.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})]})]})]}),s.keywords&&s.keywords.length>0&&ks.jsxs("div",{className:"mt-2",children:[ks.jsx("span",{className:"text-xs text-gray-500",children:"Palavras-chave: "}),s.keywords.map((e,s)=>ks.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-gray-100 text-gray-700 mr-1",children:e},s))]})]})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-gray-200",style:{backgroundColor:s.color},title:`Cor: ${s.color}`}),ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("button",{onClick:()=>{o(s),x(s.name),p(s.color),f(s.category),b(s.description||""),l(!0)},className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Editar",children:ks.jsx(Re,{className:"h-4 w-4"})}),ks.jsx("button",{onClick:()=>(async s=>{if(e?.companyId)try{E(!0);const t={name:`${s.name}-copy`,color:s.color,category:s.category,description:s.description?`${s.description} (cópia)`:`Cópia de: ${s.name}`,is_default:!1,keywords:s.keywords};(await Es.createTag(e.companyId,t)).success&&B()}catch(Ha){I("Não foi possível duplicar a tag. Tente novamente mais tarde.")}finally{E(!1)}})(s),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg",title:"Duplicar",children:ks.jsx(Le,{className:"h-4 w-4"})}),!s.isDefault&&ks.jsx("button",{onClick:()=>(async s=>{if(e?.companyId&&window.confirm("Tem certeza que deseja excluir esta tag?"))try{E(!0),(await Es.deleteTag(e.companyId,s)).success&&B()}catch(Ha){I("Não foi possível excluir a tag. Tente novamente mais tarde.")}finally{E(!1)}})(s.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Excluir",children:ks.jsx(Ie,{className:"h-4 w-4"})})]})]})]})},s.id)})}),!A&&0===F.length&&ks.jsxs("div",{className:"text-center py-12",children:[ks.jsx(fe,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),ks.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma tag encontrada"}),ks.jsx("p",{className:"text-gray-500",children:s||"all"!==r?"Tente ajustar os filtros de busca":"Comece criando sua primeira tag"})]})]}),ks.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[ks.jsx(W,{className:"h-5 w-5 mr-2 text-yellow-500"}),"Tags Mais Usadas"]}),ks.jsx("div",{className:"space-y-3",children:q.mostUsed.map((e,s)=>ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold text-white "+(0===s?"bg-yellow-500":1===s?"bg-gray-400":2===s?"bg-orange-500":"bg-blue-500"),children:s+1}),ks.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",style:{backgroundColor:e.color+"20",color:e.color,border:`1px solid ${e.color}40`},children:[ks.jsx(Se,{className:"h-2 w-2"}),e.name]})]}),ks.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[e.usageCount," usos"]})]},e.id))})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[ks.jsx(Me,{className:"h-5 w-5 mr-2 text-blue-500"}),"Tags Recentes"]}),ks.jsx("div",{className:"space-y-3",children:q.recentlyCreated.map(e=>ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",style:{backgroundColor:e.color+"20",color:e.color,border:`1px solid ${e.color}40`},children:[ks.jsx(Se,{className:"h-2 w-2"}),e.name]}),e.aiSuggested&&ks.jsx(Ee,{className:"h-3 w-3 text-purple-600",title:"Sugerida pela IA"})]}),ks.jsx("span",{className:"text-xs text-gray-500",children:e.createdAt.toLocaleDateString("pt-BR")})]},e.id))})]})]}),i&&ks.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:ks.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[ks.jsxs("div",{className:"flex items-center justify-between mb-4",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:c?"Editar Tag":"Nova Tag"}),ks.jsx("button",{onClick:()=>{l(!1),o(null),x(""),b(""),p("#3B82F6"),f("custom")},className:"text-gray-400 hover:text-gray-600",children:ks.jsx(be,{className:"h-5 w-5"})})]}),ks.jsxs("div",{className:"space-y-4",children:[ks.jsxs("div",{children:[ks.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome da Tag"}),ks.jsx("input",{type:"text",value:d,onChange:e=>x(e.target.value),placeholder:"Ex: cliente-vip",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),ks.jsxs("div",{children:[ks.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descrição"}),ks.jsx("textarea",{value:y,onChange:e=>b(e.target.value),placeholder:"Descrição opcional da tag...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),ks.jsxs("div",{children:[ks.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoria"}),ks.jsxs("select",{value:g,onChange:e=>f(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",children:[ks.jsx("option",{value:"custom",children:"Personalizada"}),ks.jsx("option",{value:"status",children:"Status"}),ks.jsx("option",{value:"priority",children:"Prioridade"}),ks.jsx("option",{value:"department",children:"Departamento"})]})]}),ks.jsxs("div",{children:[ks.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cor"}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("input",{type:"color",value:h,onChange:e=>p(e.target.value),className:"w-12 h-10 border border-gray-300 rounded cursor-pointer"}),ks.jsx("div",{className:"grid grid-cols-6 gap-1",children:["#EF4444","#F97316","#F59E0B","#EAB308","#84CC16","#22C55E","#10B981","#14B8A6","#06B6D4","#0EA5E9","#3B82F6","#6366F1","#8B5CF6","#A855F7","#C084FC","#E879F9","#F472B6","#FB7185"].map(e=>ks.jsx("button",{onClick:()=>p(e),className:"w-6 h-6 rounded border-2 "+(h===e?"border-gray-800":"border-gray-300"),style:{backgroundColor:e}},e))})]})]}),ks.jsxs("div",{children:[ks.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preview"}),ks.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1.5 rounded-full text-sm font-medium",style:{backgroundColor:h+"20",color:h,border:`1px solid ${h}40`},children:[ks.jsx(Se,{className:"h-3 w-3"}),d||"nome-da-tag"]})]})]}),ks.jsxs("div",{className:"flex items-center justify-end space-x-3 mt-6",children:[ks.jsx("button",{onClick:()=>{l(!1),o(null),x(""),b(""),p("#3B82F6"),f("custom")},className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancelar"}),ks.jsx("button",{onClick:c?async()=>{if(c&&d.trim()&&e?.companyId)try{E(!0);const s={name:d.toLowerCase().replace(/\s+/g,"-"),color:h,category:g,description:y,keywords:d.split(" ").filter(e=>e.length>2)};(await Es.updateTag(e.companyId,c.id,s)).success&&(o(null),x(""),b(""),p("#3B82F6"),f("custom"),l(!1),B())}catch(Ha){I("Não foi possível editar a tag. Tente novamente mais tarde.")}finally{E(!1)}}:async()=>{if(d.trim()&&e?.companyId)try{E(!0);const s={name:d.toLowerCase().replace(/\s+/g,"-"),color:h,category:g,description:y||`Tag personalizada: ${d}`,is_default:!1,keywords:d.split(" ").filter(e=>e.length>2)};(await Es.createTag(e.companyId,s)).success&&(x(""),b(""),p("#3B82F6"),f("custom"),l(!1),B())}catch(Ha){I("Não foi possível criar a tag. Tente novamente mais tarde.")}finally{E(!1)}},disabled:!d.trim()||A,className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",style:{backgroundColor:"var(--color-primary)"},children:A?ks.jsxs(ks.Fragment,{children:[ks.jsx(u,{className:"h-4 w-4 animate-spin"}),ks.jsx("span",{children:"Processando..."})]}):ks.jsx("span",{children:c?"Salvar":"Criar Tag"})})]})]})})]})},ka=()=>{const{user:e,hasPermission:s}=Ls(),[a,r]=t.useState(""),[n,i]=t.useState("all"),[l,c]=t.useState("all"),[o,d]=t.useState(!1),[x,p]=t.useState(null),[g,f]=t.useState([]),[y,b]=t.useState(!1),[N,v]=t.useState(null);if(!s("manage_users"))return ks.jsxs("div",{className:"text-center py-12",children:[ks.jsx(m,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),ks.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Acesso Restrito"}),ks.jsx("p",{className:"text-gray-500",children:"Você não tem permissão para gerenciar usuários."})]});t.useEffect(()=>{e?.companyId&&w()},[e?.companyId]);const w=async()=>{if(e?.companyId)try{b(!0),v(null);const s=await Es.getUsers(e.companyId);s.success&&s.data&&f(s.data.map(e=>({id:e.id,name:e.name,email:e.email,role:e.role,status:e.status,avatar:e.avatar_url,department:e.metadata?.department,phone:e.metadata?.phone,lastLogin:e.last_login?new Date(e.last_login).toLocaleString("pt-BR"):"Nunca",createdAt:e.created_at,permissions:e.permissions||[],stats:e.stats||{conversationsToday:0,avgResponseTime:0,satisfaction:0,totalConversations:0}})))}catch(Ha){v("Não foi possível carregar os usuários. Tente novamente mais tarde.")}finally{b(!1)}},C=e=>{const s={admin:ks.jsx(m,{className:"h-3 w-3 mr-1"}),supervisor:ks.jsx($,{className:"h-3 w-3 mr-1"}),agent:ks.jsx(U,{className:"h-3 w-3 mr-1"})};return ks.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${{admin:"bg-purple-100 text-purple-800",supervisor:"bg-blue-100 text-blue-800",agent:"bg-green-100 text-green-800"}[e]}`,children:[s[e],{admin:"Administrador",supervisor:"Supervisor",agent:"Agente"}[e]]})},k=e=>{const s={active:ks.jsx(j,{className:"h-3 w-3 mr-1"}),inactive:ks.jsx(me,{className:"h-3 w-3 mr-1"})};return ks.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${{active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800"}[e]}`,children:[s[e],{active:"Ativo",inactive:"Inativo"}[e]]})},_=(e,s)=>"satisfaction"===s?e>=4.5?"text-green-600":e>=4?"text-yellow-600":"text-red-600":"responseTime"===s?e<=120?"text-green-600":e<=180?"text-yellow-600":"text-red-600":"text-gray-600",S=g.filter(e=>{const s=e.name.toLowerCase().includes(a.toLowerCase())||e.email.toLowerCase().includes(a.toLowerCase())||e.department&&e.department.toLowerCase().includes(a.toLowerCase()),t="all"===n||e.role===n,r="all"===l||e.status===l;return s&&t&&r});return ks.jsxs("div",{className:"space-y-6",children:[ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx(z,{className:"h-6 w-6 text-gray-600"}),ks.jsxs("div",{children:[ks.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Gerenciamento de Usuários"}),ks.jsx("p",{className:"text-sm text-gray-600",children:"Gerencie a equipe da sua empresa"})]})]}),ks.jsxs("button",{onClick:()=>d(!0),className:"flex items-center space-x-2 px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors",style:{backgroundColor:"var(--color-primary)"},children:[ks.jsx(Ae,{className:"h-4 w-4"}),ks.jsx("span",{children:"Novo Usuário"})]})]}),N&&ks.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:N}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:[ks.jsxs("div",{className:"flex-1 relative",children:[ks.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),ks.jsx("input",{type:"text",placeholder:"Buscar por nome, email ou departamento...",value:a,onChange:e=>r(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),ks.jsxs("select",{value:n,onChange:e=>i(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"all",children:"Todos os Cargos"}),ks.jsx("option",{value:"admin",children:"Administrador"}),ks.jsx("option",{value:"supervisor",children:"Supervisor"}),ks.jsx("option",{value:"agent",children:"Agente"})]}),ks.jsxs("select",{value:l,onChange:e=>c(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"all",children:"Todos os Status"}),ks.jsx("option",{value:"active",children:"Ativo"}),ks.jsx("option",{value:"inactive",children:"Inativo"})]})]})}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total de Usuários"}),ks.jsx("p",{className:"text-2xl font-bold text-gray-900",children:g.length})]}),ks.jsx(z,{className:"h-8 w-8 text-blue-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Usuários Ativos"}),ks.jsx("p",{className:"text-2xl font-bold text-green-600",children:g.filter(e=>"active"===e.status).length})]}),ks.jsx(U,{className:"h-8 w-8 text-green-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Agentes"}),ks.jsx("p",{className:"text-2xl font-bold text-purple-600",children:g.filter(e=>"agent"===e.role&&"active"===e.status).length})]}),ks.jsx(M,{className:"h-8 w-8 text-purple-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Administradores"}),ks.jsx("p",{className:"text-2xl font-bold text-orange-600",children:g.filter(e=>"admin"===e.role).length})]}),ks.jsx(m,{className:"h-8 w-8 text-orange-600"})]})})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[y?ks.jsx("div",{className:"flex items-center justify-center py-12",children:ks.jsx(u,{className:"h-8 w-8 text-gray-400 animate-spin"})}):ks.jsx("div",{className:"overflow-x-auto",children:ks.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[ks.jsx("thead",{className:"bg-gray-50",children:ks.jsxs("tr",{children:[ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usuário"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cargo"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Departamento"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Performance Hoje"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Último Acesso"}),ks.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),ks.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:S.map(s=>ks.jsxs("tr",{className:"hover:bg-gray-50",children:[ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("div",{className:"flex items-center",children:[s.avatar?ks.jsx("img",{src:s.avatar,alt:s.name,className:"w-10 h-10 rounded-full"}):ks.jsx("div",{className:"w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center",children:ks.jsx(z,{className:"h-5 w-5 text-gray-600"})}),ks.jsxs("div",{className:"ml-4",children:[ks.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name}),ks.jsx("div",{className:"text-sm text-gray-500",children:s.email})]})]})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:C(s.role)}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:k(s.status)}),ks.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[ks.jsx("div",{className:"text-sm text-gray-900",children:s.department||"N/A"}),ks.jsx("div",{className:"text-sm text-gray-500",children:s.phone||"N/A"})]}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:"agent"===s.role&&"active"===s.status&&s.stats?ks.jsxs("div",{className:"space-y-1",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(O,{className:"h-3 w-3 text-gray-400"}),ks.jsxs("span",{className:"text-xs text-gray-600",children:[s.stats.conversationsToday," conversas"]})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(R,{className:"h-3 w-3 text-gray-400"}),ks.jsxs("span",{className:`text-xs ${_(s.stats.avgResponseTime,"responseTime")}`,children:[s.stats.avgResponseTime,"s resp."]})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx($,{className:"h-3 w-3 text-gray-400"}),ks.jsxs("span",{className:`text-xs ${_(s.stats.satisfaction,"satisfaction")}`,children:[s.stats.satisfaction,"/5"]})]})]}):ks.jsx("span",{className:"text-xs text-gray-500",children:"admin"===s.role?"Administração":"Sem dados"})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx(R,{className:"h-4 w-4 text-gray-400"}),ks.jsx("span",{className:"text-sm text-gray-500",children:s.lastLogin})]})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:ks.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[ks.jsx("button",{className:"text-blue-600 hover:text-blue-900 transition-colors",title:"Visualizar",children:ks.jsx(h,{className:"h-4 w-4"})}),ks.jsx("button",{className:"text-green-600 hover:text-green-900 transition-colors",title:"Editar",children:ks.jsx(Re,{className:"h-4 w-4"})}),s.id!==e?.id&&ks.jsx("button",{className:"text-red-600 hover:text-red-900 transition-colors",title:"Excluir",children:ks.jsx(Ie,{className:"h-4 w-4"})}),ks.jsx("button",{className:"text-gray-400 hover:text-gray-600 transition-colors",title:"Mais opções",children:ks.jsx(ye,{className:"h-4 w-4"})})]})})]},s.id))})]})}),!y&&0===S.length&&ks.jsxs("div",{className:"text-center py-12",children:[ks.jsx(z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),ks.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum usuário encontrado"}),ks.jsx("p",{className:"text-gray-500",children:a||"all"!==n||"all"!==l?"Tente ajustar os filtros de busca":"Comece adicionando usuários à sua equipe"})]})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[ks.jsx(W,{className:"h-5 w-5 mr-2 text-yellow-500"}),"Performance da Equipe Hoje"]}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[ks.jsxs("div",{className:"text-center",children:[ks.jsx("div",{className:"text-3xl font-bold text-blue-600",children:g.filter(e=>"agent"===e.role&&"active"===e.status&&e.stats).reduce((e,s)=>e+(s.stats?.conversationsToday||0),0)}),ks.jsx("div",{className:"text-sm text-gray-600",children:"Total de Conversas"})]}),ks.jsxs("div",{className:"text-center",children:[ks.jsxs("div",{className:"text-3xl font-bold text-green-600",children:[Math.round(g.filter(e=>"agent"===e.role&&"active"===e.status&&e.stats&&e.stats.avgResponseTime>0).reduce((e,s,t,a)=>e+(s.stats?.avgResponseTime||0)/(a.length||1),0)),"s"]}),ks.jsx("div",{className:"text-sm text-gray-600",children:"Tempo Médio Resposta"})]}),ks.jsxs("div",{className:"text-center",children:[ks.jsx("div",{className:"text-3xl font-bold text-purple-600",children:g.filter(e=>"agent"===e.role&&"active"===e.status&&e.stats&&e.stats.satisfaction>0).reduce((e,s,t,a)=>e+(s.stats?.satisfaction||0)/(a.length||1),0).toFixed(1)}),ks.jsx("div",{className:"text-sm text-gray-600",children:"Satisfação Média"})]})]})]})]})},_a=()=>{const{user:e,hasPermission:s}=Ls(),[a,r]=t.useState(""),[n,i]=t.useState("all"),[l,c]=t.useState("all"),[o,d]=t.useState(!1),[x,g]=t.useState([]),[y,b]=t.useState(!1),[N,v]=t.useState(null);if(!s("manage_campaigns"))return ks.jsxs("div",{className:"text-center py-12",children:[ks.jsx(m,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),ks.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Acesso Restrito"}),ks.jsx("p",{className:"text-gray-500",children:"Você não tem permissão para gerenciar campanhas."})]});t.useEffect(()=>{e?.companyId&&w()},[e?.companyId]);const w=async()=>{if(e?.companyId)try{b(!0),v(null);const s=await Es.getCampaigns(e.companyId);s.success&&s.data&&g(s.data)}catch(Ha){v("Não foi possível carregar as campanhas. Tente novamente mais tarde.")}finally{b(!1)}},C=e=>{const s={running:ks.jsx(De,{className:"h-3 w-3 mr-1"}),active:ks.jsx(j,{className:"h-3 w-3 mr-1"}),paused:ks.jsx(Pe,{className:"h-3 w-3 mr-1"}),completed:ks.jsx(j,{className:"h-3 w-3 mr-1"}),scheduled:ks.jsx(R,{className:"h-3 w-3 mr-1"}),cancelled:ks.jsx(me,{className:"h-3 w-3 mr-1"}),draft:ks.jsx($e,{className:"h-3 w-3 mr-1"})};return ks.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${{running:"bg-green-100 text-green-800",active:"bg-blue-100 text-blue-800",paused:"bg-yellow-100 text-yellow-800",completed:"bg-gray-100 text-gray-800",scheduled:"bg-purple-100 text-purple-800",cancelled:"bg-red-100 text-red-800",draft:"bg-gray-100 text-gray-800"}[e]}`,children:[s[e],{running:"Em Execução",active:"Ativa",paused:"Pausada",completed:"Concluída",scheduled:"Agendada",cancelled:"Cancelada",draft:"Rascunho"}[e]]})},k=e=>{switch(e){case"whatsapp":return ks.jsx(ee,{className:"h-4 w-4 text-green-600"});case"email":return ks.jsx(f,{className:"h-4 w-4 text-blue-600"});case"sms":return ks.jsx(f,{className:"h-4 w-4 text-purple-600"});default:return ks.jsx(Oe,{className:"h-4 w-4 text-gray-600"})}},_=(e,s)=>0===s?0:(e/s*100).toFixed(1),S=(e,s)=>0===s?0:(e/s*100).toFixed(1),T=x.filter(e=>{const s=e.name.toLowerCase().includes(a.toLowerCase())||e.description.toLowerCase().includes(a.toLowerCase()),t="all"===n||e.status===n,r="all"===l||e.type===l;return s&&t&&r}),A=x.reduce((e,s)=>({sent:e.sent+s.stats.sent,delivered:e.delivered+s.stats.delivered,read:e.read+s.stats.read,clicked:e.clicked+s.stats.clicked,converted:e.converted+s.stats.converted,revenue:e.revenue+s.stats.revenue}),{sent:0,delivered:0,read:0,clicked:0,converted:0,revenue:0});return ks.jsxs("div",{className:"space-y-6",children:[ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx(ne,{className:"h-6 w-6 text-gray-600"}),ks.jsxs("div",{children:[ks.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Gerenciamento de Campanhas"}),ks.jsx("p",{className:"text-sm text-gray-600",children:"Crie e gerencie campanhas de marketing"})]})]}),ks.jsxs("button",{onClick:()=>d(!0),className:"flex items-center space-x-2 px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors",style:{backgroundColor:"var(--color-primary)"},children:[ks.jsx(Ae,{className:"h-4 w-4"}),ks.jsx("span",{children:"Nova Campanha"})]})]}),N&&ks.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:N}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4",children:[ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Enviadas"}),ks.jsx("p",{className:"text-2xl font-bold text-gray-900",children:A.sent.toLocaleString()})]}),ks.jsx(ne,{className:"h-8 w-8 text-blue-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Entregues"}),ks.jsx("p",{className:"text-2xl font-bold text-green-600",children:A.delivered.toLocaleString()}),ks.jsxs("p",{className:"text-xs text-gray-500",children:[S(A.delivered,A.sent),"% taxa entrega"]})]}),ks.jsx(j,{className:"h-8 w-8 text-green-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Lidas"}),ks.jsx("p",{className:"text-2xl font-bold text-purple-600",children:A.read.toLocaleString()}),ks.jsxs("p",{className:"text-xs text-gray-500",children:[S(A.read,A.delivered),"% taxa abertura"]})]}),ks.jsx(h,{className:"h-8 w-8 text-purple-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Cliques"}),ks.jsx("p",{className:"text-2xl font-bold text-orange-600",children:A.clicked.toLocaleString()}),ks.jsxs("p",{className:"text-xs text-gray-500",children:[(E=A.clicked,L=A.read,0===L?0:(E/L*100).toFixed(1)),"% taxa clique"]})]}),ks.jsx(O,{className:"h-8 w-8 text-orange-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Conversões"}),ks.jsx("p",{className:"text-2xl font-bold text-red-600",children:A.converted.toLocaleString()}),ks.jsxs("p",{className:"text-xs text-gray-500",children:[_(A.converted,A.sent),"% conversão"]})]}),ks.jsx(p,{className:"h-8 w-8 text-red-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Receita"}),ks.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["R$ ",(A.revenue/1e3).toFixed(0),"K"]}),ks.jsxs("p",{className:"text-xs text-gray-500",children:["R$ ",(A.revenue/A.converted||0).toFixed(0)," por conversão"]})]}),ks.jsx(te,{className:"h-8 w-8 text-green-600"})]})})]}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:[ks.jsxs("div",{className:"flex-1 relative",children:[ks.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),ks.jsx("input",{type:"text",placeholder:"Buscar campanhas...",value:a,onChange:e=>r(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),ks.jsxs("select",{value:n,onChange:e=>i(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"all",children:"Todos os Status"}),ks.jsx("option",{value:"running",children:"Em Execução"}),ks.jsx("option",{value:"active",children:"Ativa"}),ks.jsx("option",{value:"paused",children:"Pausada"}),ks.jsx("option",{value:"completed",children:"Concluída"}),ks.jsx("option",{value:"scheduled",children:"Agendada"}),ks.jsx("option",{value:"draft",children:"Rascunho"})]}),ks.jsxs("select",{value:l,onChange:e=>c(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"all",children:"Todos os Tipos"}),ks.jsx("option",{value:"promotional",children:"Promocional"}),ks.jsx("option",{value:"welcome",children:"Boas-vindas"}),ks.jsx("option",{value:"retargeting",children:"Retargeting"}),ks.jsx("option",{value:"survey",children:"Pesquisa"}),ks.jsx("option",{value:"product_launch",children:"Lançamento"})]})]})}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[y?ks.jsx("div",{className:"flex items-center justify-center py-12",children:ks.jsx(u,{className:"h-8 w-8 text-gray-400 animate-spin"})}):ks.jsx("div",{className:"overflow-x-auto",children:ks.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[ks.jsx("thead",{className:"bg-gray-50",children:ks.jsxs("tr",{children:[ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Campanha"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Performance"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Receita"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Criada em"}),ks.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),ks.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:T.map(e=>{return ks.jsxs("tr",{className:"hover:bg-gray-50",children:[ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("div",{className:"flex items-center",children:[k(e.channel),ks.jsxs("div",{className:"ml-3",children:[ks.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name}),ks.jsx("div",{className:"text-sm text-gray-500",children:e.description})]})]})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:C(e.status)}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(s=e.type,ks.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${{promotional:"bg-orange-100 text-orange-800",welcome:"bg-green-100 text-green-800",retargeting:"bg-blue-100 text-blue-800",survey:"bg-purple-100 text-purple-800",product_launch:"bg-pink-100 text-pink-800"}[s]}`,children:{promotional:"Promocional",welcome:"Boas-vindas",retargeting:"Retargeting",survey:"Pesquisa",product_launch:"Lançamento"}[s]}))}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("div",{className:"space-y-1",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(ne,{className:"h-3 w-3 text-gray-400"}),ks.jsxs("span",{className:"text-xs text-gray-600",children:[e.stats.sent.toLocaleString()," enviadas"]})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(h,{className:"h-3 w-3 text-gray-400"}),ks.jsxs("span",{className:"text-xs text-gray-600",children:[S(e.stats.read,e.stats.delivered),"% abertura"]})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(O,{className:"h-3 w-3 text-gray-400"}),ks.jsxs("span",{className:"text-xs text-gray-600",children:[_(e.stats.converted,e.stats.sent),"% conversão"]})]})]})}),ks.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[ks.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["R$ ",e.stats.revenue.toLocaleString()]}),ks.jsxs("div",{className:"text-xs text-gray-500",children:[e.stats.converted," conversões"]})]}),ks.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx(G,{className:"h-4 w-4 text-gray-400"}),ks.jsx("span",{className:"text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString("pt-BR")})]}),ks.jsxs("div",{className:"text-xs text-gray-500",children:["por ",e.createdBy]})]}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:ks.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[ks.jsx("button",{className:"text-blue-600 hover:text-blue-900 transition-colors",title:"Visualizar",children:ks.jsx(h,{className:"h-4 w-4"})}),ks.jsx("button",{className:"text-green-600 hover:text-green-900 transition-colors",title:"Editar",children:ks.jsx(Re,{className:"h-4 w-4"})}),"running"===e.status?ks.jsx("button",{className:"text-yellow-600 hover:text-yellow-900 transition-colors",title:"Pausar",children:ks.jsx(Pe,{className:"h-4 w-4"})}):"paused"===e.status?ks.jsx("button",{className:"text-green-600 hover:text-green-900 transition-colors",title:"Retomar",children:ks.jsx(De,{className:"h-4 w-4"})}):null,ks.jsx("button",{className:"text-red-600 hover:text-red-900 transition-colors",title:"Excluir",children:ks.jsx(Ie,{className:"h-4 w-4"})})]})})]},e.id);var s})})]})}),!y&&0===T.length&&ks.jsxs("div",{className:"text-center py-12",children:[ks.jsx(ne,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),ks.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma campanha encontrada"}),ks.jsx("p",{className:"text-gray-500",children:a||"all"!==n||"all"!==l?"Tente ajustar os filtros de busca":"Comece criando sua primeira campanha"})]})]}),ks.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[ks.jsx($,{className:"h-5 w-5 mr-2 text-yellow-500"}),"Melhor Performance"]}),x.filter(e=>e.stats.sent>0).sort((e,s)=>s.stats.converted/s.stats.sent-e.stats.converted/e.stats.sent).slice(0,3).map((e,s)=>ks.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100 last:border-b-0",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold text-white "+(0===s?"bg-yellow-500":1===s?"bg-gray-400":"bg-orange-500"),children:s+1}),ks.jsxs("div",{children:[ks.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name}),ks.jsxs("div",{className:"text-xs text-gray-500",children:[_(e.stats.converted,e.stats.sent),"% conversão"]})]})]}),ks.jsxs("div",{className:"text-right",children:[ks.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["R$ ",e.stats.revenue.toLocaleString()]}),ks.jsxs("div",{className:"text-xs text-gray-500",children:[e.stats.converted," conversões"]})]})]},e.id))]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[ks.jsx(R,{className:"h-5 w-5 mr-2 text-blue-500"}),"Campanhas Recentes"]}),x.sort((e,s)=>new Date(s.createdAt).getTime()-new Date(e.createdAt).getTime()).slice(0,3).map(e=>ks.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100 last:border-b-0",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[k(e.channel),ks.jsxs("div",{children:[ks.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name}),ks.jsx("div",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleDateString("pt-BR")})]})]}),ks.jsx("div",{className:"flex items-center space-x-2",children:C(e.status)})]},e.id))]})]})]});var E,L},Sa=()=>{const{user:e,hasPermission:s}=Ls(),[a,r]=t.useState("queue"),[n,i]=t.useState(""),[l,c]=t.useState([]),[o,d]=t.useState(!1),[x,p]=t.useState(!0),[g,f]=t.useState(!0),[y,j]=t.useState(5),[b,N]=t.useState([]),[v,w]=t.useState([]),[C,k]=t.useState(!1),[_,S]=t.useState(null);if(!s("manage_users"))return ks.jsxs("div",{className:"text-center py-12",children:[ks.jsx(m,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),ks.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Acesso Restrito"}),ks.jsx("p",{className:"text-gray-500",children:"Você não tem permissão para acessar a fila de atendimento."})]});t.useEffect(()=>{e?.companyId&&(T(),A())},[e?.companyId]),t.useEffect(()=>{if(!g||!x)return;const s=setInterval(()=>{e?.companyId&&(T(),A())},1e3*y);return()=>clearInterval(s)},[g,x,y,e?.companyId]);const T=async()=>{if(e?.companyId)try{k(!0),S(null),setTimeout(()=>{N([{id:"1",customerName:"Maria Silva",customerPhone:"+55 11 99999-1234",customerEmail:"maria@email.com",customerAvatar:"https://images.unsplash.com/photo-1494790108755-2616b612b786?w=40&h=40&fit=crop&crop=face",priority:"urgent",department:"vendas",category:"produto-premium",source:"whatsapp",waitTime:15,estimatedWaitTime:3,aiPredictedWaitTime:2,status:"waiting",tags:["vip","produto-premium","urgente","hot-lead"],customerValue:"platinum",urgencyScore:95,satisfactionHistory:4.8,conversationPreview:"Preciso de informações sobre o produto premium que vi no site...",metadata:{lastPurchase:"2024-10-15",totalSpent:15e3},createdAt:new Date(Date.now()-9e5),aiInsights:{sentiment:"positive",complexity:"medium",suggestedAgent:"Maria Santos",estimatedDuration:12,keywords:["produto premium","compra","urgente"],customerIntent:"purchase_intent",riskScore:15}},{id:"2",customerName:"João Santos",customerPhone:"+55 11 98888-5678",priority:"high",department:"suporte",category:"problema-tecnico",source:"webchat",waitTime:8,estimatedWaitTime:5,aiPredictedWaitTime:4,assignedAgent:"Carlos Lima",status:"assigned",tags:["problema-tecnico","cliente-recorrente","escalado"],customerValue:"gold",urgencyScore:78,satisfactionHistory:4.2,conversationPreview:"Estou com dificuldades para acessar minha conta...",metadata:{accountType:"premium",issueType:"login"},createdAt:new Date(Date.now()-48e4),aiInsights:{sentiment:"negative",complexity:"high",suggestedAgent:"Carlos Lima",estimatedDuration:18,keywords:["login","acesso","problema"],customerIntent:"support_request",riskScore:75}},{id:"3",customerName:"Ana Costa",customerPhone:"+55 11 97777-9012",priority:"medium",department:"vendas",category:"informacoes-gerais",source:"whatsapp",waitTime:22,estimatedWaitTime:8,aiPredictedWaitTime:6,status:"waiting",tags:["novo-cliente","interessado","lead-qualificado"],customerValue:"bronze",urgencyScore:45,satisfactionHistory:0,conversationPreview:"Gostaria de saber mais sobre os planos disponíveis...",metadata:{leadSource:"google-ads",interest:"plano-basico"},createdAt:new Date(Date.now()-132e4),aiInsights:{sentiment:"neutral",complexity:"low",suggestedAgent:"João Silva",estimatedDuration:8,keywords:["planos","informações","preço"],customerIntent:"information_seeking",riskScore:25}}]),k(!1)},500)}catch(Ha){S("Não foi possível carregar os dados da fila. Tente novamente mais tarde."),k(!1)}},A=async()=>{if(e?.companyId)try{setTimeout(()=>{w([{id:"agent-1",name:"Carlos Lima",email:"carlos@empresa.com",avatar:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face",status:"online",department:"suporte",specialties:["problema-tecnico","configuracao"],currentLoad:3,maxLoad:5,avgResponseTime:95,satisfactionScore:4.7,efficiency:92,languages:["pt-BR","en"],workingHours:{start:"08:00",end:"18:00",timezone:"America/Sao_Paulo"},skills:{"problema-tecnico":95,configuracao:88,vendas:45},tags:["senior","tecnico","especialista"]},{id:"agent-2",name:"Maria Santos",email:"maria@empresa.com",avatar:"https://images.unsplash.com/photo-1494790108755-2616b612b786?w=40&h=40&fit=crop&crop=face",status:"busy",department:"vendas",specialties:["produto-premium","consultoria"],currentLoad:5,maxLoad:5,avgResponseTime:78,satisfactionScore:4.9,efficiency:96,languages:["pt-BR","en","es"],workingHours:{start:"09:00",end:"19:00",timezone:"America/Sao_Paulo"},skills:{vendas:98,"produto-premium":95,consultoria:90},tags:["senior","vendas","consultora"]},{id:"agent-3",name:"Ana Costa",email:"ana@empresa.com",avatar:"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=40&h=40&fit=crop&crop=face",status:"online",department:"financeiro",specialties:["cobranca","pagamentos"],currentLoad:2,maxLoad:4,avgResponseTime:112,satisfactionScore:4.5,efficiency:89,languages:["pt-BR"],workingHours:{start:"08:00",end:"17:00",timezone:"America/Sao_Paulo"},skills:{cobranca:92,pagamentos:88,financeiro:85},tags:["pleno","financeiro","cobranca"]}])},500)}catch(Ha){}},E=t.useMemo(()=>[{id:"critical",name:"Críticos",icon:ks.jsx(ue,{className:"h-4 w-4"}),active:l.includes("critical"),count:b.filter(e=>e.urgencyScore>=80||"urgent"===e.priority).length,color:"bg-red-500",description:"Conversas que precisam de atenção imediata",condition:e=>e.urgencyScore>=80||"urgent"===e.priority,priority:1},{id:"vip",name:"VIP",icon:ks.jsx($,{className:"h-4 w-4"}),active:l.includes("vip"),count:b.filter(e=>"platinum"===e.customerValue||"gold"===e.customerValue).length,color:"bg-yellow-500",description:"Clientes VIP e Gold",condition:e=>"platinum"===e.customerValue||"gold"===e.customerValue,priority:2},{id:"ai-risk",name:"Alto Risco",icon:ks.jsx(P,{className:"h-4 w-4"}),active:l.includes("ai-risk"),count:b.filter(e=>(e.aiInsights?.riskScore||0)>=70).length,color:"bg-orange-500",description:"IA detectou alto risco de insatisfação",condition:e=>(e.aiInsights?.riskScore||0)>=70,priority:3},{id:"hot-leads",name:"Hot Leads",icon:ks.jsx(pe,{className:"h-4 w-4"}),active:l.includes("hot-leads"),count:b.filter(e=>"purchase_intent"===e.aiInsights?.customerIntent).length,color:"bg-green-500",description:"Clientes com alta intenção de compra",condition:e=>"purchase_intent"===e.aiInsights?.customerIntent,priority:4},{id:"waiting-long",name:"Espera Longa",icon:ks.jsx(R,{className:"h-4 w-4"}),active:l.includes("waiting-long"),count:b.filter(e=>e.waitTime>20).length,color:"bg-purple-500",description:"Aguardando há mais de 20 minutos",condition:e=>e.waitTime>20,priority:5},{id:"negative-sentiment",name:"Sentimento Negativo",icon:ks.jsx(Be,{className:"h-4 w-4"}),active:l.includes("negative-sentiment"),count:b.filter(e=>"negative"===e.aiInsights?.sentiment).length,color:"bg-red-400",description:"IA detectou sentimento negativo",condition:e=>"negative"===e.aiInsights?.sentiment,priority:6},{id:"first-time",name:"Primeira Vez",icon:ks.jsx(qe,{className:"h-4 w-4"}),active:l.includes("first-time"),count:b.filter(e=>e.tags.includes("primeira-vez")||e.tags.includes("novo-cliente")).length,color:"bg-blue-500",description:"Novos clientes - primeira interação",condition:e=>e.tags.includes("primeira-vez")||e.tags.includes("novo-cliente"),priority:7},{id:"escalated",name:"Escalados",icon:ks.jsx(Fe,{className:"h-4 w-4"}),active:l.includes("escalated"),count:b.filter(e=>"escalated"===e.status).length,color:"bg-indigo-500",description:"Conversas escaladas para supervisão",condition:e=>"escalated"===e.status,priority:8}],[b,l]),L=t.useMemo(()=>({totalInQueue:b.filter(e=>"waiting"===e.status).length,avgWaitTime:Math.round(b.reduce((e,s)=>e+s.waitTime,0)/b.length)||0,criticalItems:b.filter(e=>e.urgencyScore>=80).length,agentsAvailable:v.filter(e=>"online"===e.status&&e.currentLoad<e.maxLoad).length,throughputPerHour:45,satisfactionTrend:4.6,escalationRate:12,aiAccuracy:87}),[b,v]),I=t.useMemo(()=>{let e=b;return n&&(e=e.filter(e=>e.customerName.toLowerCase().includes(n.toLowerCase())||e.customerPhone.includes(n)||e.conversationPreview.toLowerCase().includes(n.toLowerCase())||e.tags.some(e=>e.toLowerCase().includes(n.toLowerCase())))),l.length>0&&(e=e.filter(e=>l.some(s=>{const t=E.find(e=>e.id===s);return!!t&&t.condition(e)}))),e.sort((e,s)=>{if(e.urgencyScore!==s.urgencyScore)return s.urgencyScore-e.urgencyScore;if(e.waitTime!==s.waitTime)return s.waitTime-e.waitTime;const t={platinum:4,gold:3,silver:2,bronze:1};return t[s.customerValue]-t[e.customerValue]})},[b,n,l,E]),M=()=>{c([]),i("")};return ks.jsxs("div",{className:"space-y-6",children:[ks.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[ks.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[ks.jsx(Te,{className:"h-8 w-8 text-primary-600",style:{color:"var(--color-primary)"}}),ks.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Fila Inteligente com IA"})]}),ks.jsx("p",{className:"text-gray-600",children:"Sistema avançado de distribuição com filtros dinâmicos e insights em tempo real"}),ks.jsxs("div",{className:"mt-4 flex items-center space-x-4 text-sm text-gray-500",children:[ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),ks.jsx("span",{children:"IA Ativa"})]}),ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),ks.jsx("span",{children:"Filtros Inteligentes"})]}),ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),ks.jsx("span",{children:"Predição em Tempo Real"})]})]})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 mb-6",children:[ks.jsxs("div",{className:"flex items-center justify-between mb-4",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx(Te,{className:"h-5 w-5 text-blue-600"}),ks.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Filtros Inteligentes"}),ks.jsx("div",{className:"flex items-center space-x-2",children:x&&ks.jsxs("div",{className:"flex items-center space-x-1 text-green-600",children:[ks.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),ks.jsx("span",{className:"text-xs font-medium",children:"TEMPO REAL"})]})})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("button",{onClick:()=>p(!x),className:"px-3 py-1 rounded-full text-xs font-medium transition-colors "+(x?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"),children:x?"Tempo Real ON":"Tempo Real OFF"}),l.length>0&&ks.jsxs("button",{onClick:M,className:"px-3 py-1 bg-red-100 text-red-800 rounded-full text-xs font-medium hover:bg-red-200 transition-colors",children:["Limpar (",l.length,")"]})]})]}),ks.jsxs("div",{className:"relative mb-4",children:[ks.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),ks.jsx("input",{type:"text",placeholder:"Busca inteligente: nome, telefone, tags, sentimentos...",value:n,onChange:e=>i(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),n&&ks.jsx("button",{onClick:()=>i(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:ks.jsx(be,{className:"h-4 w-4"})})]}),ks.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-2",children:E.sort((e,s)=>e.priority-s.priority).map(e=>ks.jsxs("button",{onClick:()=>{return s=e.id,void c(e=>e.includes(s)?e.filter(e=>e!==s):[...e,s]);var s},className:"relative flex items-center space-x-2 p-3 rounded-lg border-2 transition-all duration-200 hover:scale-105 "+(e.active?"border-blue-500 bg-blue-50 shadow-md":"border-gray-200 bg-white hover:border-gray-300"),title:e.description,children:[ks.jsx("div",{className:`p-1 rounded ${e.color} text-white`,children:e.icon}),ks.jsxs("div",{className:"flex-1 text-left",children:[ks.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name}),ks.jsxs("div",{className:"text-xs text-gray-500",children:[e.count," itens"]})]}),e.count>0&&ks.jsx("div",{className:`absolute -top-1 -right-1 w-5 h-5 ${e.color} text-white text-xs rounded-full flex items-center justify-center font-bold`,children:e.count}),e.active&&ks.jsx("div",{className:"absolute inset-0 border-2 border-blue-500 rounded-lg animate-pulse"})]},e.id))}),ks.jsxs("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-3",children:[ks.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 p-3 rounded-lg",children:[ks.jsx("div",{className:"text-lg font-bold text-blue-900",children:L.totalInQueue}),ks.jsx("div",{className:"text-xs text-blue-700",children:"Na Fila"})]}),ks.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-green-100 p-3 rounded-lg",children:[ks.jsxs("div",{className:"text-lg font-bold text-green-900",children:[L.avgWaitTime,"min"]}),ks.jsx("div",{className:"text-xs text-green-700",children:"Tempo Médio"})]}),ks.jsxs("div",{className:"bg-gradient-to-r from-red-50 to-red-100 p-3 rounded-lg",children:[ks.jsx("div",{className:"text-lg font-bold text-red-900",children:L.criticalItems}),ks.jsx("div",{className:"text-xs text-red-700",children:"Críticos"})]}),ks.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-purple-100 p-3 rounded-lg",children:[ks.jsx("div",{className:"text-lg font-bold text-purple-900",children:L.agentsAvailable}),ks.jsx("div",{className:"text-xs text-purple-700",children:"Agentes Livres"})]}),ks.jsxs("div",{className:"bg-gradient-to-r from-yellow-50 to-yellow-100 p-3 rounded-lg",children:[ks.jsx("div",{className:"text-lg font-bold text-yellow-900",children:L.throughputPerHour}),ks.jsx("div",{className:"text-xs text-yellow-700",children:"Por Hora"})]}),ks.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-indigo-100 p-3 rounded-lg",children:[ks.jsx("div",{className:"text-lg font-bold text-indigo-900",children:L.satisfactionTrend}),ks.jsx("div",{className:"text-xs text-indigo-700",children:"Satisfação"})]}),ks.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-orange-100 p-3 rounded-lg",children:[ks.jsxs("div",{className:"text-lg font-bold text-orange-900",children:[L.escalationRate,"%"]}),ks.jsx("div",{className:"text-xs text-orange-700",children:"Escalação"})]}),ks.jsxs("div",{className:"bg-gradient-to-r from-teal-50 to-teal-100 p-3 rounded-lg",children:[ks.jsxs("div",{className:"text-lg font-bold text-teal-900",children:[L.aiAccuracy,"%"]}),ks.jsx("div",{className:"text-xs text-teal-700",children:"IA Precisão"})]})]})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[ks.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Fila de Atendimento",I.length!==b.length&&ks.jsxs("span",{className:"ml-2 text-blue-600",children:["(",I.length," de ",b.length,")"]})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsxs("button",{className:"flex items-center space-x-1 px-3 py-1 text-sm bg-blue-100 text-blue-800 rounded-md hover:bg-blue-200",children:[ks.jsx(Ue,{className:"h-3 w-3"}),ks.jsx("span",{children:"Auto-Distribuir"})]}),ks.jsxs("button",{className:"flex items-center space-x-1 px-3 py-1 text-sm bg-green-100 text-green-800 rounded-md hover:bg-green-200",children:[ks.jsx(F,{className:"h-3 w-3"}),ks.jsx("span",{children:"Otimizar IA"})]})]})]})}),C?ks.jsx("div",{className:"flex items-center justify-center py-12",children:ks.jsx(u,{className:"h-8 w-8 text-gray-400 animate-spin"})}):ks.jsx("div",{className:"divide-y divide-gray-200",children:I.map(e=>{return ks.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors border-l-4 border-transparent hover:border-blue-500",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-4",children:[ks.jsxs("div",{className:"relative",children:[e.customerAvatar?ks.jsx("img",{src:e.customerAvatar,alt:e.customerName,className:"w-12 h-12 rounded-full"}):ks.jsx("div",{className:"w-12 h-12 bg-gray-300 rounded-full flex items-center justify-center",children:ks.jsx(z,{className:"h-6 w-6 text-gray-600"})}),ks.jsx("div",{className:`absolute -bottom-1 -right-1 w-4 h-4 rounded-full ${(e=>{switch(e){case"urgent":return"bg-red-500";case"high":return"bg-orange-500";case"medium":return"bg-yellow-500";case"low":return"bg-green-500";default:return"bg-gray-500"}})(e.priority)}`})]}),ks.jsxs("div",{className:"flex-1",children:[ks.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[ks.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:e.customerName}),(s=e.customerValue,ks.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${{platinum:"bg-purple-100 text-purple-800",gold:"bg-yellow-100 text-yellow-800",silver:"bg-gray-100 text-gray-800",bronze:"bg-orange-100 text-orange-800"}[s]}`,children:[{platinum:"💎",gold:"🥇",silver:"🥈",bronze:"🥉"}[s]," ",s.toUpperCase()]})),ks.jsxs("div",{className:"flex items-center space-x-1",children:[(e=>{switch(e){case"positive":return ks.jsx("span",{className:"text-green-500",children:"😊"});case"negative":return ks.jsx("span",{className:"text-red-500",children:"😠"});case"neutral":return ks.jsx("span",{className:"text-gray-500",children:"😐"});default:return ks.jsx("span",{className:"text-gray-400",children:"❓"})}})(e.aiInsights?.sentiment),ks.jsx("span",{className:"text-xs text-gray-500",children:e.aiInsights?.sentiment})]})]}),ks.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500 mb-2",children:[ks.jsxs("span",{className:"flex items-center space-x-1",children:[ks.jsx(re,{className:"h-3 w-3"}),ks.jsx("span",{children:e.customerPhone})]}),ks.jsxs("span",{className:"flex items-center space-x-1",children:[ks.jsx(ze,{className:"h-3 w-3"}),ks.jsx("span",{children:e.department})]}),ks.jsxs("span",{className:"flex items-center space-x-1",children:[ks.jsx(R,{className:"h-3 w-3"}),ks.jsxs("span",{children:[e.waitTime,"min aguardando",e.aiPredictedWaitTime&&ks.jsxs("span",{className:"text-blue-600 ml-1",children:["(IA: ",e.aiPredictedWaitTime,"min)"]})]})]})]}),ks.jsx("p",{className:"text-sm text-gray-700 mb-2",children:e.conversationPreview}),ks.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.tags.slice(0,3).map(e=>ks.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800",children:[ks.jsx(Se,{className:"h-2 w-2 mr-1"}),e]},e)),e.tags.length>3&&ks.jsxs("span",{className:"text-xs text-gray-500",children:["+",e.tags.length-3," mais"]})]}),e.aiInsights&&ks.jsxs("div",{className:"bg-purple-50 rounded-lg p-2 mt-2",children:[ks.jsxs("div",{className:"flex items-center space-x-4 text-xs",children:[ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx(Ee,{className:"h-3 w-3 text-purple-600"}),ks.jsxs("span",{className:"text-purple-800",children:["Intenção: ",e.aiInsights.customerIntent]})]}),ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx(O,{className:"h-3 w-3 text-purple-600"}),ks.jsxs("span",{className:"text-purple-800",children:["Risco: ",e.aiInsights.riskScore,"%"]})]}),ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx(D,{className:"h-3 w-3 text-purple-600"}),ks.jsxs("span",{className:"text-purple-800",children:["Duração estimada: ",e.aiInsights.estimatedDuration,"min"]})]})]}),e.aiInsights.keywords.length>0&&ks.jsx("div",{className:"mt-1",children:ks.jsxs("span",{className:"text-xs text-purple-700",children:["Palavras-chave: ",e.aiInsights.keywords.join(", ")]})})]})]})]}),ks.jsxs("div",{className:"flex items-center space-x-4",children:[ks.jsxs("div",{className:"text-center",children:[ks.jsx("div",{className:"text-lg font-bold "+(e.urgencyScore>=80?"text-red-600":e.urgencyScore>=60?"text-orange-600":e.urgencyScore>=40?"text-yellow-600":"text-green-600"),children:e.urgencyScore}),ks.jsx("div",{className:"text-xs text-gray-500",children:"Urgência"})]}),e.aiInsights?.suggestedAgent&&ks.jsxs("div",{className:"text-center",children:[ks.jsx("div",{className:"text-sm font-medium text-blue-600",children:e.aiInsights.suggestedAgent}),ks.jsx("div",{className:"text-xs text-gray-500",children:"IA Sugere"})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("button",{className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Visualizar",children:ks.jsx(h,{className:"h-4 w-4"})}),ks.jsx("button",{className:"p-2 text-green-600 hover:bg-green-50 rounded-lg",title:"Atribuir",children:ks.jsx(U,{className:"h-4 w-4"})}),ks.jsx("button",{className:"p-2 text-purple-600 hover:bg-purple-50 rounded-lg",title:"Transferir",children:ks.jsx(We,{className:"h-4 w-4"})}),ks.jsx("button",{className:"p-2 text-orange-600 hover:bg-orange-50 rounded-lg",title:"Priorizar",children:ks.jsx(Ve,{className:"h-4 w-4"})})]})]})]})},e.id);var s})}),!C&&0===I.length&&ks.jsxs("div",{className:"text-center py-12",children:[ks.jsx(Te,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),ks.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:l.length>0||n?"Nenhum item encontrado":"Fila vazia"}),ks.jsx("p",{className:"text-gray-500",children:l.length>0||n?"Tente ajustar os filtros ou busca":"Não há clientes aguardando atendimento no momento"})]})]})]})},Ta=({companyId:e,platform:s})=>{const{user:a}=Ls(),[n,i]=t.useState("disconnected"),[l,c]=t.useState(!1),[o,d]=t.useState(null),[m,x]=t.useState({}),[h,p]=t.useState({}),[g,f]=t.useState(""),[y,b]=t.useState(!1);t.useEffect(()=>{N()},[e,s]);const N=async()=>{try{c(!0),d(null),setTimeout(()=>{i("disconnected"),c(!1)},1e3)}catch(Ha){d(`Não foi possível verificar o status da conexão com ${s}`),i("error"),c(!1)}},v=()=>"instagram"===s?"Instagram Direct":"Facebook Messenger";return ks.jsxs("div",{className:"max-w-2xl mx-auto",children:[ks.jsx("div",{className:`rounded-lg border-2 p-6 mb-6 ${(()=>{switch(n){case"connected":return"bg-green-50 border-green-200";case"connecting":return"bg-yellow-50 border-yellow-200";default:return"bg-red-50 border-red-200"}})()}`,children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[(()=>{switch(n){case"connected":return ks.jsx(j,{className:"h-5 w-5 text-green-500"});case"connecting":return ks.jsx(Z,{className:"h-5 w-5 text-yellow-500 animate-spin"});default:return ks.jsx(se,{className:"h-5 w-5 text-red-500"})}})(),ks.jsxs("div",{children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:(()=>{switch(n){case"connected":return("instagram"===s?"Instagram":"Facebook")+" Conectado";case"connecting":return"Conectando...";case"error":return"Erro na Conexão";default:return("instagram"===s?"Instagram":"Facebook")+" Desconectado"}})()}),ks.jsx("p",{className:"text-sm text-gray-600",children:(()=>{switch(n){case"connected":return`Seu ${"instagram"===s?"Instagram":"Facebook"} está conectado à conta @${m.username}`;case"connecting":return`Conectando ao ${"instagram"===s?"Instagram":"Facebook"}...`;case"error":return"Ocorreu um erro ao conectar com o "+("instagram"===s?"Instagram":"Facebook");default:return`Conecte seu ${"instagram"===s?"Instagram":"Facebook"} para começar a receber mensagens`}})()}),o&&ks.jsx("p",{className:"text-sm text-red-600 mt-1",children:o})]})]}),ks.jsx("div",{className:"flex space-x-2",children:"connected"===n?ks.jsx("div",{className:"flex space-x-2",children:ks.jsx("button",{onClick:async()=>{try{c(!0),d(null),setTimeout(()=>{i("disconnected"),x({}),p({}),c(!1)},1e3)}catch(Ha){d(`Erro ao desconectar ${s}`),c(!1)}},disabled:l,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:opacity-50",children:l?ks.jsx(u,{className:"h-4 w-4 animate-spin"}):"Desconectar"})}):ks.jsx("button",{onClick:async()=>{b(!0)},disabled:l,className:"px-4 py-2 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50",style:{backgroundColor:"instagram"===s?"#E1306C":"#1877F2"},children:l?ks.jsx(u,{className:"h-4 w-4 animate-spin"}):`Conectar ${v()}`})})]})}),y&&ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-8 text-center mb-6",children:[ks.jsxs("div",{className:"mb-6",children:["instagram"===s?ks.jsx(Ke,{className:"h-12 w-12 text-pink-600"}):ks.jsx(Je,{className:"h-12 w-12 text-blue-600"}),ks.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mt-4 mb-2",children:["Conectar ",v()]}),ks.jsx("p",{className:"text-gray-600 mb-4",children:"Para conectar sua conta, precisamos de um token de acesso"})]}),ks.jsxs("div",{className:"max-w-md mx-auto",children:[ks.jsxs("div",{className:"mb-6",children:[ks.jsx("label",{htmlFor:"authCode",className:"block text-sm font-medium text-gray-700 text-left mb-1",children:"Token de Acesso"}),ks.jsx("input",{type:"text",id:"authCode",value:g,onChange:e=>f(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Cole seu token de acesso aqui"})]}),ks.jsxs("div",{className:"flex justify-between mb-6",children:[ks.jsx("button",{onClick:()=>b(!1),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",children:"Cancelar"}),ks.jsx("button",{onClick:async()=>{try{c(!0),d(null),setTimeout(()=>{i("connected"),b(!1),x({id:"instagram"===s?"12345678":"87654321",username:"instagram"===s?"empresa_demo":"Empresa Demo",name:"Empresa Demo",profilePicture:"https://images.unsplash.com/photo-1560250097-0b93528c311a?w=200&h=200&fit=crop&crop=faces",connectedSince:new Date}),p({uptime:0,connectedSince:new Date,messagesSent:0,messagesReceived:0}),c(!1)},2e3)}catch(Ha){d(`Erro ao conectar com ${s}`),c(!1)}},disabled:!g.trim()||l,className:"px-4 py-2 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50",style:{backgroundColor:"instagram"===s?"#E1306C":"#1877F2"},children:l?ks.jsx(u,{className:"h-4 w-4 animate-spin"}):"Conectar"})]}),ks.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-left",children:[ks.jsxs("h4",{className:"text-sm font-semibold text-blue-900 mb-2 flex items-center",children:[ks.jsx(He,{className:"h-4 w-4 mr-2"}),"Como obter seu token de acesso:"]}),ks.jsxs("ol",{className:"text-sm text-blue-800 space-y-2 list-decimal pl-5",children:[ks.jsxs("li",{children:["Acesse o ",ks.jsxs("a",{href:"instagram"===s?"https://developers.facebook.com/docs/instagram-api/":"https://developers.facebook.com/docs/messenger-platform/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline flex items-center",children:["Painel de Desenvolvedores ","instagram"===s?"Instagram":"Facebook",ks.jsx(Ge,{className:"h-3 w-3 ml-1"})]})]}),ks.jsx("li",{children:"Crie ou selecione um aplicativo"}),ks.jsx("li",{children:"Configure as permissões necessárias para mensagens"}),ks.jsx("li",{children:"Gere um token de acesso de longa duração"}),ks.jsx("li",{children:"Copie e cole o token no campo acima"})]})]})]})]}),"connected"===n&&ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:ks.jsxs("div",{className:"text-center",children:[ks.jsx("div",{className:"w-20 h-20 rounded-full mx-auto mb-4 overflow-hidden",children:m.profilePicture?ks.jsx("img",{src:m.profilePicture,alt:m.name,className:"w-full h-full object-cover"}):ks.jsx("div",{className:"w-full h-full flex items-center justify-center text-white "+("instagram"===s?"bg-gradient-to-r from-pink-500 to-purple-500":"bg-blue-600"),children:"instagram"===s?ks.jsx(Ke,{className:"h-10 w-10"}):ks.jsx(Je,{className:"h-10 w-10"})})}),ks.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:[v()," Conectado com Sucesso!"]}),ks.jsx("p",{className:"text-gray-600 mb-6",children:"Agora você pode receber e enviar mensagens através da plataforma"}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[ks.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[ks.jsx("div",{className:"font-semibold text-green-900",children:"Status"}),ks.jsx("div",{className:"text-green-700",children:"Online"})]}),ks.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[ks.jsx("div",{className:"font-semibold text-blue-900",children:"Conta"}),ks.jsxs("div",{className:"text-blue-700",children:["@",m.username]})]}),ks.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[ks.jsx("div",{className:"font-semibold text-purple-900",children:"ID"}),ks.jsx("div",{className:"text-purple-700",children:m.id})]})]}),void 0!==h.uptime&&ks.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[ks.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[ks.jsx("div",{className:"font-semibold text-gray-900",children:"Tempo Conectado"}),ks.jsx("div",{className:"text-gray-700",children:(e=>{if(!e)return"N/A";const s=Math.floor(e/86400),t=Math.floor(e%86400/3600),a=Math.floor(e%3600/60);return s>0?`${s}d ${t}h ${a}m`:t>0?`${t}h ${a}m`:`${a}m`})(h.uptime)})]}),ks.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[ks.jsx("div",{className:"font-semibold text-gray-900",children:"Mensagens Enviadas"}),ks.jsx("div",{className:"text-gray-700",children:h.messagesSent})]}),ks.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[ks.jsx("div",{className:"font-semibold text-gray-900",children:"Mensagens Recebidas"}),ks.jsx("div",{className:"text-gray-700",children:h.messagesReceived})]})]}),ks.jsx("div",{className:"mt-6",children:ks.jsxs(r,{to:`/client/${s}-monitoring`,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 inline-flex items-center space-x-2",children:[ks.jsx(te,{className:"h-4 w-4"}),ks.jsx("span",{children:"Acessar Monitoramento"})]})})]})}),ks.jsx("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-6",children:ks.jsxs("div",{className:"flex items-start space-x-3",children:[ks.jsx(F,{className:"h-5 w-5 text-blue-600 mt-0.5"}),ks.jsxs("div",{children:[ks.jsxs("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:["Dicas para integração com ",v()]}),ks.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[ks.jsxs("li",{className:"flex items-start",children:[ks.jsx(j,{className:"h-4 w-4 text-green-600 mr-2 mt-0.5"}),ks.jsx("span",{children:"Certifique-se de que sua conta tem permissões para mensagens"})]}),ks.jsxs("li",{className:"flex items-start",children:[ks.jsx(j,{className:"h-4 w-4 text-green-600 mr-2 mt-0.5"}),ks.jsx("span",{children:"Use tokens de acesso de longa duração para evitar desconexões"})]}),ks.jsxs("li",{className:"flex items-start",children:[ks.jsx(j,{className:"h-4 w-4 text-green-600 mr-2 mt-0.5"}),ks.jsx("span",{children:"Responda às mensagens dentro de 24 horas para manter a janela de mensagens ativa"})]}),ks.jsxs("li",{className:"flex items-start",children:[ks.jsx(j,{className:"h-4 w-4 text-green-600 mr-2 mt-0.5"}),ks.jsx("span",{children:"Siga as políticas de uso da plataforma para evitar bloqueios"})]})]})]})]})})]})},Aa=()=>{const{user:e}=Ls(),[s,a]=t.useState("instagram"),r=e?.companyId||"company-1";return ks.jsxs("div",{className:"space-y-6",children:[ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Integração com Redes Sociais"}),ks.jsx("p",{className:"text-gray-600",children:"Conecte suas contas de Instagram e Facebook para gerenciar todas as mensagens em um único lugar"}),ks.jsx("div",{className:"mt-4 bg-blue-50 border border-blue-200 rounded-lg p-4",children:ks.jsxs("div",{className:"flex items-start space-x-3",children:[ks.jsx(we,{className:"h-5 w-5 text-blue-600 mt-0.5"}),ks.jsxs("div",{children:[ks.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-1",children:"Integração Unificada"}),ks.jsx("p",{className:"text-sm text-blue-800",children:"Todas as mensagens de diferentes canais serão unificadas na mesma interface de atendimento, permitindo que você gerencie WhatsApp, Instagram e Facebook em um único lugar."})]})]})})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[ks.jsx("div",{className:"border-b border-gray-200",children:ks.jsxs("div",{className:"flex",children:[ks.jsx("button",{onClick:()=>a("instagram"),className:"px-4 py-3 text-sm font-medium whitespace-nowrap "+("instagram"===s?"border-b-2 border-pink-500 text-pink-600":"text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(Ke,{className:"h-4 w-4"}),ks.jsx("span",{children:"Instagram Direct"})]})}),ks.jsx("button",{onClick:()=>a("facebook"),className:"px-4 py-3 text-sm font-medium whitespace-nowrap "+("facebook"===s?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(Je,{className:"h-4 w-4"}),ks.jsx("span",{children:"Facebook Messenger"})]})}),ks.jsx("button",{onClick:()=>a("settings"),className:"px-4 py-3 text-sm font-medium whitespace-nowrap "+("settings"===s?"border-b-2 border-gray-500 text-gray-600":"text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(Qe,{className:"h-4 w-4"}),ks.jsx("span",{children:"Configurações"})]})})]})}),ks.jsxs("div",{className:"p-6",children:["instagram"===s&&ks.jsx(Ta,{companyId:r,platform:"instagram"}),"facebook"===s&&ks.jsx(Ta,{companyId:r,platform:"facebook"}),"settings"===s&&ks.jsxs("div",{className:"max-w-2xl mx-auto",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Configurações de Integração"}),ks.jsxs("div",{className:"space-y-6",children:[ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[ks.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Distribuição de Mensagens"}),ks.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Configure como as mensagens de diferentes canais serão distribuídas para os agentes"}),ks.jsxs("div",{className:"space-y-4",children:[ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("input",{type:"checkbox",id:"unified-queue",checked:!0,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),ks.jsx("label",{htmlFor:"unified-queue",className:"text-sm text-gray-700",children:"Fila unificada para todos os canais"})]}),ks.jsx("div",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full",children:"Recomendado"})]}),ks.jsxs("div",{className:"flex items-center",children:[ks.jsx("input",{type:"checkbox",id:"separate-queues",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),ks.jsx("label",{htmlFor:"separate-queues",className:"ml-2 text-sm text-gray-700",children:"Filas separadas por canal"})]}),ks.jsxs("div",{className:"flex items-center",children:[ks.jsx("input",{type:"checkbox",id:"agent-specialization",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),ks.jsx("label",{htmlFor:"agent-specialization",className:"ml-2 text-sm text-gray-700",children:"Permitir especialização de agentes por canal"})]})]})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[ks.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Automações"}),ks.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Configure automações específicas para cada canal"}),ks.jsxs("div",{className:"space-y-4",children:[ks.jsxs("div",{className:"flex items-center",children:[ks.jsx("input",{type:"checkbox",id:"welcome-message",checked:!0,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),ks.jsx("label",{htmlFor:"welcome-message",className:"ml-2 text-sm text-gray-700",children:"Mensagem de boas-vindas automática"})]}),ks.jsxs("div",{className:"flex items-center",children:[ks.jsx("input",{type:"checkbox",id:"away-message",checked:!0,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),ks.jsx("label",{htmlFor:"away-message",className:"ml-2 text-sm text-gray-700",children:"Mensagem de ausência fora do horário comercial"})]}),ks.jsxs("div",{className:"flex items-center",children:[ks.jsx("input",{type:"checkbox",id:"auto-tagging",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),ks.jsx("label",{htmlFor:"auto-tagging",className:"ml-2 text-sm text-gray-700",children:"Tagging automático baseado no canal"})]})]})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[ks.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Limites e Restrições"}),ks.jsxs("div",{className:"space-y-4",children:[ks.jsxs("div",{children:[ks.jsx("label",{htmlFor:"message-limit",className:"block text-sm text-gray-700 mb-1",children:"Limite de mensagens por minuto (Instagram)"}),ks.jsx("input",{type:"number",id:"message-limit",defaultValue:15,min:1,max:60,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),ks.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Recomendado: 15 mensagens/minuto para evitar limitações da API"})]}),ks.jsxs("div",{children:[ks.jsx("label",{htmlFor:"message-limit-fb",className:"block text-sm text-gray-700 mb-1",children:"Limite de mensagens por minuto (Facebook)"}),ks.jsx("input",{type:"number",id:"message-limit-fb",defaultValue:20,min:1,max:60,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),ks.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Recomendado: 20 mensagens/minuto para evitar limitações da API"})]})]})]}),ks.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:ks.jsxs("div",{className:"flex items-start space-x-3",children:[ks.jsx(se,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),ks.jsxs("div",{children:[ks.jsx("h4",{className:"text-sm font-medium text-yellow-800 mb-1",children:"Limitações das APIs"}),ks.jsx("p",{className:"text-sm text-yellow-700",children:"As APIs do Instagram e Facebook têm limitações específicas. Certifique-se de seguir as políticas de uso para evitar bloqueios temporários ou permanentes."}),ks.jsxs("ul",{className:"mt-2 space-y-1 text-sm text-yellow-700 list-disc pl-5",children:[ks.jsx("li",{children:"Responda às mensagens dentro de 24 horas"}),ks.jsx("li",{children:"Evite enviar mensagens em massa"}),ks.jsx("li",{children:"Respeite os limites de taxa da API"}),ks.jsx("li",{children:"Obtenha consentimento antes de enviar mensagens promocionais"})]})]})]})})]})]})]})]})]})},Ea=({platform:e})=>{const{user:s}=Ls(),[a,n]=t.useState([]),[i,l]=t.useState(!1),[c,o]=t.useState(null),[d,m]=t.useState(30),[x,p]=t.useState(!0),[g,y]=t.useState(new Date),[b,N]=t.useState(null),[v,w]=t.useState(!1);t.useEffect(()=>{s?.companyId&&C()},[s?.companyId,e]),t.useEffect(()=>{if(!x)return;const e=setInterval(()=>{C(),y(new Date)},1e3*d);return()=>clearInterval(e)},[x,d]);const C=async()=>{if(s?.companyId)try{l(!0),o(null);const t=[{id:"1",company_id:s.companyId,platform:e,account_id:"instagram"===e?"12345678":"87654321",account_name:"Empresa Demo",account_username:"empresa_demo",status:"connected",profile_picture_url:"https://images.unsplash.com/photo-1560250097-0b93528c311a?w=200&h=200&fit=crop&crop=faces",last_seen:(new Date).toISOString(),created_at:new Date(Date.now()-2592e6).toISOString(),updated_at:(new Date).toISOString(),connection_stats:{uptime:86400,connected_since:new Date(Date.now()-864e5).toISOString(),reconnect_count:2,last_reconnect:new Date(Date.now()-72e5).toISOString()},message_stats:{sent_today:56,received_today:83,sent_total:1456,received_total:2567,delivery_rate:98.5,read_rate:87.2,response_rate:76.4},health_status:{status:"healthy",issues:[],last_check:(new Date).toISOString()}}];n(t),1!==t.length||b||N(t[0].id),l(!1)}catch(Ha){o(`Failed to load ${e} sessions. Please try again later.`),l(!1)}},k=e=>{const s=Math.floor(e/86400),t=Math.floor(e%86400/3600),a=Math.floor(e%3600/60);return s>0?`${s}d ${t}h ${a}m`:t>0?`${t}h ${a}m`:`${a}m`},_=e=>new Date(e).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),S=e=>{switch(e){case"connected":return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[ks.jsx(j,{className:"h-3 w-3 mr-1"}),"Conectado"]});case"disconnected":return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[ks.jsx(me,{className:"h-3 w-3 mr-1"}),"Desconectado"]});default:return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[ks.jsx(P,{className:"h-3 w-3 mr-1"}),"Erro"]})}},T=e=>{switch(e){case"healthy":return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[ks.jsx(j,{className:"h-3 w-3 mr-1"}),"Saudável"]});case"warning":return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[ks.jsx(P,{className:"h-3 w-3 mr-1"}),"Atenção"]});case"critical":return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[ks.jsx(P,{className:"h-3 w-3 mr-1"}),"Crítico"]});default:return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[ks.jsx(h,{className:"h-3 w-3 mr-1"}),"Desconhecido"]})}},A=e=>{if(!e.message_stats)return null;const s=e.message_stats,t=(s.sent_today>0?Math.round(s.sent_today/s.sent_total*100):0)>20,a=(s.received_today>0?Math.round(s.received_today/s.received_total*100):0)>20;return ks.jsxs("div",{className:"flex items-center space-x-4",children:[ks.jsxs("div",{className:"flex items-center",children:[ks.jsx(ne,{className:"h-4 w-4 text-blue-500 mr-1"}),ks.jsx("span",{className:"text-sm text-gray-700",children:s.sent_today}),t?ks.jsx(xe,{className:"h-3 w-3 text-green-500 ml-1"}):ks.jsx(he,{className:"h-3 w-3 text-red-500 ml-1"})]}),ks.jsxs("div",{className:"flex items-center",children:[ks.jsx(f,{className:"h-4 w-4 text-purple-500 mr-1"}),ks.jsx("span",{className:"text-sm text-gray-700",children:s.received_today}),a?ks.jsx(xe,{className:"h-3 w-3 text-green-500 ml-1"}):ks.jsx(he,{className:"h-3 w-3 text-red-500 ml-1"})]})]})},E=()=>"instagram"===e?ks.jsx(Ke,{className:"h-6 w-6 text-pink-600"}):ks.jsx(Je,{className:"h-6 w-6 text-blue-600"}),L=()=>"instagram"===e?"Instagram Direct":"Facebook Messenger",I=b?a.find(e=>e.id===b):null;return ks.jsxs("div",{className:"space-y-6",children:[ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[E(),ks.jsxs("div",{children:[ks.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Monitoramento de ",L()]}),ks.jsxs("p",{className:"text-sm text-gray-600",children:[a.length," ",1===a.length?"conta":"contas"," conectada(s)"]})]})]}),ks.jsxs("div",{className:"flex items-center space-x-4",children:[ks.jsxs(r,{to:`/client/${e}`,className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900",children:[ks.jsx(ae,{className:"h-4 w-4"}),ks.jsx("span",{children:"Voltar para Conexão"})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("span",{className:"text-sm text-gray-500",children:"Auto-refresh:"}),ks.jsxs("select",{value:d,onChange:e=>m(Number(e.target.value)),className:"text-sm border border-gray-300 rounded-md p-1",disabled:!x,children:[ks.jsx("option",{value:"10",children:"10s"}),ks.jsx("option",{value:"30",children:"30s"}),ks.jsx("option",{value:"60",children:"1m"}),ks.jsx("option",{value:"300",children:"5m"})]}),ks.jsxs("label",{className:"inline-flex items-center cursor-pointer",children:[ks.jsx("input",{type:"checkbox",checked:x,onChange:()=>p(!x),className:"sr-only peer"}),ks.jsx("div",{className:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),ks.jsx("button",{onClick:()=>{C(),y(new Date)},disabled:i,className:"p-2 text-gray-600 hover:text-gray-900 bg-white border border-gray-300 rounded-md hover:bg-gray-50",title:"Atualizar",children:i?ks.jsx(u,{className:"h-5 w-5 animate-spin"}):ks.jsx(Z,{className:"h-5 w-5"})})]})]}),c&&ks.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:c}),ks.jsxs("div",{className:"text-xs text-gray-500 text-right",children:["Última atualização: ",g.toLocaleTimeString()]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Visão Geral das Contas"}),i&&0===a.length?ks.jsx("div",{className:"flex items-center justify-center py-12",children:ks.jsx(u,{className:"h-8 w-8 text-gray-400 animate-spin"})}):0===a.length?ks.jsxs("div",{className:"text-center py-12",children:[E(),ks.jsx("h3",{className:"text-lg font-medium text-gray-900 mt-4 mb-2",children:"Nenhuma conta conectada"}),ks.jsxs("p",{className:"text-gray-500",children:["Conecte sua conta de ",L()," para começar a monitorar"]}),ks.jsxs(r,{to:`/client/${e}`,className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white focus:outline-none focus:ring-2 focus:ring-offset-2",style:{backgroundColor:"instagram"===e?"#E1306C":"#1877F2"},children:["Conectar ",L()]})]}):ks.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(s=>ks.jsxs("div",{className:"bg-white rounded-lg border-2 p-4 cursor-pointer transition-all hover:shadow-md "+(b===s.id?"border-blue-500 shadow-md":"border-gray-200"),onClick:()=>N(s.id),children:[ks.jsxs("div",{className:"flex items-center justify-between mb-3",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:["instagram"===e?ks.jsx(Ke,{className:"h-5 w-5 text-pink-600"}):ks.jsx(Je,{className:"h-5 w-5 text-blue-600"}),ks.jsxs("h4",{className:"text-md font-medium text-gray-900",children:["@",s.account_username]})]}),S(s.status)]}),ks.jsxs("div",{className:"space-y-2",children:[ks.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[ks.jsx(z,{className:"h-4 w-4 text-gray-400"}),ks.jsx("span",{className:"text-gray-700",children:s.account_name})]}),s.connection_stats&&ks.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[ks.jsx(R,{className:"h-4 w-4 text-gray-400"}),ks.jsxs("span",{className:"text-gray-700",children:["Uptime: ",k(s.connection_stats.uptime)]})]}),s.message_stats&&A(s),s.health_status&&ks.jsx("div",{className:"flex items-center space-x-2 text-sm mt-2",children:T(s.health_status.status)})]})]},s.id))})]}),I&&ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[ks.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50 flex justify-between items-center",children:[ks.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Detalhes da Conta: @",I.account_username]}),ks.jsx("button",{onClick:()=>w(!v),className:"text-sm text-blue-600 hover:text-blue-800",children:v?"Mostrar Menos":"Mostrar Mais"})]}),ks.jsxs("div",{className:"p-6",children:[ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[ks.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[ks.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Informações Básicas"}),ks.jsxs("div",{className:"space-y-2",children:[ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),ks.jsx("span",{className:"text-sm font-medium",children:S(I.status)})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Nome:"}),ks.jsx("span",{className:"text-sm font-medium",children:I.account_name})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"ID da Conta:"}),ks.jsx("span",{className:"text-sm font-medium",children:I.account_id})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Conectado em:"}),ks.jsx("span",{className:"text-sm font-medium",children:_(I.created_at)})]})]})]}),I.connection_stats&&ks.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[ks.jsx("h4",{className:"text-sm font-semibold text-blue-700 mb-3",children:"Estatísticas de Conexão"}),ks.jsxs("div",{className:"space-y-2",children:[ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-blue-600",children:"Uptime:"}),ks.jsx("span",{className:"text-sm font-medium",children:k(I.connection_stats.uptime)})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-blue-600",children:"Conectado desde:"}),ks.jsx("span",{className:"text-sm font-medium",children:_(I.connection_stats.connected_since)})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-blue-600",children:"Reconexões:"}),ks.jsx("span",{className:"text-sm font-medium",children:I.connection_stats.reconnect_count})]}),I.connection_stats.last_reconnect&&ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-blue-600",children:"Última reconexão:"}),ks.jsx("span",{className:"text-sm font-medium",children:_(I.connection_stats.last_reconnect)})]})]})]}),I.message_stats&&ks.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[ks.jsx("h4",{className:"text-sm font-semibold text-green-700 mb-3",children:"Estatísticas de Mensagens"}),ks.jsxs("div",{className:"space-y-2",children:[ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-green-600",children:"Enviadas hoje:"}),ks.jsx("span",{className:"text-sm font-medium",children:I.message_stats.sent_today})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-green-600",children:"Recebidas hoje:"}),ks.jsx("span",{className:"text-sm font-medium",children:I.message_stats.received_today})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-green-600",children:"Taxa de entrega:"}),ks.jsxs("span",{className:"text-sm font-medium",children:[I.message_stats.delivery_rate,"%"]})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm text-green-600",children:"Taxa de leitura:"}),ks.jsxs("span",{className:"text-sm font-medium",children:[I.message_stats.read_rate,"%"]})]})]})]})]}),v&&ks.jsxs("div",{className:"mt-6",children:[I.message_stats&&ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[ks.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Estatísticas Detalhadas de Mensagens"}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[ks.jsx("div",{className:"bg-blue-50 rounded-lg p-3",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-xs font-medium text-blue-600",children:"Total Enviadas"}),ks.jsx("p",{className:"text-xl font-bold text-blue-800",children:I.message_stats.sent_total.toLocaleString()})]}),ks.jsx(ne,{className:"h-8 w-8 text-blue-500"})]})}),ks.jsx("div",{className:"bg-purple-50 rounded-lg p-3",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-xs font-medium text-purple-600",children:"Total Recebidas"}),ks.jsx("p",{className:"text-xl font-bold text-purple-800",children:I.message_stats.received_total.toLocaleString()})]}),ks.jsx(f,{className:"h-8 w-8 text-purple-500"})]})}),ks.jsx("div",{className:"bg-green-50 rounded-lg p-3",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-xs font-medium text-green-600",children:"Taxa de Entrega"}),ks.jsxs("p",{className:"text-xl font-bold text-green-800",children:[I.message_stats.delivery_rate,"%"]})]}),ks.jsx(j,{className:"h-8 w-8 text-green-500"})]})}),ks.jsx("div",{className:"bg-orange-50 rounded-lg p-3",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-xs font-medium text-orange-600",children:"Taxa de Resposta"}),ks.jsxs("p",{className:"text-xl font-bold text-orange-800",children:[I.message_stats.response_rate,"%"]})]}),ks.jsx(ie,{className:"h-8 w-8 text-orange-500"})]})})]}),ks.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-4",children:[ks.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[ks.jsx("h5",{className:"text-xs font-medium text-gray-700 mb-2",children:"Qualidade da Conexão"}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(le,{className:"h-5 w-5 text-green-500"}),ks.jsx("div",{className:"flex-1",children:ks.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:ks.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"90%"}})})}),ks.jsx("span",{className:"text-sm font-medium",children:"Excelente"})]})]}),ks.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[ks.jsx("h5",{className:"text-xs font-medium text-gray-700 mb-2",children:"Status da API"}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(ce,{className:"h-5 w-5 text-green-500"}),ks.jsx("span",{className:"text-sm font-medium",children:"Conectado"})]})]}),ks.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[ks.jsx("h5",{className:"text-xs font-medium text-gray-700 mb-2",children:"Saúde da Conexão"}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(oe,{className:"h-5 w-5 text-green-500"}),ks.jsx("span",{className:"text-sm font-medium",children:"Ótima"})]})]})]})]}),I.health_status&&ks.jsxs("div",{className:"mt-6 rounded-lg p-4 "+("healthy"===I.health_status.status?"bg-green-50":"warning"===I.health_status.status?"bg-yellow-50":"bg-red-50"),children:[ks.jsx("h4",{className:"text-sm font-semibold mb-3 "+("healthy"===I.health_status.status?"text-green-700":"warning"===I.health_status.status?"text-yellow-700":"text-red-700"),children:"Status de Saúde"}),ks.jsxs("div",{className:"space-y-2",children:[ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm "+("healthy"===I.health_status.status?"text-green-600":"warning"===I.health_status.status?"text-yellow-600":"text-red-600"),children:"Status:"}),ks.jsx("span",{className:"text-sm font-medium",children:T(I.health_status.status)})]}),ks.jsxs("div",{className:"flex justify-between",children:[ks.jsx("span",{className:"text-sm "+("healthy"===I.health_status.status?"text-green-600":"warning"===I.health_status.status?"text-yellow-600":"text-red-600"),children:"Última verificação:"}),ks.jsx("span",{className:"text-sm font-medium",children:_(I.health_status.last_check)})]}),I.health_status.issues.length>0&&ks.jsxs("div",{className:"mt-2",children:[ks.jsx("span",{className:"text-sm "+("warning"===I.health_status.status?"text-yellow-600":"text-red-600"),children:"Problemas detectados:"}),ks.jsx("ul",{className:"mt-1 space-y-1",children:I.health_status.issues.map((e,s)=>ks.jsxs("li",{className:"text-sm flex items-start",children:[ks.jsx(P,{className:"h-4 w-4 mr-1 mt-0.5 text-red-500"}),ks.jsx("span",{children:e})]},s))})]})]})]}),ks.jsxs("div",{className:"mt-6 flex flex-wrap gap-4",children:[ks.jsxs("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center space-x-2",children:[ks.jsx(Z,{className:"h-4 w-4"}),ks.jsx("span",{children:"Reconectar"})]}),ks.jsxs("button",{className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 flex items-center space-x-2",children:[ks.jsx(de,{className:"h-4 w-4"}),ks.jsx("span",{children:"Backup da Conexão"})]}),ks.jsxs("button",{className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 flex items-center space-x-2",children:[ks.jsx(M,{className:"h-4 w-4"}),ks.jsx("span",{children:"Diagnóstico Completo"})]}),ks.jsxs("button",{className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 flex items-center space-x-2",children:[ks.jsx(me,{className:"h-4 w-4"}),ks.jsx("span",{children:"Desconectar"})]})]})]})]})]}),ks.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:ks.jsxs("div",{className:"flex items-start space-x-3",children:[ks.jsx(F,{className:"h-6 w-6 text-blue-600 mt-0.5"}),ks.jsxs("div",{children:[ks.jsxs("h3",{className:"text-md font-semibold text-blue-900 mb-2",children:["Dicas para Otimizar sua Integração com ",L()]}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-800",children:[ks.jsxs("div",{className:"flex items-start space-x-2",children:[ks.jsx(j,{className:"h-4 w-4 text-green-600 mt-0.5"}),ks.jsx("span",{children:"Responda às mensagens dentro de 24 horas para manter a janela de mensagens ativa"})]}),ks.jsxs("div",{className:"flex items-start space-x-2",children:[ks.jsx(j,{className:"h-4 w-4 text-green-600 mt-0.5"}),ks.jsx("span",{children:"Use mensagens de template para iniciar novas conversas"})]}),ks.jsxs("div",{className:"flex items-start space-x-2",children:[ks.jsx(j,{className:"h-4 w-4 text-green-600 mt-0.5"}),ks.jsx("span",{children:"Mantenha seu token de acesso atualizado"})]}),ks.jsxs("div",{className:"flex items-start space-x-2",children:[ks.jsx(j,{className:"h-4 w-4 text-green-600 mt-0.5"}),ks.jsx("span",{children:"Siga as políticas da plataforma para evitar bloqueios"})]})]})]})]})})]})},Ra=()=>{const{user:e}=Ls(),[s,a]=t.useState([]),[r,n]=t.useState(null),[i,l]=t.useState(!1),[c,o]=t.useState(null),[d,m]=t.useState({start:new Date(Date.now()-6048e5).toISOString().split("T")[0],end:(new Date).toISOString().split("T")[0]}),[x,h]=t.useState(""),[p,g]=t.useState("all");t.useEffect(()=>{e?.companyId&&(y(),b())},[e?.companyId]);const y=async()=>{try{l(!0),o(null);const s=[{id:"1",company_id:e?.companyId||"",session_name:"WhatsApp Principal",status:"connected",phone_number:"+5511999991234",last_seen:(new Date).toISOString(),created_at:new Date(Date.now()-2592e6).toISOString(),updated_at:(new Date).toISOString()}];a(s),l(!1)}catch(Ha){o("Não foi possível carregar as sessões do WhatsApp"),l(!1)}},b=async()=>{try{l(!0);n({totalMessages:1245,sentMessages:578,receivedMessages:667,mediaMessages:123,activeHours:[{hour:8,count:45},{hour:9,count:78},{hour:10,count:95},{hour:11,count:112},{hour:12,count:85},{hour:13,count:68},{hour:14,count:125},{hour:15,count:145},{hour:16,count:138},{hour:17,count:95},{hour:18,count:72}],dailyActivity:[{date:"2024-06-01",count:145},{date:"2024-06-02",count:132},{date:"2024-06-03",count:98},{date:"2024-06-04",count:115},{date:"2024-06-05",count:87},{date:"2024-06-06",count:134},{date:"2024-06-07",count:125}],responseTime:125}),l(!1)}catch(Ha){l(!1)}},N=e=>{const{name:s,value:t}=e.target;m(e=>({...e,[s]:t}))},v=e=>{switch(e){case"connected":return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[ks.jsx(j,{className:"h-3 w-3 mr-1"}),"Conectado"]});case"connecting":return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[ks.jsx(Z,{className:"h-3 w-3 mr-1 animate-spin"}),"Conectando"]});case"disconnected":return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[ks.jsx(me,{className:"h-3 w-3 mr-1"}),"Desconectado"]});default:return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[ks.jsx(me,{className:"h-3 w-3 mr-1"}),"Erro"]})}},w=s.filter(e=>{const s=e.phone_number?.includes(x)||e.session_name.toLowerCase().includes(x.toLowerCase()),t="all"===p||e.status===p;return s&&t});return ks.jsxs("div",{className:"space-y-6",children:[ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx(ee,{className:"h-6 w-6 text-gray-600"}),ks.jsxs("div",{children:[ks.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Relatório de WhatsApp"}),ks.jsx("p",{className:"text-sm text-gray-600",children:"Estatísticas e histórico de conexões"})]})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("button",{onClick:()=>{y(),b()},className:"p-2 text-gray-600 hover:text-gray-900 rounded-md hover:bg-gray-100",title:"Atualizar",children:ks.jsx(Z,{className:"h-5 w-5"})}),ks.jsx("button",{onClick:()=>{window.print()},className:"p-2 text-gray-600 hover:text-gray-900 rounded-md hover:bg-gray-100",title:"Imprimir",children:ks.jsx(Ye,{className:"h-5 w-5"})}),ks.jsx("button",{onClick:()=>{alert("Exportação para CSV será implementada em breve")},className:"p-2 text-gray-600 hover:text-gray-900 rounded-md hover:bg-gray-100",title:"Exportar",children:ks.jsx(de,{className:"h-5 w-5"})})]})]}),c&&ks.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:c}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(G,{className:"h-5 w-5 text-gray-400"}),ks.jsx("input",{type:"date",name:"start",value:d.start,onChange:N,className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),ks.jsx("span",{className:"text-gray-500",children:"até"}),ks.jsx("input",{type:"date",name:"end",value:d.end,onChange:N,className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),ks.jsxs("div",{className:"flex-1 relative",children:[ks.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),ks.jsx("input",{type:"text",placeholder:"Buscar por número ou nome da sessão...",value:x,onChange:e=>h(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),ks.jsxs("div",{className:"relative",children:[ks.jsx(Xe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),ks.jsxs("select",{value:p,onChange:e=>g(e.target.value),className:"pl-10 pr-8 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"all",children:"Todos os Status"}),ks.jsx("option",{value:"connected",children:"Conectado"}),ks.jsx("option",{value:"connecting",children:"Conectando"}),ks.jsx("option",{value:"disconnected",children:"Desconectado"}),ks.jsx("option",{value:"error",children:"Erro"})]})]})]})}),r&&ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total de Mensagens"}),ks.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.totalMessages})]}),ks.jsx(f,{className:"h-8 w-8 text-blue-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Mensagens Enviadas"}),ks.jsx("p",{className:"text-2xl font-bold text-green-600",children:r.sentMessages})]}),ks.jsx(f,{className:"h-8 w-8 text-green-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Mensagens Recebidas"}),ks.jsx("p",{className:"text-2xl font-bold text-purple-600",children:r.receivedMessages})]}),ks.jsx(f,{className:"h-8 w-8 text-purple-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tempo Médio Resposta"}),ks.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:[Math.floor(r.responseTime/60),"m ",r.responseTime%60,"s"]})]}),ks.jsx(R,{className:"h-8 w-8 text-orange-600"})]})})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[ks.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Sessões de WhatsApp"}),ks.jsxs("div",{className:"text-sm text-gray-500",children:[w.length," ",1===w.length?"sessão":"sessões"," encontradas"]})]})}),i?ks.jsx("div",{className:"flex items-center justify-center py-12",children:ks.jsx(u,{className:"h-8 w-8 text-gray-400 animate-spin"})}):ks.jsx("div",{className:"overflow-x-auto",children:ks.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[ks.jsx("thead",{className:"bg-gray-50",children:ks.jsxs("tr",{children:[ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:ks.jsxs("div",{className:"flex items-center space-x-1 cursor-pointer",children:[ks.jsx("span",{children:"Nome da Sessão"}),ks.jsx(Ze,{className:"h-3 w-3"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:ks.jsxs("div",{className:"flex items-center space-x-1 cursor-pointer",children:[ks.jsx("span",{children:"Número"}),ks.jsx(Ze,{className:"h-3 w-3"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:ks.jsxs("div",{className:"flex items-center space-x-1 cursor-pointer",children:[ks.jsx("span",{children:"Criado em"}),ks.jsx(Ze,{className:"h-3 w-3"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:ks.jsxs("div",{className:"flex items-center space-x-1 cursor-pointer",children:[ks.jsx("span",{children:"Última Atividade"}),ks.jsx(Ze,{className:"h-3 w-3"})]})})]})}),ks.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:w.map(e=>ks.jsxs("tr",{className:"hover:bg-gray-50",children:[ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.session_name})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:v(e.status)}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("div",{className:"text-sm text-gray-900",children:e.phone_number||"Não conectado"})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("div",{className:"text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString()})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("div",{className:"text-sm text-gray-500",children:e.last_seen?new Date(e.last_seen).toLocaleString():"N/A"})})]},e.id))})]})}),!i&&0===w.length&&ks.jsxs("div",{className:"text-center py-12",children:[ks.jsx(ee,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),ks.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma sessão encontrada"}),ks.jsx("p",{className:"text-gray-500",children:x||"all"!==p?"Tente ajustar os filtros de busca":"Conecte seu WhatsApp para começar"})]})]}),r&&ks.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Atividade por Hora"}),ks.jsx("div",{className:"h-64",children:ks.jsx("div",{className:"h-full flex items-end space-x-2",children:r.activeHours.map(e=>ks.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[ks.jsx("div",{className:"w-full bg-blue-500 rounded-t",style:{height:e.count/Math.max(...r.activeHours.map(e=>e.count))*100+"%",minHeight:"4px"}}),ks.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[e.hour,"h"]})]},e.hour))})})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Atividade Diária"}),ks.jsx("div",{className:"h-64",children:ks.jsx("div",{className:"h-full flex items-end space-x-2",children:r.dailyActivity.map(e=>ks.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[ks.jsx("div",{className:"w-full bg-green-500 rounded-t",style:{height:e.count/Math.max(...r.dailyActivity.map(e=>e.count))*100+"%",minHeight:"4px"}}),ks.jsx("div",{className:"text-xs text-gray-500 mt-1",children:new Date(e.date).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})})]},e.date))})})]})]})]})},La=()=>{const{user:e}=Ls(),[s,a]=t.useState([]),[r,n]=t.useState(null),[i,l]=t.useState(!1),[c,o]=t.useState(null),[d,m]=t.useState({start:new Date(Date.now()-2592e6).toISOString().split("T")[0],end:(new Date).toISOString().split("T")[0]}),[x,h]=t.useState(""),[p,g]=t.useState("all"),[y,b]=t.useState("all"),[N,v]=t.useState("all"),[w,C]=t.useState("updated_at"),[k,_]=t.useState("desc");t.useEffect(()=>{e?.companyId&&S()},[e?.companyId,d,p,y,N]);const S=async()=>{try{l(!0),o(null);const e=Array.from({length:50},(e,s)=>{const t=["active","waiting","closed","transferred"][Math.floor(4*Math.random())],a=["low","medium","high","urgent"][Math.floor(4*Math.random())],r=["whatsapp","telegram","webchat","instagram"][Math.floor(4*Math.random())],n=["Carlos Lima","Maria Santos","João Silva",null],i=n[Math.floor(Math.random()*n.length)],l=new Date(Date.now()-30*Math.random()*24*60*60*1e3).toISOString(),c=new Date(new Date(l).getTime()+5*Math.random()*24*60*60*1e3).toISOString(),o=[];return Math.random()>.5&&o.push("suporte"),Math.random()>.7&&o.push("vip"),Math.random()>.8&&o.push("urgente"),{id:`conv-${s+1}`,customer_name:`Cliente ${s+1}`,customer_phone:`+55119${Math.floor(1e7+9e7*Math.random())}`,status:t,assigned_agent_name:i,priority:a,tags:o,source:r,created_at:l,updated_at:c,last_message:`Última mensagem da conversa ${s+1}`,last_message_time:c,unread_count:"active"===t||"waiting"===t?Math.floor(5*Math.random()):0,message_count:Math.floor(5+50*Math.random()),resolution_time:"closed"===t?Math.floor(1800+7200*Math.random()):void 0}}),s={total:e.length,active:e.filter(e=>"active"===e.status).length,waiting:e.filter(e=>"waiting"===e.status).length,closed:e.filter(e=>"closed"===e.status).length,avgResolutionTime:Math.floor(e.filter(e=>e.resolution_time).reduce((e,s)=>e+(s.resolution_time||0),0)/e.filter(e=>e.resolution_time).length||0),bySource:{},byPriority:{},byTag:{},byAgent:{}};e.forEach(e=>{if(s.bySource[e.source]||(s.bySource[e.source]=0),s.bySource[e.source]++,s.byPriority[e.priority]||(s.byPriority[e.priority]=0),s.byPriority[e.priority]++,e.tags.forEach(e=>{s.byTag[e]||(s.byTag[e]=0),s.byTag[e]++}),e.assigned_agent_name&&(s.byAgent[e.assigned_agent_name]||(s.byAgent[e.assigned_agent_name]={count:0,avgResolutionTime:0}),s.byAgent[e.assigned_agent_name].count++,e.resolution_time)){const t=s.byAgent[e.assigned_agent_name],a=t.avgResolutionTime*(t.count-1)+e.resolution_time;t.avgResolutionTime=Math.floor(a/t.count)}}),a(e),n(s),l(!1)}catch(Ha){o("Não foi possível carregar o relatório de conversas"),l(!1)}},T=e=>{const{name:s,value:t}=e.target;m(e=>({...e,[s]:t}))},A=e=>{w===e?_("asc"===k?"desc":"asc"):(C(e),_("asc"))},E=e=>{switch(e){case"active":return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[ks.jsx(j,{className:"h-3 w-3 mr-1"}),"Ativo"]});case"waiting":return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[ks.jsx(R,{className:"h-3 w-3 mr-1"}),"Aguardando"]});case"closed":return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[ks.jsx(me,{className:"h-3 w-3 mr-1"}),"Fechado"]});case"transferred":return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[ks.jsx(Z,{className:"h-3 w-3 mr-1"}),"Transferido"]});default:return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:[ks.jsx(f,{className:"h-3 w-3 mr-1"}),"Bot"]})}},L=e=>{switch(e){case"urgent":return ks.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Urgente"});case"high":return ks.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:"Alta"});case"medium":return ks.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Média"});case"low":return ks.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Baixa"});default:return null}},I=e=>{switch(e){case"whatsapp":return ks.jsx(ee,{className:"h-4 w-4 text-green-600"});case"telegram":return ks.jsx(f,{className:"h-4 w-4 text-blue-600"});case"webchat":return ks.jsx(f,{className:"h-4 w-4 text-purple-600"});case"instagram":return ks.jsx(f,{className:"h-4 w-4 text-pink-600"});default:return ks.jsx(f,{className:"h-4 w-4 text-gray-600"})}},M=e=>{if(!e)return"N/A";const s=Math.floor(e/3600),t=Math.floor(e%3600/60),a=e%60;return s>0?`${s}h ${t}m ${a}s`:t>0?`${t}m ${a}s`:`${a}s`},P=s.filter(e=>{const s=e.customer_name.toLowerCase().includes(x.toLowerCase())||e.customer_phone.includes(x)||e.assigned_agent_name?.toLowerCase().includes(x.toLowerCase())||!1||e.last_message.toLowerCase().includes(x.toLowerCase())||e.tags.some(e=>e.toLowerCase().includes(x.toLowerCase())),t="all"===p||e.status===p,a="all"===y||e.source===y,r="all"===N||e.priority===N;return s&&t&&a&&r}).sort((e,s)=>{let t=0;switch(w){case"customer_name":t=e.customer_name.localeCompare(s.customer_name);break;case"created_at":t=new Date(e.created_at).getTime()-new Date(s.created_at).getTime();break;case"updated_at":t=new Date(e.updated_at).getTime()-new Date(s.updated_at).getTime();break;case"message_count":t=(e.message_count||0)-(s.message_count||0);break;case"resolution_time":t=(e.resolution_time||0)-(s.resolution_time||0);break;default:t=new Date(s.updated_at).getTime()-new Date(e.updated_at).getTime()}return"asc"===k?t:-t});return ks.jsxs("div",{className:"space-y-6",children:[ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx(te,{className:"h-6 w-6 text-gray-600"}),ks.jsxs("div",{children:[ks.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Relatório de Conversas"}),ks.jsx("p",{className:"text-sm text-gray-600",children:"Análise e estatísticas de atendimentos"})]})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("button",{onClick:()=>{S()},className:"p-2 text-gray-600 hover:text-gray-900 rounded-md hover:bg-gray-100",title:"Atualizar",children:ks.jsx(Z,{className:"h-5 w-5"})}),ks.jsx("button",{onClick:()=>{window.print()},className:"p-2 text-gray-600 hover:text-gray-900 rounded-md hover:bg-gray-100",title:"Imprimir",children:ks.jsx(Ye,{className:"h-5 w-5"})}),ks.jsx("button",{onClick:()=>{alert("Exportação para CSV será implementada em breve")},className:"p-2 text-gray-600 hover:text-gray-900 rounded-md hover:bg-gray-100",title:"Exportar",children:ks.jsx(de,{className:"h-5 w-5"})})]})]}),c&&ks.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:c}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(G,{className:"h-5 w-5 text-gray-400"}),ks.jsx("input",{type:"date",name:"start",value:d.start,onChange:T,className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),ks.jsx("span",{className:"text-gray-500",children:"até"}),ks.jsx("input",{type:"date",name:"end",value:d.end,onChange:T,className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),ks.jsxs("div",{className:"flex-1 relative",children:[ks.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),ks.jsx("input",{type:"text",placeholder:"Buscar por cliente, agente, mensagem ou tag...",value:x,onChange:e=>h(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),ks.jsxs("select",{value:p,onChange:e=>g(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"all",children:"Todos os Status"}),ks.jsx("option",{value:"active",children:"Ativo"}),ks.jsx("option",{value:"waiting",children:"Aguardando"}),ks.jsx("option",{value:"closed",children:"Fechado"}),ks.jsx("option",{value:"transferred",children:"Transferido"}),ks.jsx("option",{value:"bot",children:"Bot"})]}),ks.jsxs("select",{value:y,onChange:e=>b(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"all",children:"Todas as Fontes"}),ks.jsx("option",{value:"whatsapp",children:"WhatsApp"}),ks.jsx("option",{value:"telegram",children:"Telegram"}),ks.jsx("option",{value:"webchat",children:"Web Chat"}),ks.jsx("option",{value:"instagram",children:"Instagram"})]}),ks.jsxs("select",{value:N,onChange:e=>v(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"all",children:"Todas as Prioridades"}),ks.jsx("option",{value:"urgent",children:"Urgente"}),ks.jsx("option",{value:"high",children:"Alta"}),ks.jsx("option",{value:"medium",children:"Média"}),ks.jsx("option",{value:"low",children:"Baixa"})]})]})}),r&&ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total de Conversas"}),ks.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.total})]}),ks.jsx(f,{className:"h-8 w-8 text-blue-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Conversas Ativas"}),ks.jsx("p",{className:"text-2xl font-bold text-green-600",children:r.active})]}),ks.jsx(j,{className:"h-8 w-8 text-green-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Aguardando"}),ks.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:r.waiting})]}),ks.jsx(R,{className:"h-8 w-8 text-yellow-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tempo Médio Resolução"}),ks.jsx("p",{className:"text-2xl font-bold text-purple-600",children:M(r.avgResolutionTime)})]}),ks.jsx(R,{className:"h-8 w-8 text-purple-600"})]})})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[ks.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Conversas"}),ks.jsxs("div",{className:"text-sm text-gray-500",children:[P.length," ",1===P.length?"conversa":"conversas"," encontradas"]})]})}),i?ks.jsx("div",{className:"flex items-center justify-center py-12",children:ks.jsx(u,{className:"h-8 w-8 text-gray-400 animate-spin"})}):ks.jsx("div",{className:"overflow-x-auto",children:ks.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[ks.jsx("thead",{className:"bg-gray-50",children:ks.jsxs("tr",{children:[ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>A("customer_name"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Cliente"}),"customer_name"===w&&ks.jsx(Ze,{className:"h-3 w-3"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Agente"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fonte"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Prioridade"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>A("created_at"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Criada em"}),"created_at"===w&&ks.jsx(Ze,{className:"h-3 w-3"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>A("updated_at"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Última Atividade"}),"updated_at"===w&&ks.jsx(Ze,{className:"h-3 w-3"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>A("message_count"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Mensagens"}),"message_count"===w&&ks.jsx(Ze,{className:"h-3 w-3"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>A("resolution_time"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Tempo Resolução"}),"resolution_time"===w&&ks.jsx(Ze,{className:"h-3 w-3"})]})})]})}),ks.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:P.map(e=>ks.jsxs("tr",{className:"hover:bg-gray-50",children:[ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("div",{className:"flex items-center",children:[ks.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center",children:ks.jsx(Ne,{className:"h-5 w-5 text-gray-500"})}),ks.jsxs("div",{className:"ml-4",children:[ks.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.customer_name}),ks.jsx("div",{className:"text-sm text-gray-500",children:e.customer_phone})]})]})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:E(e.status)}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("div",{className:"text-sm text-gray-900",children:e.assigned_agent_name||"Não atribuído"})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("div",{className:"flex items-center",children:[I(e.source),ks.jsx("span",{className:"ml-1.5 text-sm text-gray-900",children:e.source.charAt(0).toUpperCase()+e.source.slice(1)})]})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:L(e.priority)}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("div",{className:"text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString()})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("div",{className:"text-sm text-gray-500",children:new Date(e.updated_at).toLocaleString()})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("div",{className:"text-sm text-gray-900",children:e.message_count||"N/A"})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("div",{className:"text-sm text-gray-900",children:M(e.resolution_time)})})]},e.id))})]})}),!i&&0===P.length&&ks.jsxs("div",{className:"text-center py-12",children:[ks.jsx(f,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),ks.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma conversa encontrada"}),ks.jsx("p",{className:"text-gray-500",children:x||"all"!==p||"all"!==y||"all"!==N?"Tente ajustar os filtros de busca":"Não há conversas no período selecionado"})]})]}),r&&ks.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Distribuição por Fonte"}),ks.jsx("div",{className:"space-y-4",children:Object.entries(r.bySource).map(([e,s])=>ks.jsxs("div",{children:[ks.jsxs("div",{className:"flex justify-between items-center mb-1",children:[ks.jsxs("div",{className:"flex items-center",children:[I(e),ks.jsx("span",{className:"ml-2 text-sm font-medium text-gray-700",children:e.charAt(0).toUpperCase()+e.slice(1)})]}),ks.jsxs("span",{className:"text-sm text-gray-500",children:[s," (",Math.round(s/r.total*100),"%)"]})]}),ks.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:ks.jsx("div",{className:"h-2 rounded-full "+("whatsapp"===e?"bg-green-500":"telegram"===e?"bg-blue-500":"webchat"===e?"bg-purple-500":"bg-pink-500"),style:{width:s/r.total*100+"%"}})})]},e))})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Distribuição por Prioridade"}),ks.jsx("div",{className:"space-y-4",children:Object.entries(r.byPriority).map(([e,s])=>ks.jsxs("div",{children:[ks.jsxs("div",{className:"flex justify-between items-center mb-1",children:[ks.jsx("span",{className:"text-sm font-medium text-gray-700",children:"urgent"===e?"Urgente":"high"===e?"Alta":"medium"===e?"Média":"Baixa"}),ks.jsxs("span",{className:"text-sm text-gray-500",children:[s," (",Math.round(s/r.total*100),"%)"]})]}),ks.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:ks.jsx("div",{className:"h-2 rounded-full "+("urgent"===e?"bg-red-500":"high"===e?"bg-orange-500":"medium"===e?"bg-yellow-500":"bg-green-500"),style:{width:s/r.total*100+"%"}})})]},e))})]})]}),r&&Object.keys(r.byAgent).length>0&&ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Desempenho por Agente"}),ks.jsx("div",{className:"overflow-x-auto",children:ks.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[ks.jsx("thead",{className:"bg-gray-50",children:ks.jsxs("tr",{children:[ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Agente"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Conversas Atendidas"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tempo Médio de Resolução"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"% do Total"})]})}),ks.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Object.entries(r.byAgent).map(([e,s])=>ks.jsxs("tr",{className:"hover:bg-gray-50",children:[ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("div",{className:"text-sm font-medium text-gray-900",children:e})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("div",{className:"text-sm text-gray-900",children:s.count})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("div",{className:"text-sm text-gray-900",children:M(s.avgResolutionTime)})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("div",{className:"text-sm text-gray-900",children:[Math.round(s.count/r.total*100),"%"]})})]},e))})]})})]}),r&&Object.keys(r.byTag).length>0&&ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Tags Mais Utilizadas"}),ks.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(r.byTag).sort((e,s)=>s[1]-e[1]).slice(0,9).map(([e,s])=>ks.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[ks.jsxs("div",{className:"flex items-center",children:[ks.jsx(fe,{className:"h-4 w-4 text-blue-600 mr-2"}),ks.jsx("span",{className:"text-sm font-medium text-gray-900",children:e})]}),ks.jsxs("span",{className:"text-sm text-gray-500",children:[s," conversas"]})]},e))})]})]})},Ia=()=>{const{user:e}=Ls(),[s,a]=t.useState([]),[r,n]=t.useState(null),[i,l]=t.useState(!1),[c,o]=t.useState(null),[d,x]=t.useState({start:new Date(Date.now()-2592e6).toISOString().split("T")[0],end:(new Date).toISOString().split("T")[0]}),[h,p]=t.useState(""),[g,y]=t.useState("all"),[b,N]=t.useState("all"),[v,w]=t.useState("all"),[C,k]=t.useState("name"),[_,S]=t.useState("asc");t.useEffect(()=>{e?.companyId&&T()},[e?.companyId]);const T=async()=>{try{l(!0),o(null);const e=["Atendimento","Vendas","Suporte","Financeiro","Marketing"],s=Array.from({length:20},(s,t)=>{const a=0===t?"admin":t<3?"supervisor":"agent",r=Math.random()>.1?"active":"inactive";return{id:`user-${t+1}`,name:`Usuário ${t+1}`,email:`usuario${t+1}@empresa.com`,role:a,status:r,department:e[Math.floor(Math.random()*e.length)],created_at:new Date(Date.now()-365*Math.random()*24*60*60*1e3).toISOString(),last_login:"active"===r?new Date(Date.now()-7*Math.random()*24*60*60*1e3).toISOString():new Date(Date.now()-90*Math.random()*24*60*60*1e3).toISOString(),stats:"agent"===a&&"active"===r?{conversationsToday:Math.floor(20*Math.random()),conversationsTotal:Math.floor(100+900*Math.random()),avgResponseTime:Math.floor(30+120*Math.random()),avgResolutionTime:Math.floor(300+1800*Math.random()),satisfaction:3+2*Math.random(),messagesCount:Math.floor(500+5e3*Math.random())}:void 0}}),t={total:s.length,active:s.filter(e=>"active"===e.status).length,inactive:s.filter(e=>"inactive"===e.status).length,byRole:{},byDepartment:{},topPerformers:{byConversations:[],byResponseTime:[],bySatisfaction:[]}};s.forEach(e=>{t.byRole[e.role]||(t.byRole[e.role]=0),t.byRole[e.role]++,e.department&&(t.byDepartment[e.department]||(t.byDepartment[e.department]=0),t.byDepartment[e.department]++)});const r=s.filter(e=>e.stats&&"agent"===e.role&&"active"===e.status);t.topPerformers.byConversations=[...r].sort((e,s)=>(s.stats?.conversationsTotal||0)-(e.stats?.conversationsTotal||0)).slice(0,5),t.topPerformers.byResponseTime=[...r].sort((e,s)=>(e.stats?.avgResponseTime||999)-(s.stats?.avgResponseTime||999)).slice(0,5),t.topPerformers.bySatisfaction=[...r].sort((e,s)=>(s.stats?.satisfaction||0)-(e.stats?.satisfaction||0)).slice(0,5),a(s),n(t),l(!1)}catch(Ha){o("Não foi possível carregar o relatório de usuários"),l(!1)}},A=e=>{const{name:s,value:t}=e.target;x(e=>({...e,[s]:t}))},E=e=>{C===e?S("asc"===_?"desc":"asc"):(k(e),S("asc"))},L=e=>{switch(e){case"admin":return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:[ks.jsx(m,{className:"h-3 w-3 mr-1"}),"Administrador"]});case"supervisor":return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[ks.jsx($,{className:"h-3 w-3 mr-1"}),"Supervisor"]});case"agent":return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[ks.jsx(Ne,{className:"h-3 w-3 mr-1"}),"Agente"]});default:return null}},I=e=>{switch(e){case"active":return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[ks.jsx(j,{className:"h-3 w-3 mr-1"}),"Ativo"]});case"inactive":return ks.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[ks.jsx(me,{className:"h-3 w-3 mr-1"}),"Inativo"]});default:return null}},M=e=>{if(!e)return"N/A";return`${Math.floor(e/60)}m ${e%60}s`},P=s.filter(e=>{const s=e.name.toLowerCase().includes(h.toLowerCase())||e.email.toLowerCase().includes(h.toLowerCase())||e.department?.toLowerCase().includes(h.toLowerCase())||!1,t="all"===g||e.role===g,a="all"===b||e.status===b,r="all"===v||e.department===v;return s&&t&&a&&r}).sort((e,s)=>{let t=0;switch(C){case"name":default:t=e.name.localeCompare(s.name);break;case"email":t=e.email.localeCompare(s.email);break;case"role":t=e.role.localeCompare(s.role);break;case"department":t=(e.department||"").localeCompare(s.department||"");break;case"created_at":t=new Date(e.created_at).getTime()-new Date(s.created_at).getTime();break;case"last_login":t=new Date(e.last_login||0).getTime()-new Date(s.last_login||0).getTime();break;case"conversations":t=(e.stats?.conversationsTotal||0)-(s.stats?.conversationsTotal||0);break;case"response_time":t=(e.stats?.avgResponseTime||999)-(s.stats?.avgResponseTime||999);break;case"satisfaction":t=(e.stats?.satisfaction||0)-(s.stats?.satisfaction||0)}return"asc"===_?t:-t}),D=Array.from(new Set(s.map(e=>e.department).filter(Boolean)));return ks.jsxs("div",{className:"space-y-6",children:[ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx(te,{className:"h-6 w-6 text-gray-600"}),ks.jsxs("div",{children:[ks.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Relatório de Usuários"}),ks.jsx("p",{className:"text-sm text-gray-600",children:"Análise e estatísticas da equipe"})]})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("button",{onClick:()=>{T()},className:"p-2 text-gray-600 hover:text-gray-900 rounded-md hover:bg-gray-100",title:"Atualizar",children:ks.jsx(Z,{className:"h-5 w-5"})}),ks.jsx("button",{onClick:()=>{window.print()},className:"p-2 text-gray-600 hover:text-gray-900 rounded-md hover:bg-gray-100",title:"Imprimir",children:ks.jsx(Ye,{className:"h-5 w-5"})}),ks.jsx("button",{onClick:()=>{alert("Exportação para CSV será implementada em breve")},className:"p-2 text-gray-600 hover:text-gray-900 rounded-md hover:bg-gray-100",title:"Exportar",children:ks.jsx(de,{className:"h-5 w-5"})})]})]}),c&&ks.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:c}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(G,{className:"h-5 w-5 text-gray-400"}),ks.jsx("input",{type:"date",name:"start",value:d.start,onChange:A,className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),ks.jsx("span",{className:"text-gray-500",children:"até"}),ks.jsx("input",{type:"date",name:"end",value:d.end,onChange:A,className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),ks.jsxs("div",{className:"flex-1 relative",children:[ks.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),ks.jsx("input",{type:"text",placeholder:"Buscar por nome, email ou departamento...",value:h,onChange:e=>p(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),ks.jsxs("select",{value:g,onChange:e=>y(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"all",children:"Todos os Cargos"}),ks.jsx("option",{value:"admin",children:"Administrador"}),ks.jsx("option",{value:"supervisor",children:"Supervisor"}),ks.jsx("option",{value:"agent",children:"Agente"})]}),ks.jsxs("select",{value:b,onChange:e=>N(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"all",children:"Todos os Status"}),ks.jsx("option",{value:"active",children:"Ativo"}),ks.jsx("option",{value:"inactive",children:"Inativo"})]}),D.length>0&&ks.jsxs("select",{value:v,onChange:e=>w(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"all",children:"Todos os Departamentos"}),D.map(e=>ks.jsx("option",{value:e,children:e},e))]})]})}),r&&ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total de Usuários"}),ks.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.total})]}),ks.jsx(z,{className:"h-8 w-8 text-blue-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Usuários Ativos"}),ks.jsx("p",{className:"text-2xl font-bold text-green-600",children:r.active})]}),ks.jsx(j,{className:"h-8 w-8 text-green-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Agentes"}),ks.jsx("p",{className:"text-2xl font-bold text-purple-600",children:r.byRole.agent||0})]}),ks.jsx(Ne,{className:"h-8 w-8 text-purple-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Administradores"}),ks.jsx("p",{className:"text-2xl font-bold text-orange-600",children:(r.byRole.admin||0)+(r.byRole.supervisor||0)})]}),ks.jsx(m,{className:"h-8 w-8 text-orange-600"})]})})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[ks.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Usuários"}),ks.jsxs("div",{className:"text-sm text-gray-500",children:[P.length," ",1===P.length?"usuário":"usuários"," encontrados"]})]})}),i?ks.jsx("div",{className:"flex items-center justify-center py-12",children:ks.jsx(u,{className:"h-8 w-8 text-gray-400 animate-spin"})}):ks.jsx("div",{className:"overflow-x-auto",children:ks.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[ks.jsx("thead",{className:"bg-gray-50",children:ks.jsxs("tr",{children:[ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>E("name"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Nome"}),"name"===C&&ks.jsx(Ze,{className:"h-3 w-3"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>E("email"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Email"}),"email"===C&&ks.jsx(Ze,{className:"h-3 w-3"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>E("role"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Cargo"}),"role"===C&&ks.jsx(Ze,{className:"h-3 w-3"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>E("department"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Departamento"}),"department"===C&&ks.jsx(Ze,{className:"h-3 w-3"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>E("created_at"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Criado em"}),"created_at"===C&&ks.jsx(Ze,{className:"h-3 w-3"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>E("last_login"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Último Login"}),"last_login"===C&&ks.jsx(Ze,{className:"h-3 w-3"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>E("conversations"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Conversas"}),"conversations"===C&&ks.jsx(Ze,{className:"h-3 w-3"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>E("response_time"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Tempo Resposta"}),"response_time"===C&&ks.jsx(Ze,{className:"h-3 w-3"})]})})]})}),ks.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:P.map(e=>ks.jsxs("tr",{className:"hover:bg-gray-50",children:[ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("div",{className:"flex items-center",children:[ks.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center",children:e.avatar?ks.jsx("img",{src:e.avatar,alt:e.name,className:"h-10 w-10 rounded-full"}):ks.jsx(Ne,{className:"h-5 w-5 text-gray-500"})}),ks.jsx("div",{className:"ml-4",children:ks.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name})})]})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("div",{className:"text-sm text-gray-900",children:e.email})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:L(e.role)}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:I(e.status)}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("div",{className:"text-sm text-gray-900",children:e.department||"N/A"})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("div",{className:"text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString()})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("div",{className:"text-sm text-gray-500",children:e.last_login?new Date(e.last_login).toLocaleString():"Nunca"})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("div",{className:"text-sm text-gray-900",children:e.stats?.conversationsTotal||"N/A"})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("div",{className:"text-sm text-gray-900",children:e.stats?M(e.stats.avgResponseTime):"N/A"})})]},e.id))})]})}),!i&&0===P.length&&ks.jsxs("div",{className:"text-center py-12",children:[ks.jsx(z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),ks.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum usuário encontrado"}),ks.jsx("p",{className:"text-gray-500",children:h||"all"!==g||"all"!==b||"all"!==v?"Tente ajustar os filtros de busca":"Não há usuários no período selecionado"})]})]}),r&&ks.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Distribuição por Cargo"}),ks.jsx("div",{className:"space-y-4",children:Object.entries(r.byRole).map(([e,s])=>ks.jsxs("div",{children:[ks.jsxs("div",{className:"flex justify-between items-center mb-1",children:[ks.jsx("span",{className:"text-sm font-medium text-gray-700",children:"admin"===e?"Administrador":"supervisor"===e?"Supervisor":"Agente"}),ks.jsxs("span",{className:"text-sm text-gray-500",children:[s," (",Math.round(s/r.total*100),"%)"]})]}),ks.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:ks.jsx("div",{className:"h-2 rounded-full "+("admin"===e?"bg-purple-500":"supervisor"===e?"bg-blue-500":"bg-green-500"),style:{width:s/r.total*100+"%"}})})]},e))})]}),Object.keys(r.byDepartment).length>0&&ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Distribuição por Departamento"}),ks.jsx("div",{className:"space-y-4",children:Object.entries(r.byDepartment).map(([e,s])=>ks.jsxs("div",{children:[ks.jsxs("div",{className:"flex justify-between items-center mb-1",children:[ks.jsx("span",{className:"text-sm font-medium text-gray-700",children:e}),ks.jsxs("span",{className:"text-sm text-gray-500",children:[s," (",Math.round(s/r.total*100),"%)"]})]}),ks.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:ks.jsx("div",{className:"h-2 rounded-full bg-indigo-500",style:{width:s/r.total*100+"%"}})})]},e))})]})]}),r&&r.topPerformers.byConversations.length>0&&ks.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[ks.jsx(f,{className:"h-5 w-5 mr-2 text-blue-500"}),"Top por Conversas"]}),ks.jsx("div",{className:"space-y-4",children:r.topPerformers.byConversations.map((e,s)=>ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center",children:[ks.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold text-white "+(0===s?"bg-yellow-500":1===s?"bg-gray-400":2===s?"bg-orange-500":"bg-blue-500"),children:s+1}),ks.jsx("span",{className:"ml-2 text-sm font-medium text-gray-900",children:e.name})]}),ks.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.stats?.conversationsTotal})]},e.id))})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[ks.jsx(R,{className:"h-5 w-5 mr-2 text-green-500"}),"Top por Tempo de Resposta"]}),ks.jsx("div",{className:"space-y-4",children:r.topPerformers.byResponseTime.map((e,s)=>ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center",children:[ks.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold text-white "+(0===s?"bg-yellow-500":1===s?"bg-gray-400":2===s?"bg-orange-500":"bg-blue-500"),children:s+1}),ks.jsx("span",{className:"ml-2 text-sm font-medium text-gray-900",children:e.name})]}),ks.jsx("span",{className:"text-sm font-medium text-gray-900",children:M(e.stats?.avgResponseTime)})]},e.id))})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[ks.jsx($,{className:"h-5 w-5 mr-2 text-yellow-500"}),"Top por Satisfação"]}),ks.jsx("div",{className:"space-y-4",children:r.topPerformers.bySatisfaction.map((e,s)=>ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center",children:[ks.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold text-white "+(0===s?"bg-yellow-500":1===s?"bg-gray-400":2===s?"bg-orange-500":"bg-blue-500"),children:s+1}),ks.jsx("span",{className:"ml-2 text-sm font-medium text-gray-900",children:e.name})]}),ks.jsxs("div",{className:"flex items-center",children:[ks.jsx("span",{className:"text-sm font-medium text-gray-900 mr-1",children:e.stats?.satisfaction.toFixed(1)}),ks.jsx($,{className:"h-3 w-3 text-yellow-500 fill-current"})]})]},e.id))})]})]})]})},Ma=()=>{const{user:e}=Ls(),[s,a]=t.useState([]),[r,n]=t.useState([]),[i,l]=t.useState(!1),[c,o]=t.useState(null),[d,m]=t.useState(""),[x,h]=t.useState("all"),[p,g]=t.useState("all"),[f,y]=t.useState("last_interaction"),[b,N]=t.useState("desc"),[v,w]=t.useState([]),[C,k]=t.useState(!1);t.useEffect(()=>{e?.companyId&&_()},[e?.companyId]),t.useEffect(()=>{S()},[s,d,x,p,f,b]),t.useEffect(()=>{if(s.length>0){const e=new Set;s.forEach(s=>{s.tags.forEach(s=>e.add(s))}),w(Array.from(e))}},[s]);const _=async()=>{if(e?.companyId)try{l(!0),o(null);const s=await Es.getContacts(e.companyId);s.success&&s.data&&a(s.data)}catch(Ha){o("Não foi possível carregar os contatos. Tente novamente mais tarde.")}finally{l(!1)}},S=()=>{let e=[...s];d&&(e=e.filter(e=>e.name.toLowerCase().includes(d.toLowerCase())||e.phone.includes(d)||e.email&&e.email.toLowerCase().includes(d.toLowerCase()))),"all"!==x&&(e=e.filter(e=>e.status===x)),"all"!==p&&(e=e.filter(e=>e.tags.includes(p))),e.sort((e,s)=>{let t=0;switch(f){case"name":t=e.name.localeCompare(s.name);break;case"created_at":t=new Date(e.created_at).getTime()-new Date(s.created_at).getTime();break;case"last_interaction":t=(e.last_interaction?new Date(e.last_interaction).getTime():0)-(s.last_interaction?new Date(s.last_interaction).getTime():0)}return"asc"===b?t:-t}),n(e)},T=e=>{f===e?N("asc"===b?"desc":"asc"):(y(e),N("asc"))},A=e=>e?new Date(e).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}):"N/A",E=e=>{switch(e){case"active":return"bg-green-100 text-green-800";case"blocked":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},L=e=>{switch(e){case"active":return ks.jsx(j,{className:"h-3 w-3 mr-1"});case"blocked":case"inactive":return ks.jsx(me,{className:"h-3 w-3 mr-1"});default:return null}};return ks.jsxs("div",{className:"space-y-6",children:[ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx(z,{className:"h-6 w-6 text-gray-600"}),ks.jsxs("div",{children:[ks.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Relatório de Contatos"}),ks.jsxs("p",{className:"text-sm text-gray-600",children:[r.length," contatos encontrados"]})]})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsxs("button",{onClick:()=>k(!C),className:"px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 flex items-center space-x-2",children:[ks.jsx(de,{className:"h-4 w-4"}),ks.jsx("span",{children:"Exportar"})]}),ks.jsx("button",{onClick:_,disabled:i,className:"p-2 text-gray-600 hover:text-gray-900 bg-white border border-gray-300 rounded-md hover:bg-gray-50",title:"Atualizar",children:i?ks.jsx(u,{className:"h-4 w-4 animate-spin"}):ks.jsx(Z,{className:"h-4 w-4"})}),C&&ks.jsx("div",{className:"absolute right-0 mt-32 w-48 bg-white rounded-md shadow-lg z-10 border border-gray-200",children:ks.jsxs("div",{className:"py-1",children:[ks.jsxs("button",{onClick:()=>{const e=[["Nome","Telefone","Email","Status","Tags","Última Interação","Criado em"]];r.forEach(s=>{e.push([s.name,s.phone,s.email||"",s.status,s.tags.join("; "),s.last_interaction?A(s.last_interaction):"N/A",A(s.created_at)])});const s=e.map(e=>e.map(e=>`"${e}"`).join(",")).join("\n"),t=new Blob([s],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(t),n=document.createElement("a");n.setAttribute("href",a),n.setAttribute("download",`contatos_${(new Date).toISOString().split("T")[0]}.csv`),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[ks.jsx(es,{className:"h-4 w-4 mr-2"}),"Exportar CSV"]}),ks.jsxs("button",{onClick:()=>{window.print()},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[ks.jsx(Ye,{className:"h-4 w-4 mr-2"}),"Imprimir"]})]})})]})]}),c&&ks.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:c}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:[ks.jsxs("div",{className:"flex-1 relative",children:[ks.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),ks.jsx("input",{type:"text",placeholder:"Buscar por nome, telefone ou email...",value:d,onChange:e=>m(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),ks.jsxs("select",{value:x,onChange:e=>h(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"all",children:"Todos os Status"}),ks.jsx("option",{value:"active",children:"Ativos"}),ks.jsx("option",{value:"blocked",children:"Bloqueados"}),ks.jsx("option",{value:"inactive",children:"Inativos"})]}),ks.jsxs("select",{value:p,onChange:e=>g(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"all",children:"Todas as Tags"}),v.map(e=>ks.jsx("option",{value:e,children:e},e))]})]})}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[i?ks.jsx("div",{className:"flex items-center justify-center py-12",children:ks.jsx(u,{className:"h-8 w-8 text-gray-400 animate-spin"})}):ks.jsx("div",{className:"overflow-x-auto",children:ks.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[ks.jsx("thead",{className:"bg-gray-50",children:ks.jsxs("tr",{children:[ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>T("name"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Nome"}),"name"===f&&ks.jsx(Ze,{className:"h-4 w-4"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contato"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tags"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>T("last_interaction"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Última Interação"}),"last_interaction"===f&&ks.jsx(Ze,{className:"h-4 w-4"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>T("created_at"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Criado em"}),"created_at"===f&&ks.jsx(Ze,{className:"h-4 w-4"})]})})]})}),ks.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(e=>{return ks.jsxs("tr",{className:"hover:bg-gray-50",children:[ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("div",{className:"flex flex-col space-y-1",children:[ks.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[ks.jsx(re,{className:"h-4 w-4 text-gray-400"}),ks.jsx("span",{children:e.phone})]}),e.email&&ks.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[ks.jsx(ss,{className:"h-4 w-4 text-gray-400"}),ks.jsx("span",{children:e.email})]})]})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${E(e.status)}`,children:[L(e.status),"active"===e.status?"Ativo":"blocked"===e.status?"Bloqueado":"Inativo"]})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.tags.map(e=>ks.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs bg-blue-100 text-blue-800",children:[ks.jsx(fe,{className:"h-3 w-3 mr-1"}),e]},e)),0===e.tags.length&&ks.jsx("span",{className:"text-xs text-gray-500",children:"Sem tags"})]})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.last_interaction?ks.jsxs("div",{className:"flex flex-col",children:[ks.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-900",children:[ks.jsx(G,{className:"h-4 w-4 text-gray-400"}),ks.jsx("span",{children:A(e.last_interaction)})]}),ks.jsxs("div",{className:"flex items-center space-x-1 text-xs text-gray-500",children:[ks.jsx(R,{className:"h-3 w-3 text-gray-400"}),ks.jsx("span",{children:(s=e.last_interaction,s?new Date(s).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}):"")})]})]}):ks.jsx("span",{className:"text-sm text-gray-500",children:"Nunca"})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[ks.jsx(G,{className:"h-4 w-4 text-gray-400"}),ks.jsx("span",{children:A(e.created_at)})]})})]},e.id);var s})})]})}),!i&&0===r.length&&ks.jsxs("div",{className:"text-center py-12",children:[ks.jsx(z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),ks.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum contato encontrado"}),ks.jsx("p",{className:"text-gray-500",children:d||"all"!==x||"all"!==p?"Tente ajustar os filtros de busca":"Comece adicionando contatos ao sistema"})]})]}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[ks.jsx("div",{className:"text-2xl font-bold text-gray-900",children:s.length}),ks.jsx("div",{className:"text-sm text-gray-500",children:"Total de Contatos"})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[ks.jsx("div",{className:"text-2xl font-bold text-green-600",children:s.filter(e=>"active"===e.status).length}),ks.jsx("div",{className:"text-sm text-gray-500",children:"Contatos Ativos"})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[ks.jsx("div",{className:"text-2xl font-bold text-red-600",children:s.filter(e=>"blocked"===e.status).length}),ks.jsx("div",{className:"text-sm text-gray-500",children:"Contatos Bloqueados"})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[ks.jsx("div",{className:"text-2xl font-bold text-blue-600",children:v.length}),ks.jsx("div",{className:"text-sm text-gray-500",children:"Tags Utilizadas"})]})]})]})},Pa=()=>{const{user:e}=Ls(),[s,a]=t.useState([]),[r,n]=t.useState([]),[i,l]=t.useState(!1),[c,o]=t.useState(null),[d,m]=t.useState(""),[x,g]=t.useState("all"),[f,y]=t.useState("all"),[b,N]=t.useState("createdAt"),[v,w]=t.useState("desc"),[C,k]=t.useState(!1);t.useEffect(()=>{e?.companyId&&_()},[e?.companyId]),t.useEffect(()=>{S()},[s,d,x,f,b,v]);const _=async()=>{if(e?.companyId)try{l(!0),o(null);const s=await Es.getCampaigns(e.companyId);s.success&&s.data&&a(s.data)}catch(Ha){o("Não foi possível carregar as campanhas. Tente novamente mais tarde.")}finally{l(!1)}},S=()=>{let e=[...s];d&&(e=e.filter(e=>e.name.toLowerCase().includes(d.toLowerCase())||e.description.toLowerCase().includes(d.toLowerCase()))),"all"!==x&&(e=e.filter(e=>e.status===x)),"all"!==f&&(e=e.filter(e=>e.type===f)),e.sort((e,s)=>{let t=0;switch(b){case"name":t=e.name.localeCompare(s.name);break;case"createdAt":t=new Date(e.createdAt).getTime()-new Date(s.createdAt).getTime();break;case"status":t=e.status.localeCompare(s.status)}return"asc"===v?t:-t}),n(e)},T=e=>{b===e?w("asc"===v?"desc":"asc"):(N(e),w("asc"))},A=e=>e?new Date(e).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}):"N/A",E=e=>{switch(e){case"running":return"bg-green-100 text-green-800";case"paused":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-blue-100 text-blue-800";case"scheduled":return"bg-purple-100 text-purple-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},R=e=>{switch(e){case"running":return ks.jsx(De,{className:"h-3 w-3 mr-1"});case"paused":return ks.jsx(Pe,{className:"h-3 w-3 mr-1"});case"completed":return ks.jsx(j,{className:"h-3 w-3 mr-1"});case"scheduled":return ks.jsx(G,{className:"h-3 w-3 mr-1"});case"cancelled":return ks.jsx(me,{className:"h-3 w-3 mr-1"});case"draft":return ks.jsx(h,{className:"h-3 w-3 mr-1"});default:return null}},L=e=>{switch(e){case"promotional":return"bg-orange-100 text-orange-800";case"welcome":return"bg-green-100 text-green-800";case"retargeting":return"bg-blue-100 text-blue-800";case"survey":return"bg-purple-100 text-purple-800";case"product_launch":return"bg-pink-100 text-pink-800";default:return"bg-gray-100 text-gray-800"}},I=(e,s)=>0===s?0:(e/s*100).toFixed(1),M=(e,s)=>0===s?0:(e/s*100).toFixed(1),P=(e,s)=>0===s?0:(e/s*100).toFixed(1),D=r.reduce((e,s)=>({sent:e.sent+s.stats.sent,delivered:e.delivered+s.stats.delivered,read:e.read+s.stats.read,clicked:e.clicked+s.stats.clicked,converted:e.converted+s.stats.converted,revenue:e.revenue+s.stats.revenue}),{sent:0,delivered:0,read:0,clicked:0,converted:0,revenue:0});return ks.jsxs("div",{className:"space-y-6",children:[ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx(ne,{className:"h-6 w-6 text-gray-600"}),ks.jsxs("div",{children:[ks.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Relatório de Campanhas"}),ks.jsxs("p",{className:"text-sm text-gray-600",children:[r.length," campanhas encontradas"]})]})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsxs("button",{onClick:()=>k(!C),className:"px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 flex items-center space-x-2",children:[ks.jsx(de,{className:"h-4 w-4"}),ks.jsx("span",{children:"Exportar"})]}),ks.jsx("button",{onClick:_,disabled:i,className:"p-2 text-gray-600 hover:text-gray-900 bg-white border border-gray-300 rounded-md hover:bg-gray-50",title:"Atualizar",children:i?ks.jsx(u,{className:"h-4 w-4 animate-spin"}):ks.jsx(Z,{className:"h-4 w-4"})}),C&&ks.jsx("div",{className:"absolute right-0 mt-32 w-48 bg-white rounded-md shadow-lg z-10 border border-gray-200",children:ks.jsxs("div",{className:"py-1",children:[ks.jsxs("button",{onClick:()=>{const e=[["Nome","Descrição","Status","Tipo","Canal","Criado em","Agendado para","Enviados","Entregues","Lidos","Cliques","Conversões","Receita"]];r.forEach(s=>{e.push([s.name,s.description,s.status,s.type,s.channel,A(s.createdAt),s.scheduledAt?A(s.scheduledAt):"N/A",s.stats.sent.toString(),s.stats.delivered.toString(),s.stats.read.toString(),s.stats.clicked.toString(),s.stats.converted.toString(),`R$ ${s.stats.revenue.toLocaleString()}`])});const s=e.map(e=>e.map(e=>`"${e}"`).join(",")).join("\n"),t=new Blob([s],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(t),n=document.createElement("a");n.setAttribute("href",a),n.setAttribute("download",`campanhas_${(new Date).toISOString().split("T")[0]}.csv`),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[ks.jsx(es,{className:"h-4 w-4 mr-2"}),"Exportar CSV"]}),ks.jsxs("button",{onClick:()=>{window.print()},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[ks.jsx(Ye,{className:"h-4 w-4 mr-2"}),"Imprimir"]})]})})]})]}),c&&ks.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:c}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4",children:[ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Enviadas"}),ks.jsx("p",{className:"text-2xl font-bold text-gray-900",children:D.sent.toLocaleString()})]}),ks.jsx(ne,{className:"h-8 w-8 text-blue-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Entregues"}),ks.jsx("p",{className:"text-2xl font-bold text-green-600",children:D.delivered.toLocaleString()}),ks.jsxs("p",{className:"text-xs text-gray-500",children:[D.sent>0?(D.delivered/D.sent*100).toFixed(1):0,"% taxa entrega"]})]}),ks.jsx(j,{className:"h-8 w-8 text-green-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Lidas"}),ks.jsx("p",{className:"text-2xl font-bold text-purple-600",children:D.read.toLocaleString()}),ks.jsxs("p",{className:"text-xs text-gray-500",children:[I(D.read,D.delivered),"% taxa abertura"]})]}),ks.jsx(h,{className:"h-8 w-8 text-purple-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Cliques"}),ks.jsx("p",{className:"text-2xl font-bold text-orange-600",children:D.clicked.toLocaleString()}),ks.jsxs("p",{className:"text-xs text-gray-500",children:[M(D.clicked,D.read),"% taxa clique"]})]}),ks.jsx(O,{className:"h-8 w-8 text-orange-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Conversões"}),ks.jsx("p",{className:"text-2xl font-bold text-red-600",children:D.converted.toLocaleString()}),ks.jsxs("p",{className:"text-xs text-gray-500",children:[P(D.converted,D.clicked),"% conversão"]})]}),ks.jsx(p,{className:"h-8 w-8 text-red-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Receita"}),ks.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["R$ ",(D.revenue/1e3).toFixed(0),"K"]}),ks.jsxs("p",{className:"text-xs text-gray-500",children:["R$ ",(D.revenue/D.converted||0).toFixed(0)," por conversão"]})]}),ks.jsx(te,{className:"h-8 w-8 text-green-600"})]})})]}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:[ks.jsxs("div",{className:"flex-1 relative",children:[ks.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),ks.jsx("input",{type:"text",placeholder:"Buscar campanhas...",value:d,onChange:e=>m(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),ks.jsxs("select",{value:x,onChange:e=>g(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"all",children:"Todos os Status"}),ks.jsx("option",{value:"running",children:"Em Execução"}),ks.jsx("option",{value:"paused",children:"Pausada"}),ks.jsx("option",{value:"completed",children:"Concluída"}),ks.jsx("option",{value:"scheduled",children:"Agendada"}),ks.jsx("option",{value:"draft",children:"Rascunho"}),ks.jsx("option",{value:"cancelled",children:"Cancelada"})]}),ks.jsxs("select",{value:f,onChange:e=>y(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"all",children:"Todos os Tipos"}),ks.jsx("option",{value:"promotional",children:"Promocional"}),ks.jsx("option",{value:"welcome",children:"Boas-vindas"}),ks.jsx("option",{value:"retargeting",children:"Retargeting"}),ks.jsx("option",{value:"survey",children:"Pesquisa"}),ks.jsx("option",{value:"product_launch",children:"Lançamento"})]})]})}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[i?ks.jsx("div",{className:"flex items-center justify-center py-12",children:ks.jsx(u,{className:"h-8 w-8 text-gray-400 animate-spin"})}):ks.jsx("div",{className:"overflow-x-auto",children:ks.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[ks.jsx("thead",{className:"bg-gray-50",children:ks.jsxs("tr",{children:[ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>T("name"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Campanha"}),"name"===b&&ks.jsx(Ze,{className:"h-4 w-4"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>T("status"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Status"}),"status"===b&&ks.jsx(Ze,{className:"h-4 w-4"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Audiência"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Performance"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Receita"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>T("createdAt"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Criada em"}),"createdAt"===b&&ks.jsx(Ze,{className:"h-4 w-4"})]})})]})}),ks.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(e=>ks.jsxs("tr",{className:"hover:bg-gray-50",children:[ks.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[ks.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name}),ks.jsx("div",{className:"text-sm text-gray-500",children:e.description})]}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${E(e.status)}`,children:[R(e.status),"running"===e.status?"Em Execução":"paused"===e.status?"Pausada":"completed"===e.status?"Concluída":"scheduled"===e.status?"Agendada":"cancelled"===e.status?"Cancelada":"Rascunho"]})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${L(e.type)}`,children:"promotional"===e.type?"Promocional":"welcome"===e.type?"Boas-vindas":"retargeting"===e.type?"Retargeting":"survey"===e.type?"Pesquisa":"Lançamento"})}),ks.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx(z,{className:"h-4 w-4 text-gray-400"}),ks.jsx("span",{className:"text-sm text-gray-900",children:e.targetAudience.total})]}),ks.jsx("div",{className:"text-xs text-gray-500",children:e.targetAudience.segments.join(", ")})]}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("div",{className:"space-y-1",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(ne,{className:"h-3 w-3 text-gray-400"}),ks.jsxs("span",{className:"text-xs text-gray-600",children:[e.stats.sent.toLocaleString()," enviadas"]})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(h,{className:"h-3 w-3 text-gray-400"}),ks.jsxs("span",{className:"text-xs text-gray-600",children:[I(e.stats.read,e.stats.delivered),"% abertura"]})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(O,{className:"h-3 w-3 text-gray-400"}),ks.jsxs("span",{className:"text-xs text-gray-600",children:[P(e.stats.converted,e.stats.clicked),"% conversão"]})]})]})}),ks.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[ks.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["R$ ",e.stats.revenue.toLocaleString()]}),ks.jsxs("div",{className:"text-xs text-gray-500",children:[e.stats.converted," conversões"]})]}),ks.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx(G,{className:"h-4 w-4 text-gray-400"}),ks.jsx("span",{className:"text-sm text-gray-500",children:A(e.createdAt)})]}),ks.jsxs("div",{className:"text-xs text-gray-500",children:["por ",e.createdBy]})]})]},e.id))})]})}),!i&&0===r.length&&ks.jsxs("div",{className:"text-center py-12",children:[ks.jsx(ne,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),ks.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma campanha encontrada"}),ks.jsx("p",{className:"text-gray-500",children:d||"all"!==x||"all"!==f?"Tente ajustar os filtros de busca":"Comece criando sua primeira campanha"})]})]}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[ks.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Campanhas por Status"}),ks.jsxs("div",{className:"space-y-2",children:[ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("span",{className:"w-3 h-3 rounded-full bg-green-500"}),ks.jsx("span",{className:"text-sm text-gray-600",children:"Em Execução"})]}),ks.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.filter(e=>"running"===e.status).length})]}),ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("span",{className:"w-3 h-3 rounded-full bg-yellow-500"}),ks.jsx("span",{className:"text-sm text-gray-600",children:"Pausadas"})]}),ks.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.filter(e=>"paused"===e.status).length})]}),ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("span",{className:"w-3 h-3 rounded-full bg-blue-500"}),ks.jsx("span",{className:"text-sm text-gray-600",children:"Concluídas"})]}),ks.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.filter(e=>"completed"===e.status).length})]}),ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("span",{className:"w-3 h-3 rounded-full bg-purple-500"}),ks.jsx("span",{className:"text-sm text-gray-600",children:"Agendadas"})]}),ks.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.filter(e=>"scheduled"===e.status).length})]}),ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("span",{className:"w-3 h-3 rounded-full bg-gray-500"}),ks.jsx("span",{className:"text-sm text-gray-600",children:"Rascunhos"})]}),ks.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.filter(e=>"draft"===e.status).length})]})]})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[ks.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Campanhas por Tipo"}),ks.jsxs("div",{className:"space-y-2",children:[ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("span",{className:"w-3 h-3 rounded-full bg-orange-500"}),ks.jsx("span",{className:"text-sm text-gray-600",children:"Promocional"})]}),ks.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.filter(e=>"promotional"===e.type).length})]}),ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("span",{className:"w-3 h-3 rounded-full bg-green-500"}),ks.jsx("span",{className:"text-sm text-gray-600",children:"Boas-vindas"})]}),ks.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.filter(e=>"welcome"===e.type).length})]}),ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("span",{className:"w-3 h-3 rounded-full bg-blue-500"}),ks.jsx("span",{className:"text-sm text-gray-600",children:"Retargeting"})]}),ks.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.filter(e=>"retargeting"===e.type).length})]}),ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("span",{className:"w-3 h-3 rounded-full bg-purple-500"}),ks.jsx("span",{className:"text-sm text-gray-600",children:"Pesquisa"})]}),ks.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.filter(e=>"survey"===e.type).length})]}),ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("span",{className:"w-3 h-3 rounded-full bg-pink-500"}),ks.jsx("span",{className:"text-sm text-gray-600",children:"Lançamento"})]}),ks.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.filter(e=>"product_launch"===e.type).length})]})]})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[ks.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Métricas de Performance"}),ks.jsxs("div",{className:"space-y-2",children:[ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Taxa de Entrega"}),ks.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[D.sent>0?(D.delivered/D.sent*100).toFixed(1):0,"%"]})]}),ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Taxa de Abertura"}),ks.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[I(D.read,D.delivered),"%"]})]}),ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Taxa de Clique"}),ks.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[M(D.clicked,D.read),"%"]})]}),ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Taxa de Conversão"}),ks.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[P(D.converted,D.clicked),"%"]})]}),ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsx("span",{className:"text-sm text-gray-600",children:"Receita por Envio"}),ks.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["R$ ",D.sent>0?(D.revenue/D.sent).toFixed(2):"0.00"]})]})]})]})]})]})},Da=()=>{const{user:e}=Ls(),[s,a]=t.useState([]),[r,n]=t.useState([]),[i,l]=t.useState(!1),[c,o]=t.useState(null),[d,m]=t.useState(""),[x,h]=t.useState("all"),[p,g]=t.useState("usage"),[f,y]=t.useState("desc"),[j,b]=t.useState(!1);t.useEffect(()=>{e?.companyId&&N()},[e?.companyId]),t.useEffect(()=>{v()},[s,d,x,p,f]);const N=async()=>{if(e?.companyId)try{l(!0),o(null);const s=await Es.getTags(e.companyId);if(s.success&&s.data){const e=s.data.map(e=>({id:e.id,name:e.name,color:e.color,category:e.category,description:e.description,isDefault:e.is_default,usageCount:e.usage_count||0,createdAt:new Date(e.created_at),createdBy:e.created_by_name||"Sistema",lastUsed:e.last_used?new Date(e.last_used):void 0,aiSuggested:"ai-generated"===e.category,keywords:e.keywords||[]}));a(e)}}catch(Ha){o("Não foi possível carregar as tags. Tente novamente mais tarde.")}finally{l(!1)}},v=()=>{let e=s.filter(e=>{const s=e.name.toLowerCase().includes(d.toLowerCase())||e.description?.toLowerCase().includes(d.toLowerCase())||e.keywords?.some(e=>e.toLowerCase().includes(d.toLowerCase())),t="all"===x||e.category===x;return s&&t});e.sort((e,s)=>{let t=0;switch(p){case"name":t=e.name.localeCompare(s.name);break;case"usage":default:t=e.usageCount-s.usageCount;break;case"created":t=e.createdAt.getTime()-s.createdAt.getTime();break;case"category":t=e.category.localeCompare(s.category)}return"asc"===f?t:-t}),n(e)},w=e=>{p===e?y("asc"===f?"desc":"asc"):(g(e),y("asc"))},C=e=>e.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}),k=e=>{switch(e){case"status":return"Status";case"priority":return"Prioridade";case"department":return"Departamento";case"custom":return"Personalizada";case"ai-generated":return"IA Gerada";default:return e}},_=e=>{switch(e){case"status":return"bg-green-100 text-green-800";case"priority":return"bg-red-100 text-red-800";case"department":return"bg-blue-100 text-blue-800";case"custom":return"bg-purple-100 text-purple-800";case"ai-generated":return"bg-indigo-100 text-indigo-800";default:return"bg-gray-100 text-gray-800"}},S={totalTags:s.length,activelyUsed:s.filter(e=>e.usageCount>0).length,categoryDistribution:s.reduce((e,s)=>(e[s.category]=(e[s.category]||0)+1,e),{}),mostUsed:[...s].sort((e,s)=>s.usageCount-e.usageCount).slice(0,5)};return ks.jsxs("div",{className:"space-y-6",children:[ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx(fe,{className:"h-6 w-6 text-gray-600"}),ks.jsxs("div",{children:[ks.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Relatório de Tags"}),ks.jsxs("p",{className:"text-sm text-gray-600",children:[r.length," tags encontradas"]})]})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsxs("button",{onClick:()=>b(!j),className:"px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 flex items-center space-x-2",children:[ks.jsx(de,{className:"h-4 w-4"}),ks.jsx("span",{children:"Exportar"})]}),ks.jsx("button",{onClick:N,disabled:i,className:"p-2 text-gray-600 hover:text-gray-900 bg-white border border-gray-300 rounded-md hover:bg-gray-50",title:"Atualizar",children:i?ks.jsx(u,{className:"h-4 w-4 animate-spin"}):ks.jsx(Z,{className:"h-4 w-4"})}),j&&ks.jsx("div",{className:"absolute right-0 mt-32 w-48 bg-white rounded-md shadow-lg z-10 border border-gray-200",children:ks.jsxs("div",{className:"py-1",children:[ks.jsxs("button",{onClick:()=>{const e=[["Nome","Categoria","Descrição","Cor","Usos","Padrão","Criado em","Criado por","Palavras-chave"]];r.forEach(s=>{e.push([s.name,s.category,s.description||"",s.color,s.usageCount.toString(),s.isDefault?"Sim":"Não",C(s.createdAt),s.createdBy,s.keywords?.join("; ")||""])});const s=e.map(e=>e.map(e=>`"${e}"`).join(",")).join("\n"),t=new Blob([s],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(t),n=document.createElement("a");n.setAttribute("href",a),n.setAttribute("download",`tags_${(new Date).toISOString().split("T")[0]}.csv`),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[ks.jsx(es,{className:"h-4 w-4 mr-2"}),"Exportar CSV"]}),ks.jsxs("button",{onClick:()=>{window.print()},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[ks.jsx(Ye,{className:"h-4 w-4 mr-2"}),"Imprimir"]})]})})]})]}),c&&ks.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:c}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total de Tags"}),ks.jsx("p",{className:"text-2xl font-bold text-gray-900",children:S.totalTags})]}),ks.jsx(fe,{className:"h-8 w-8 text-blue-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Em Uso"}),ks.jsx("p",{className:"text-2xl font-bold text-green-600",children:S.activelyUsed}),ks.jsxs("p",{className:"text-xs text-gray-500",children:[S.totalTags>0?(S.activelyUsed/S.totalTags*100).toFixed(1):0,"% do total"]})]}),ks.jsx(M,{className:"h-8 w-8 text-green-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Geradas por IA"}),ks.jsx("p",{className:"text-2xl font-bold text-purple-600",children:S.categoryDistribution["ai-generated"]||0})]}),ks.jsx(te,{className:"h-8 w-8 text-purple-600"})]})}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{children:[ks.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Mais Usada"}),ks.jsxs("p",{className:"text-lg font-bold text-orange-600",children:[S.mostUsed[0]?.usageCount||0," usos"]}),ks.jsx("p",{className:"text-xs text-gray-500",children:S.mostUsed[0]?.name||"N/A"})]}),ks.jsx(M,{className:"h-8 w-8 text-orange-600"})]})})]}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:[ks.jsxs("div",{className:"flex-1 relative",children:[ks.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),ks.jsx("input",{type:"text",placeholder:"Buscar por nome, descrição ou palavras-chave...",value:d,onChange:e=>m(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),ks.jsxs("select",{value:x,onChange:e=>h(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"all",children:"Todas as Categorias"}),ks.jsx("option",{value:"status",children:"Status"}),ks.jsx("option",{value:"priority",children:"Prioridade"}),ks.jsx("option",{value:"department",children:"Departamento"}),ks.jsx("option",{value:"custom",children:"Personalizada"}),ks.jsx("option",{value:"ai-generated",children:"IA Gerada"})]}),ks.jsxs("select",{value:`${p}-${f}`,onChange:e=>{const[s,t]=e.target.value.split("-");g(s),y(t)},className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"usage-desc",children:"Mais Usadas"}),ks.jsx("option",{value:"usage-asc",children:"Menos Usadas"}),ks.jsx("option",{value:"name-asc",children:"Nome A-Z"}),ks.jsx("option",{value:"name-desc",children:"Nome Z-A"}),ks.jsx("option",{value:"created-desc",children:"Mais Recentes"}),ks.jsx("option",{value:"created-asc",children:"Mais Antigas"}),ks.jsx("option",{value:"category-asc",children:"Categoria A-Z"})]})]})}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[i?ks.jsx("div",{className:"flex items-center justify-center py-12",children:ks.jsx(u,{className:"h-8 w-8 text-gray-400 animate-spin"})}):ks.jsx("div",{className:"overflow-x-auto",children:ks.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[ks.jsx("thead",{className:"bg-gray-50",children:ks.jsxs("tr",{children:[ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>w("name"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Tag"}),"name"===p&&ks.jsx(Ze,{className:"h-4 w-4"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>w("category"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Categoria"}),"category"===p&&ks.jsx(Ze,{className:"h-4 w-4"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Descrição"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cor"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>w("usage"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Usos"}),"usage"===p&&ks.jsx(Ze,{className:"h-4 w-4"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>w("created"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Criado em"}),"created"===p&&ks.jsx(Ze,{className:"h-4 w-4"})]})})]})}),ks.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(e=>ks.jsxs("tr",{className:"hover:bg-gray-50",children:[ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",style:{backgroundColor:e.color+"20",color:e.color,border:`1px solid ${e.color}40`},children:[ks.jsx(Se,{className:"h-3 w-3"}),e.name]}),e.isDefault&&ks.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs bg-gray-100 text-gray-800",children:"Padrão"})]})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${_(e.category)}`,children:k(e.category)})}),ks.jsxs("td",{className:"px-6 py-4",children:[ks.jsx("div",{className:"text-sm text-gray-900",children:e.description||ks.jsx("span",{className:"text-gray-500 italic",children:"Sem descrição"})}),e.keywords&&e.keywords.length>0&&ks.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:e.keywords.map((e,s)=>ks.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-gray-100 text-gray-700",children:e},s))})]}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("div",{className:"w-6 h-6 rounded-full border border-gray-200",style:{backgroundColor:e.color}}),ks.jsx("span",{className:"text-sm text-gray-500 font-mono",children:e.color})]})}),ks.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[ks.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.usageCount}),ks.jsx("div",{className:"text-xs text-gray-500",children:0===e.usageCount?"Nunca usada":1===e.usageCount?"Usada 1 vez":`Usada ${e.usageCount} vezes`})]}),ks.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx(G,{className:"h-4 w-4 text-gray-400"}),ks.jsx("span",{className:"text-sm text-gray-500",children:C(e.createdAt)})]}),ks.jsxs("div",{className:"text-xs text-gray-500",children:["por ",e.createdBy]})]})]},e.id))})]})}),!i&&0===r.length&&ks.jsxs("div",{className:"text-center py-12",children:[ks.jsx(fe,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),ks.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma tag encontrada"}),ks.jsx("p",{className:"text-gray-500",children:d||"all"!==x?"Tente ajustar os filtros de busca":"Comece criando sua primeira tag"})]})]}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Distribuição por Categoria"}),ks.jsx("div",{className:"space-y-3",children:Object.entries(S.categoryDistribution).map(([e,s])=>ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsx("div",{className:"flex items-center space-x-2",children:ks.jsx("span",{className:`px-2 py-1 rounded-md text-xs font-medium ${_(e)}`,children:k(e)})}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:ks.jsx("div",{className:"h-2 rounded-full bg-blue-600",style:{width:s/S.totalTags*100+"%"}})}),ks.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[s," (",(s/S.totalTags*100).toFixed(1),"%)"]})]})]},e))})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Tags Mais Usadas"}),ks.jsxs("div",{className:"space-y-3",children:[S.mostUsed.map((e,s)=>ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold text-white "+(0===s?"bg-yellow-500":1===s?"bg-gray-400":2===s?"bg-orange-500":"bg-blue-500"),children:s+1}),ks.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",style:{backgroundColor:e.color+"20",color:e.color,border:`1px solid ${e.color}40`},children:[ks.jsx(Se,{className:"h-2 w-2"}),e.name]})]}),ks.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[e.usageCount," usos"]})]},e.id)),0===S.mostUsed.length&&ks.jsx("div",{className:"text-center py-4",children:ks.jsx("p",{className:"text-sm text-gray-500",children:"Nenhuma tag com uso registrado"})})]})]})]})]})},Oa=()=>{const{user:e}=Ls(),[s,a]=t.useState([]),[r,n]=t.useState([]),[i,l]=t.useState([]),[c,o]=t.useState({totalInQueue:0,avgWaitTime:0,criticalItems:0,agentsAvailable:0,throughputPerHour:0,satisfactionTrend:0,escalationRate:0,aiAccuracy:0}),[d,m]=t.useState(!1),[x,h]=t.useState(null),[p,g]=t.useState(""),[f,y]=t.useState("all"),[j,b]=t.useState("all"),[N,v]=t.useState("urgency"),[w,C]=t.useState("desc"),[k,_]=t.useState(!1),[S,T]=t.useState("today");t.useEffect(()=>{e?.companyId&&(A(),E())},[e?.companyId,S]),t.useEffect(()=>{L()},[s,p,f,j,N,w]);const A=async()=>{if(e?.companyId)try{m(!0),h(null),setTimeout(()=>{const e=[{id:"1",customerName:"Maria Silva",customerPhone:"+55 11 99999-1234",customerEmail:"maria@email.com",customerAvatar:"https://images.unsplash.com/photo-1494790108755-2616b612b786?w=40&h=40&fit=crop&crop=face",priority:"urgent",department:"vendas",category:"produto-premium",source:"whatsapp",waitTime:15,estimatedWaitTime:3,aiPredictedWaitTime:2,status:"waiting",tags:["vip","produto-premium","urgente","hot-lead"],customerValue:"platinum",urgencyScore:95,satisfactionHistory:4.8,conversationPreview:"Preciso de informações sobre o produto premium que vi no site...",createdAt:new Date(Date.now()-9e5)},{id:"2",customerName:"João Santos",customerPhone:"+55 11 98888-5678",priority:"high",department:"suporte",category:"problema-tecnico",source:"webchat",waitTime:8,estimatedWaitTime:5,aiPredictedWaitTime:4,assignedAgent:"Carlos Lima",status:"assigned",tags:["problema-tecnico","cliente-recorrente","escalado"],customerValue:"gold",urgencyScore:78,satisfactionHistory:4.2,conversationPreview:"Estou com dificuldades para acessar minha conta...",createdAt:new Date(Date.now()-48e4)},{id:"3",customerName:"Ana Costa",customerPhone:"+55 11 97777-9012",priority:"medium",department:"vendas",category:"informacoes-gerais",source:"whatsapp",waitTime:22,estimatedWaitTime:8,aiPredictedWaitTime:6,status:"waiting",tags:["novo-cliente","interessado","lead-qualificado"],customerValue:"bronze",urgencyScore:45,satisfactionHistory:0,conversationPreview:"Gostaria de saber mais sobre os planos disponíveis...",createdAt:new Date(Date.now()-132e4)}];a(e),o({totalInQueue:e.length,avgWaitTime:Math.round(e.reduce((e,s)=>e+s.waitTime,0)/e.length),criticalItems:e.filter(e=>e.urgencyScore>=80).length,agentsAvailable:3,throughputPerHour:45,satisfactionTrend:4.6,escalationRate:12,aiAccuracy:87}),m(!1)},500)}catch(Ha){h("Não foi possível carregar os dados da fila. Tente novamente mais tarde."),m(!1)}},E=async()=>{if(e?.companyId)try{setTimeout(()=>{l([{id:"agent-1",name:"Carlos Lima",status:"online",currentLoad:3,maxLoad:5,avgResponseTime:95,satisfactionScore:4.7,efficiency:92},{id:"agent-2",name:"Maria Santos",status:"busy",currentLoad:5,maxLoad:5,avgResponseTime:78,satisfactionScore:4.9,efficiency:96},{id:"agent-3",name:"Ana Costa",status:"online",currentLoad:2,maxLoad:4,avgResponseTime:112,satisfactionScore:4.5,efficiency:89}])},500)}catch(Ha){}},L=()=>{let e=[...s];p&&(e=e.filter(e=>e.customerName.toLowerCase().includes(p.toLowerCase())||e.customerPhone.includes(p)||e.customerEmail&&e.customerEmail.toLowerCase().includes(p.toLowerCase())||e.conversationPreview.toLowerCase().includes(p.toLowerCase())||e.tags.some(e=>e.toLowerCase().includes(p.toLowerCase())))),"all"!==f&&(e=e.filter(e=>e.priority===f)),"all"!==j&&(e=e.filter(e=>e.status===j)),e.sort((e,s)=>{let t=0;switch(N){case"urgency":t=e.urgencyScore-s.urgencyScore;break;case"waitTime":t=e.waitTime-s.waitTime;break;case"customerValue":const a={platinum:4,gold:3,silver:2,bronze:1};t=(a[e.customerValue]||0)-(a[s.customerValue]||0)}return"asc"===w?t:-t}),n(e)},I=e=>{N===e?C("asc"===w?"desc":"asc"):(v(e),C("desc"))},M=e=>{if(e<60)return`${e} min`;return`${Math.floor(e/60)}h ${e%60}min`},P=e=>{switch(e){case"urgent":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},D=e=>{switch(e){case"waiting":return"bg-yellow-100 text-yellow-800";case"assigned":return"bg-blue-100 text-blue-800";case"in_progress":return"bg-green-100 text-green-800";case"escalated":return"bg-red-100 text-red-800";case"transferred":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},O=e=>{switch(e){case"waiting":return"Aguardando";case"assigned":return"Atribuído";case"in_progress":return"Em Progresso";case"escalated":return"Escalado";case"transferred":return"Transferido";default:return e}},$=e=>{switch(e){case"urgent":return"Urgente";case"high":return"Alta";case"medium":return"Média";case"low":return"Baixa";default:return e}},B=e=>{switch(e){case"platinum":return"bg-purple-100 text-purple-800";case"gold":return"bg-yellow-100 text-yellow-800";case"silver":default:return"bg-gray-100 text-gray-800";case"bronze":return"bg-orange-100 text-orange-800"}};return ks.jsxs("div",{className:"space-y-6",children:[ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx(z,{className:"h-6 w-6 text-gray-600"}),ks.jsxs("div",{children:[ks.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Relatório da Fila de Atendimento"}),ks.jsxs("p",{className:"text-sm text-gray-600",children:[r.length," itens encontrados"]})]})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsxs("select",{value:S,onChange:e=>T(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"today",children:"Hoje"}),ks.jsx("option",{value:"yesterday",children:"Ontem"}),ks.jsx("option",{value:"week",children:"Esta Semana"}),ks.jsx("option",{value:"month",children:"Este Mês"})]}),ks.jsxs("button",{onClick:()=>_(!k),className:"px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 flex items-center space-x-2",children:[ks.jsx(de,{className:"h-4 w-4"}),ks.jsx("span",{children:"Exportar"})]}),ks.jsx("button",{onClick:A,disabled:d,className:"p-2 text-gray-600 hover:text-gray-900 bg-white border border-gray-300 rounded-md hover:bg-gray-50",title:"Atualizar",children:d?ks.jsx(u,{className:"h-4 w-4 animate-spin"}):ks.jsx(Z,{className:"h-4 w-4"})}),k&&ks.jsx("div",{className:"absolute right-0 mt-32 w-48 bg-white rounded-md shadow-lg z-10 border border-gray-200",children:ks.jsxs("div",{className:"py-1",children:[ks.jsxs("button",{onClick:()=>{const e=[["Cliente","Telefone","Email","Prioridade","Departamento","Categoria","Fonte","Tempo de Espera","Status","Tags","Valor do Cliente","Urgência","Criado em"]];r.forEach(s=>{e.push([s.customerName,s.customerPhone,s.customerEmail||"",s.priority,s.department,s.category,s.source,M(s.waitTime),s.status,s.tags.join("; "),s.customerValue,s.urgencyScore.toString(),s.createdAt.toLocaleString("pt-BR")])});const s=e.map(e=>e.map(e=>`"${e}"`).join(",")).join("\n"),t=new Blob([s],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(t),n=document.createElement("a");n.setAttribute("href",a),n.setAttribute("download",`fila_atendimento_${(new Date).toISOString().split("T")[0]}.csv`),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[ks.jsx(es,{className:"h-4 w-4 mr-2"}),"Exportar CSV"]}),ks.jsxs("button",{onClick:()=>{window.print()},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[ks.jsx(Ye,{className:"h-4 w-4 mr-2"}),"Imprimir"]})]})})]})]}),x&&ks.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:x}),ks.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-3",children:[ks.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 p-3 rounded-lg",children:[ks.jsx("div",{className:"text-lg font-bold text-blue-900",children:c.totalInQueue}),ks.jsx("div",{className:"text-xs text-blue-700",children:"Na Fila"})]}),ks.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-green-100 p-3 rounded-lg",children:[ks.jsxs("div",{className:"text-lg font-bold text-green-900",children:[c.avgWaitTime,"min"]}),ks.jsx("div",{className:"text-xs text-green-700",children:"Tempo Médio"})]}),ks.jsxs("div",{className:"bg-gradient-to-r from-red-50 to-red-100 p-3 rounded-lg",children:[ks.jsx("div",{className:"text-lg font-bold text-red-900",children:c.criticalItems}),ks.jsx("div",{className:"text-xs text-red-700",children:"Críticos"})]}),ks.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-purple-100 p-3 rounded-lg",children:[ks.jsx("div",{className:"text-lg font-bold text-purple-900",children:c.agentsAvailable}),ks.jsx("div",{className:"text-xs text-purple-700",children:"Agentes Livres"})]}),ks.jsxs("div",{className:"bg-gradient-to-r from-yellow-50 to-yellow-100 p-3 rounded-lg",children:[ks.jsx("div",{className:"text-lg font-bold text-yellow-900",children:c.throughputPerHour}),ks.jsx("div",{className:"text-xs text-yellow-700",children:"Por Hora"})]}),ks.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-indigo-100 p-3 rounded-lg",children:[ks.jsx("div",{className:"text-lg font-bold text-indigo-900",children:c.satisfactionTrend}),ks.jsx("div",{className:"text-xs text-indigo-700",children:"Satisfação"})]}),ks.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-orange-100 p-3 rounded-lg",children:[ks.jsxs("div",{className:"text-lg font-bold text-orange-900",children:[c.escalationRate,"%"]}),ks.jsx("div",{className:"text-xs text-orange-700",children:"Escalação"})]}),ks.jsxs("div",{className:"bg-gradient-to-r from-teal-50 to-teal-100 p-3 rounded-lg",children:[ks.jsxs("div",{className:"text-lg font-bold text-teal-900",children:[c.aiAccuracy,"%"]}),ks.jsx("div",{className:"text-xs text-teal-700",children:"IA Precisão"})]})]}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:[ks.jsxs("div",{className:"flex-1 relative",children:[ks.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),ks.jsx("input",{type:"text",placeholder:"Buscar por nome, telefone, tags...",value:p,onChange:e=>g(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),ks.jsxs("select",{value:f,onChange:e=>y(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"all",children:"Todas as Prioridades"}),ks.jsx("option",{value:"urgent",children:"Urgente"}),ks.jsx("option",{value:"high",children:"Alta"}),ks.jsx("option",{value:"medium",children:"Média"}),ks.jsx("option",{value:"low",children:"Baixa"})]}),ks.jsxs("select",{value:j,onChange:e=>b(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"all",children:"Todos os Status"}),ks.jsx("option",{value:"waiting",children:"Aguardando"}),ks.jsx("option",{value:"assigned",children:"Atribuído"}),ks.jsx("option",{value:"in_progress",children:"Em Progresso"}),ks.jsx("option",{value:"escalated",children:"Escalado"}),ks.jsx("option",{value:"transferred",children:"Transferido"})]})]})}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[d?ks.jsx("div",{className:"flex items-center justify-center py-12",children:ks.jsx(u,{className:"h-8 w-8 text-gray-400 animate-spin"})}):ks.jsx("div",{className:"overflow-x-auto",children:ks.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[ks.jsx("thead",{className:"bg-gray-50",children:ks.jsxs("tr",{children:[ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Departamento"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Prioridade"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>I("waitTime"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Tempo de Espera"}),"waitTime"===N&&ks.jsx(Ze,{className:"h-4 w-4"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>I("urgency"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Urgência"}),"urgency"===N&&ks.jsx(Ze,{className:"h-4 w-4"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>I("customerValue"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Valor do Cliente"}),"customerValue"===N&&ks.jsx(Ze,{className:"h-4 w-4"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fonte"})]})}),ks.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(e=>{return ks.jsxs("tr",{className:"hover:bg-gray-50",children:[ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center",children:e.customerAvatar?ks.jsx("img",{src:e.customerAvatar,alt:e.customerName,className:"h-10 w-10 rounded-full"}):ks.jsx(z,{className:"h-5 w-5 text-gray-500"})}),ks.jsxs("div",{children:[ks.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.customerName}),ks.jsx("div",{className:"text-sm text-gray-500",children:e.customerPhone})]})]})}),ks.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[ks.jsx("div",{className:"text-sm text-gray-900",children:e.department}),ks.jsx("div",{className:"text-sm text-gray-500",children:e.category})]}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${P(e.priority)}`,children:$(e.priority)})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${D(e.status)}`,children:O(e.status)})}),ks.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx(R,{className:"h-4 w-4 text-gray-400"}),ks.jsx("span",{className:"text-sm text-gray-900",children:M(e.waitTime)})]}),e.aiPredictedWaitTime&&ks.jsxs("div",{className:"text-xs text-blue-600",children:["IA: ",M(e.aiPredictedWaitTime)]})]}),ks.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[ks.jsx("div",{className:"text-lg font-bold "+(s=e.urgencyScore,s>=80?"text-red-600":s>=60?"text-orange-600":s>=40?"text-yellow-600":"text-green-600"),children:e.urgencyScore}),ks.jsx("div",{className:"text-xs text-gray-500",children:e.urgencyScore>=80?"Crítica":e.urgencyScore>=60?"Alta":e.urgencyScore>=40?"Média":"Baixa"})]}),ks.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[ks.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${B(e.customerValue)}`,children:e.customerValue.toUpperCase()}),e.satisfactionHistory>0&&ks.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Satisfação: ",e.satisfactionHistory.toFixed(1),"/5"]})]}),ks.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[ks.jsx("div",{className:"text-sm text-gray-900 capitalize",children:e.source}),ks.jsx("div",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})]})]},e.id);var s})})]})}),!d&&0===r.length&&ks.jsxs("div",{className:"text-center py-12",children:[ks.jsx(z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),ks.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum item na fila encontrado"}),ks.jsx("p",{className:"text-gray-500",children:p||"all"!==f||"all"!==j?"Tente ajustar os filtros de busca":"A fila de atendimento está vazia no momento"})]})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Status dos Agentes"}),ks.jsx("div",{className:"overflow-x-auto",children:ks.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[ks.jsx("thead",{className:"bg-gray-50",children:ks.jsxs("tr",{children:[ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Agente"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Carga"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tempo de Resposta"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Satisfação"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Eficiência"})]})}),ks.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map(e=>ks.jsxs("tr",{className:"hover:bg-gray-50",children:[ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+("online"===e.status?"bg-green-100 text-green-800":"busy"===e.status?"bg-yellow-100 text-yellow-800":"away"===e.status?"bg-orange-100 text-orange-800":"bg-gray-100 text-gray-800"),children:"online"===e.status?"Online":"busy"===e.status?"Ocupado":"away"===e.status?"Ausente":"Offline"})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:ks.jsx("div",{className:"h-2 rounded-full "+(e.currentLoad/e.maxLoad>.8?"bg-red-500":e.currentLoad/e.maxLoad>.5?"bg-yellow-500":"bg-green-500"),style:{width:e.currentLoad/e.maxLoad*100+"%"}})}),ks.jsxs("span",{className:"text-sm text-gray-500",children:[e.currentLoad,"/",e.maxLoad]})]})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("div",{className:"text-sm text-gray-900",children:[e.avgResponseTime,"s"]})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("div",{className:"text-sm text-gray-900",children:[e.satisfactionScore.toFixed(1),"/5"]})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:ks.jsx("div",{className:"h-2 rounded-full "+(e.efficiency>90?"bg-green-500":e.efficiency>70?"bg-yellow-500":"bg-red-500"),style:{width:`${e.efficiency}%`}})}),ks.jsxs("span",{className:"text-sm text-gray-500",children:[e.efficiency,"%"]})]})})]},e.id))})]})})]}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Distribuição por Prioridade"}),ks.jsxs("div",{className:"space-y-3",children:[ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("span",{className:"w-3 h-3 rounded-full bg-red-500"}),ks.jsx("span",{className:"text-sm text-gray-600",children:"Urgente"})]}),ks.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.filter(e=>"urgent"===e.priority).length})]}),ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("span",{className:"w-3 h-3 rounded-full bg-orange-500"}),ks.jsx("span",{className:"text-sm text-gray-600",children:"Alta"})]}),ks.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.filter(e=>"high"===e.priority).length})]}),ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("span",{className:"w-3 h-3 rounded-full bg-yellow-500"}),ks.jsx("span",{className:"text-sm text-gray-600",children:"Média"})]}),ks.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.filter(e=>"medium"===e.priority).length})]}),ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("span",{className:"w-3 h-3 rounded-full bg-green-500"}),ks.jsx("span",{className:"text-sm text-gray-600",children:"Baixa"})]}),ks.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.filter(e=>"low"===e.priority).length})]})]})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Distribuição por Status"}),ks.jsxs("div",{className:"space-y-3",children:[ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("span",{className:"w-3 h-3 rounded-full bg-yellow-500"}),ks.jsx("span",{className:"text-sm text-gray-600",children:"Aguardando"})]}),ks.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.filter(e=>"waiting"===e.status).length})]}),ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("span",{className:"w-3 h-3 rounded-full bg-blue-500"}),ks.jsx("span",{className:"text-sm text-gray-600",children:"Atribuído"})]}),ks.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.filter(e=>"assigned"===e.status).length})]}),ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("span",{className:"w-3 h-3 rounded-full bg-green-500"}),ks.jsx("span",{className:"text-sm text-gray-600",children:"Em Progresso"})]}),ks.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.filter(e=>"in_progress"===e.status).length})]}),ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("span",{className:"w-3 h-3 rounded-full bg-red-500"}),ks.jsx("span",{className:"text-sm text-gray-600",children:"Escalado"})]}),ks.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.filter(e=>"escalated"===e.status).length})]}),ks.jsxs("div",{className:"flex justify-between items-center",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("span",{className:"w-3 h-3 rounded-full bg-purple-500"}),ks.jsx("span",{className:"text-sm text-gray-600",children:"Transferido"})]}),ks.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.filter(e=>"transferred"===e.status).length})]})]})]})]})]})},$a=()=>{const{currentTheme:e,setTheme:s}=Ps();return ks.jsxs("div",{className:"space-y-6",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx(ts,{className:"h-6 w-6 text-gray-600"}),ks.jsxs("div",{children:[ks.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Gerenciamento de Temas Globais"}),ks.jsx("p",{className:"text-sm text-gray-600",children:"Configure a aparência visual de toda a plataforma"})]})]}),ks.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-6",children:ks.jsxs("div",{className:"flex items-start space-x-3",children:[ks.jsx(Me,{className:"h-5 w-5 text-blue-600 mt-0.5"}),ks.jsxs("div",{children:[ks.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:"🎨 Sistema de Temas Global"}),ks.jsxs("p",{className:"text-blue-800 text-sm mb-3",children:["Os temas selecionados aqui são aplicados automaticamente em ",ks.jsx("strong",{children:"TODA a plataforma"}),", incluindo todos os painéis de clientes, interfaces de usuário e componentes do sistema."]}),ks.jsxs("div",{className:"flex items-center space-x-4 text-xs text-blue-700",children:[ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx(F,{className:"h-3 w-3"}),ks.jsx("span",{children:"Aplicação em tempo real"})]}),ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx(h,{className:"h-3 w-3"}),ks.jsx("span",{children:"Visualização instantânea"})]})]})]})]})}),ks.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Object.values(Is).map(t=>ks.jsxs("div",{className:"relative bg-white rounded-xl border-2 p-6 cursor-pointer transition-all duration-300 hover:shadow-xl hover:scale-105 "+(e.name===t.name?"border-primary-500 ring-4 ring-primary-200 shadow-lg":"border-gray-200 hover:border-gray-300"),onClick:()=>s(t.name),style:{borderColor:e.name===t.name?t.colors.primary[500]:void 0},children:[e.name===t.name&&ks.jsx("div",{className:"absolute -top-2 -right-2 w-8 h-8 rounded-full flex items-center justify-center shadow-lg",style:{backgroundColor:t.colors.primary[500]},children:ks.jsx(as,{className:"h-4 w-4 text-white"})}),ks.jsxs("div",{className:"space-y-4",children:[ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t.displayName}),e.name===t.name&&ks.jsx("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full font-medium",children:"ATIVO"})]}),ks.jsxs("div",{className:"space-y-3",children:[ks.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Paleta de Cores:"}),ks.jsx("div",{className:"grid grid-cols-5 gap-1",children:[100,300,500,700,900].map(e=>ks.jsx("div",{className:"aspect-square rounded-lg shadow-sm border border-gray-200",style:{backgroundColor:t.colors.primary[e]},title:`${t.name}-${e}: ${t.colors.primary[e]}`},e))})]}),ks.jsxs("div",{className:"space-y-3",children:[ks.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Prévia dos Componentes:"}),ks.jsx("div",{className:"px-4 py-2 rounded-lg text-white text-sm font-medium text-center transition-all hover:shadow-md",style:{backgroundColor:t.colors.primary[600]},children:"Botão Primário"}),ks.jsx("div",{className:"px-4 py-2 rounded-lg border text-sm font-medium text-center transition-all hover:shadow-sm",style:{borderColor:t.colors.primary[300],color:t.colors.primary[700],backgroundColor:t.colors.primary[50]},children:"Botão Secundário"}),ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:t.colors.primary[500]}}),ks.jsx("span",{className:"text-sm text-gray-600",children:"Status Ativo"})]}),ks.jsx("div",{className:"text-xs px-2 py-1 rounded-full",style:{backgroundColor:t.colors.primary[100],color:t.colors.primary[800]},children:"Badge"})]})]})]})]},t.name))}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[ks.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Tema Atual: ",e.displayName]}),ks.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:Object.entries(e.colors.primary).map(([e,s])=>ks.jsxs("div",{className:"text-center",children:[ks.jsx("div",{className:"w-16 h-16 rounded-lg mx-auto mb-2 shadow-md border border-gray-200",style:{backgroundColor:s}}),ks.jsx("p",{className:"text-sm font-medium text-gray-900",children:e}),ks.jsx("p",{className:"text-xs text-gray-500 font-mono",children:s})]},e))}),ks.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[ks.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Aplicação Global"}),ks.jsx("p",{className:"text-sm text-gray-600",children:"Este tema está sendo aplicado em tempo real em todos os componentes da plataforma, incluindo painéis de clientes, interfaces administrativas e todos os elementos visuais do sistema."})]})]})]})},Ba=()=>{const{globalSettings:e,updateGlobalSettings:s}=Ps(),[a,r]=t.useState(e),[n,i]=t.useState("general"),[l,c]=t.useState(!1),[o,d]=t.useState(!1),[x,h]=t.useState(null),u=(e,s,t)=>{r(e=>({...e,[s]:t})),c(!0)},p=[{id:"general",name:"Geral",icon:ks.jsx(Qe,{className:"h-4 w-4"})},{id:"security",name:"Segurança",icon:ks.jsx(m,{className:"h-4 w-4"})},{id:"limits",name:"Limites",icon:ks.jsx(z,{className:"h-4 w-4"})},{id:"integrations",name:"Integrações",icon:ks.jsx(Oe,{className:"h-4 w-4"})},{id:"notifications",name:"Notificações",icon:ks.jsx(is,{className:"h-4 w-4"})},{id:"billing",name:"Faturamento",icon:ks.jsx(y,{className:"h-4 w-4"})},{id:"automation",name:"Automação",icon:ks.jsx(F,{className:"h-4 w-4"})},{id:"monitoring",name:"Monitoramento",icon:ks.jsx(M,{className:"h-4 w-4"})},{id:"backup",name:"Backup",icon:ks.jsx(ls,{className:"h-4 w-4"})},{id:"api",name:"API",icon:ks.jsx(b,{className:"h-4 w-4"})},{id:"system",name:"Sistema",icon:ks.jsx(b,{className:"h-4 w-4"})}];return ks.jsxs("div",{className:"space-y-6",children:[ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx(Qe,{className:"h-6 w-6 text-gray-600"}),ks.jsxs("div",{children:[ks.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Configurações Globais"}),ks.jsx("p",{className:"text-sm text-gray-600",children:"Gerencie as configurações globais da plataforma"})]})]}),ks.jsx("div",{className:"flex items-center space-x-2",children:l&&ks.jsxs(ks.Fragment,{children:[ks.jsx("button",{onClick:()=>{r(e),c(!1)},className:"px-3 py-1.5 text-sm border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",disabled:o,children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx(rs,{className:"h-4 w-4"}),ks.jsx("span",{children:"Cancelar"})]})}),ks.jsx("button",{onClick:()=>{d(!0),setTimeout(()=>{try{s(a),h({type:"success",text:"Configurações salvas com sucesso!"}),c(!1),d(!1),setTimeout(()=>{h(null)},3e3)}catch(e){h({type:"error",text:"Erro ao salvar configurações."}),d(!1)}},800)},className:"px-3 py-1.5 text-sm bg-primary-600 text-white rounded-md hover:bg-primary-700 disabled:opacity-50",disabled:o,style:{backgroundColor:"var(--color-primary)"},children:ks.jsx("div",{className:"flex items-center space-x-1",children:o?ks.jsxs(ks.Fragment,{children:[ks.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[ks.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),ks.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),ks.jsx("span",{children:"Salvando..."})]}):ks.jsxs(ks.Fragment,{children:[ks.jsx(ns,{className:"h-4 w-4"}),ks.jsx("span",{children:"Salvar Alterações"})]})})})]})})]}),x&&ks.jsx("div",{className:"p-4 rounded-md "+("success"===x.type?"bg-green-50 text-green-800":"bg-red-50 text-red-800"),children:x.text}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[ks.jsx("div",{className:"border-b border-gray-200 bg-gray-50",children:ks.jsx("div",{className:"flex overflow-x-auto",children:p.map(e=>ks.jsx("button",{onClick:()=>i(e.id),className:"px-4 py-3 text-sm font-medium whitespace-nowrap "+(n===e.id?"border-b-2 border-primary-500 text-primary-600":"text-gray-500 hover:text-gray-700 hover:border-gray-300"),style:{borderBottomColor:n===e.id?"var(--color-primary)":void 0,color:n===e.id?"var(--color-primary)":void 0},children:ks.jsxs("div",{className:"flex items-center space-x-2",children:[e.icon,ks.jsx("span",{children:e.name})]})},e.id))})}),ks.jsxs("div",{className:"p-6",children:["general"===n&&ks.jsxs("div",{className:"space-y-6",children:[ks.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Configurações Gerais"}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[ks.jsxs("div",{children:[ks.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome da Plataforma"}),ks.jsx("input",{type:"text",value:a.platformName,onChange:e=>u(0,"platformName",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),ks.jsxs("div",{children:[ks.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome da Empresa"}),ks.jsx("input",{type:"text",value:a.companyName,onChange:e=>u(0,"companyName",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),ks.jsxs("div",{children:[ks.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email de Suporte"}),ks.jsx("input",{type:"email",value:a.supportEmail,onChange:e=>u(0,"supportEmail",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),ks.jsxs("div",{children:[ks.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefone de Suporte"}),ks.jsx("input",{type:"text",value:a.supportPhone,onChange:e=>u(0,"supportPhone",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),ks.jsxs("div",{children:[ks.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fuso Horário Padrão"}),ks.jsxs("select",{value:a.defaultTimezone,onChange:e=>u(0,"defaultTimezone",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"America/Sao_Paulo",children:"America/Sao_Paulo"}),ks.jsx("option",{value:"America/New_York",children:"America/New_York"}),ks.jsx("option",{value:"Europe/London",children:"Europe/London"}),ks.jsx("option",{value:"Europe/Paris",children:"Europe/Paris"}),ks.jsx("option",{value:"Asia/Tokyo",children:"Asia/Tokyo"})]})]}),ks.jsxs("div",{children:[ks.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Idioma Padrão"}),ks.jsxs("select",{value:a.defaultLanguage,onChange:e=>u(0,"defaultLanguage",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"pt-BR",children:"Português (Brasil)"}),ks.jsx("option",{value:"en-US",children:"English (US)"}),ks.jsx("option",{value:"es-ES",children:"Español"}),ks.jsx("option",{value:"fr-FR",children:"Français"})]})]}),ks.jsxs("div",{children:[ks.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Moeda Padrão"}),ks.jsxs("select",{value:a.defaultCurrency,onChange:e=>u(0,"defaultCurrency",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"BRL",children:"Real (BRL)"}),ks.jsx("option",{value:"USD",children:"US Dollar (USD)"}),ks.jsx("option",{value:"EUR",children:"Euro (EUR)"}),ks.jsx("option",{value:"GBP",children:"British Pound (GBP)"})]})]})]}),ks.jsxs("div",{className:"flex items-center space-x-2 mt-4",children:[ks.jsx("input",{type:"checkbox",id:"maintenanceMode",checked:a.maintenanceMode,onChange:e=>u(0,"maintenanceMode",e.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),ks.jsx("label",{htmlFor:"maintenanceMode",className:"text-sm font-medium text-gray-700",children:"Modo de Manutenção"})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("input",{type:"checkbox",id:"allowNewRegistrations",checked:a.allowNewRegistrations,onChange:e=>u(0,"allowNewRegistrations",e.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),ks.jsx("label",{htmlFor:"allowNewRegistrations",className:"text-sm font-medium text-gray-700",children:"Permitir Novos Registros"})]})]}),"security"===n&&ks.jsxs("div",{className:"space-y-6",children:[ks.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Configurações de Segurança"}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[ks.jsxs("div",{children:[ks.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Timeout de Sessão (minutos)"}),ks.jsx("input",{type:"number",value:a.sessionTimeout,onChange:e=>u(0,"sessionTimeout",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),ks.jsxs("div",{children:[ks.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Máximo de Tentativas de Login"}),ks.jsx("input",{type:"number",value:a.maxLoginAttempts,onChange:e=>u(0,"maxLoginAttempts",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),ks.jsxs("div",{children:[ks.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Duração do Bloqueio (minutos)"}),ks.jsx("input",{type:"number",value:a.lockoutDuration,onChange:e=>u(0,"lockoutDuration",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),ks.jsxs("div",{children:[ks.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Força da Senha"}),ks.jsxs("select",{value:a.passwordStrength,onChange:e=>u(0,"passwordStrength",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"low",children:"Baixa (mínimo 6 caracteres)"}),ks.jsx("option",{value:"medium",children:"Média (mínimo 8 caracteres, letras e números)"}),ks.jsx("option",{value:"high",children:"Alta (mínimo 10 caracteres, letras, números e símbolos)"})]})]})]}),ks.jsxs("div",{className:"space-y-3 mt-4",children:[ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("input",{type:"checkbox",id:"require2FA",checked:a.require2FA,onChange:e=>u(0,"require2FA",e.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),ks.jsx("label",{htmlFor:"require2FA",className:"text-sm font-medium text-gray-700",children:"Exigir Autenticação de Dois Fatores (2FA)"})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("input",{type:"checkbox",id:"enableAuditLogs",checked:a.enableAuditLogs,onChange:e=>u(0,"enableAuditLogs",e.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),ks.jsx("label",{htmlFor:"enableAuditLogs",className:"text-sm font-medium text-gray-700",children:"Habilitar Logs de Auditoria"})]}),ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("input",{type:"checkbox",id:"enableEncryption",checked:a.enableEncryption,onChange:e=>u(0,"enableEncryption",e.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),ks.jsx("label",{htmlFor:"enableEncryption",className:"text-sm font-medium text-gray-700",children:"Habilitar Criptografia de Dados Sensíveis"})]})]}),ks.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4 mt-4",children:ks.jsxs("div",{className:"flex items-start space-x-3",children:[ks.jsx(P,{className:"h-5 w-5 text-yellow-500 mt-0.5"}),ks.jsxs("div",{children:[ks.jsx("h4",{className:"text-sm font-medium text-yellow-800",children:"Atenção"}),ks.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"Alterações nas configurações de segurança podem afetar todos os usuários da plataforma. Certifique-se de comunicar mudanças importantes aos administradores das empresas."})]})]})})]}),"general"!==n&&"security"!==n&&ks.jsxs("div",{className:"text-center py-12",children:[ks.jsx(Qe,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),ks.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:["Configurações de ",p.find(e=>e.id===n)?.name]}),ks.jsx("p",{className:"text-gray-500 max-w-md mx-auto",children:"Esta seção de configurações será implementada na próxima atualização."})]})]})]})]})},qa=()=>{const[e,s]=n.useState(""),[t,a]=n.useState("all"),[r,i]=n.useState(!1),[l,c]=n.useState("name"),[o,d]=n.useState("asc"),m=[{id:1,name:"TechCorp Solutions",email:"contato@techcorp.com",plan:"Enterprise",status:"active",users:25,messagesThisMonth:15420,messageLimit:5e4,createdAt:"2024-01-15",lastActivity:"2 min atrás",whatsappStatus:"connected",domain:"techcorp.gybachat.com"},{id:2,name:"StartupXYZ",email:"admin@startupxyz.com",plan:"Profissional",status:"active",users:8,messagesThisMonth:3250,messageLimit:1e4,createdAt:"2024-02-20",lastActivity:"15 min atrás",whatsappStatus:"disconnected",domain:"startupxyz.gybachat.com"},{id:3,name:"InovaCorp",email:"suporte@inovacorp.com",plan:"Básico",status:"trial",users:3,messagesThisMonth:890,messageLimit:2e3,createdAt:"2024-06-01",lastActivity:"1 hora atrás",whatsappStatus:"connected",domain:"inovacorp.gybachat.com"},{id:4,name:"MegaEmpresa Ltd",email:"ti@megaempresa.com",plan:"Enterprise",status:"suspended",users:45,messagesThisMonth:0,messageLimit:1e5,createdAt:"2023-11-10",lastActivity:"3 dias atrás",whatsappStatus:"disconnected",domain:"megaempresa.gybachat.com"},{id:5,name:"SmallBiz Co",email:"owner@smallbiz.com",plan:"Básico",status:"active",users:2,messagesThisMonth:1650,messageLimit:2e3,createdAt:"2024-03-12",lastActivity:"30 min atrás",whatsappStatus:"warning",domain:"smallbiz.gybachat.com"},{id:6,name:"Consultoria ABC",email:"contato@consultoriaabc.com",plan:"Profissional",status:"active",users:12,messagesThisMonth:7890,messageLimit:1e4,createdAt:"2023-12-05",lastActivity:"5 min atrás",whatsappStatus:"connected",domain:"abc.gybachat.com"},{id:7,name:"Loja Virtual Express",email:"atendimento@lojavirtual.com",plan:"Básico",status:"expired",users:4,messagesThisMonth:0,messageLimit:2e3,createdAt:"2023-10-18",lastActivity:"15 dias atrás",whatsappStatus:"disconnected",domain:"lojavirtual.gybachat.com"}],x=e=>{const s={active:ks.jsx(j,{className:"h-3 w-3 mr-1"}),trial:ks.jsx($,{className:"h-3 w-3 mr-1"}),suspended:ks.jsx(me,{className:"h-3 w-3 mr-1"}),expired:ks.jsx(P,{className:"h-3 w-3 mr-1"})};return ks.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${{active:"bg-green-100 text-green-800",trial:"bg-blue-100 text-blue-800",suspended:"bg-red-100 text-red-800",expired:"bg-gray-100 text-gray-800"}[e]}`,children:[s[e],{active:"Ativo",trial:"Trial",suspended:"Suspenso",expired:"Expirado"}[e]]})},u=e=>{const s={"Básico":ks.jsx(F,{className:"h-3 w-3 mr-1"}),Profissional:ks.jsx($,{className:"h-3 w-3 mr-1"}),Enterprise:ks.jsx(ge,{className:"h-3 w-3 mr-1"})};return ks.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${{"Básico":"bg-gray-100 text-gray-800",Profissional:"bg-blue-100 text-blue-800",Enterprise:"bg-purple-100 text-purple-800"}[e]}`,children:[s[e],e]})},p=e=>{switch(e){case"connected":return ks.jsx(j,{className:"h-4 w-4 text-green-500",title:"Conectado"});case"disconnected":return ks.jsx(me,{className:"h-4 w-4 text-red-500",title:"Desconectado"});case"warning":return ks.jsx(P,{className:"h-4 w-4 text-yellow-500",title:"Atenção"});default:return ks.jsx(me,{className:"h-4 w-4 text-gray-400",title:"Desconhecido"})}},y=m.filter(s=>{const a=s.name.toLowerCase().includes(e.toLowerCase())||s.email.toLowerCase().includes(e.toLowerCase())||s.domain.toLowerCase().includes(e.toLowerCase()),r="all"===t||s.status===t;return a&&r}).sort((e,s)=>{let t=0;switch(l){case"name":default:t=e.name.localeCompare(s.name);break;case"plan":t=e.plan.localeCompare(s.plan);break;case"users":t=e.users-s.users;break;case"messages":t=e.messagesThisMonth-s.messagesThisMonth;break;case"created":t=new Date(e.createdAt).getTime()-new Date(s.createdAt).getTime()}return"asc"===o?t:-t}),b=e=>{l===e?d("asc"===o?"desc":"asc"):(c(e),d("asc"))};return ks.jsxs("div",{className:"space-y-6",children:[ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx(g,{className:"h-6 w-6 text-gray-600"}),ks.jsxs("div",{children:[ks.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Gestão de Contas"}),ks.jsx("p",{className:"text-sm text-gray-600",children:"Gerencie todas as empresas clientes da plataforma"})]})]}),ks.jsxs("button",{onClick:()=>i(!0),className:"flex items-center space-x-2 px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors",style:{backgroundColor:"var(--color-primary)",borderColor:"var(--color-primary)","--tw-ring-color":"var(--color-primary)"},children:[ks.jsx(Ae,{className:"h-4 w-4"}),ks.jsx("span",{children:"Nova Conta"})]})]}),ks.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:ks.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:[ks.jsxs("div",{className:"flex-1 relative",children:[ks.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),ks.jsx("input",{type:"text",placeholder:"Buscar por nome, email ou domínio...",value:e,onChange:e=>s(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),ks.jsxs("div",{className:"relative",children:[ks.jsx(Xe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),ks.jsxs("select",{value:t,onChange:e=>a(e.target.value),className:"pl-10 pr-8 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[ks.jsx("option",{value:"all",children:"Todos os Status"}),ks.jsx("option",{value:"active",children:"Ativo"}),ks.jsx("option",{value:"trial",children:"Trial"}),ks.jsx("option",{value:"suspended",children:"Suspenso"}),ks.jsx("option",{value:"expired",children:"Expirado"})]})]})]})}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[ks.jsx("div",{className:"overflow-x-auto",children:ks.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[ks.jsx("thead",{className:"bg-gray-50",children:ks.jsxs("tr",{children:[ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>b("name"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Empresa"}),"name"===l&&ks.jsx("span",{children:"asc"===o?"↑":"↓"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>b("plan"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Plano"}),"plan"===l&&ks.jsx("span",{children:"asc"===o?"↑":"↓"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>b("users"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Usuários"}),"users"===l&&ks.jsx("span",{children:"asc"===o?"↑":"↓"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>b("messages"),children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx("span",{children:"Mensagens"}),"messages"===l&&ks.jsx("span",{children:"asc"===o?"↑":"↓"})]})}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"WhatsApp"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Domínio"}),ks.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Última Atividade"}),ks.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),ks.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.map(e=>{const s=(t=e.messagesThisMonth,a=e.messageLimit,Math.round(t/a*100));var t,a,r;return ks.jsxs("tr",{className:"hover:bg-gray-50",children:[ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("div",{children:[ks.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name}),ks.jsx("div",{className:"text-sm text-gray-500",children:e.email})]})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u(e.plan)}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:x(e.status)}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx(z,{className:"h-4 w-4 text-gray-400"}),ks.jsx("span",{className:"text-sm text-gray-900",children:e.users})]})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("div",{className:"space-y-1",children:[ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx(f,{className:"h-4 w-4 text-gray-400"}),ks.jsxs("span",{className:"text-sm text-gray-900",children:[e.messagesThisMonth.toLocaleString()," / ",e.messageLimit.toLocaleString()]})]}),ks.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:ks.jsx("div",{className:"h-1.5 rounded-full "+(r=s,r>=90?"bg-red-500":r>=70?"bg-yellow-500":"bg-green-500"),style:{width:`${Math.min(s,100)}%`}})}),ks.jsxs("div",{className:"text-xs text-gray-500",children:[s,"% utilizado"]})]})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:p(e.whatsappStatus)}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsx("div",{className:"text-sm text-gray-900 font-mono",children:e.domain})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ks.jsxs("div",{className:"flex items-center space-x-1",children:[ks.jsx(G,{className:"h-4 w-4 text-gray-400"}),ks.jsx("span",{className:"text-sm text-gray-500",children:e.lastActivity})]})}),ks.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:ks.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[ks.jsx("button",{className:"text-blue-600 hover:text-blue-900 transition-colors",title:"Visualizar",children:ks.jsx(h,{className:"h-4 w-4"})}),ks.jsx("button",{className:"text-green-600 hover:text-green-900 transition-colors",title:"Editar",children:ks.jsx(Re,{className:"h-4 w-4"})}),ks.jsx("button",{className:"text-red-600 hover:text-red-900 transition-colors",title:"Excluir",children:ks.jsx(Ie,{className:"h-4 w-4"})}),ks.jsx("button",{className:"text-gray-400 hover:text-gray-600 transition-colors",title:"Mais opções",children:ks.jsx(ye,{className:"h-4 w-4"})})]})})]},e.id)})})]})}),0===y.length&&ks.jsxs("div",{className:"text-center py-12",children:[ks.jsx(g,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),ks.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma empresa encontrada"}),ks.jsx("p",{className:"text-gray-500",children:e||"all"!==t?"Tente ajustar os filtros de busca":"Comece adicionando sua primeira empresa"})]})]}),ks.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[ks.jsx("div",{className:"text-2xl font-bold text-gray-900",children:m.length}),ks.jsx("div",{className:"text-sm text-gray-500",children:"Total de Empresas"})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[ks.jsx("div",{className:"text-2xl font-bold text-green-600",children:m.filter(e=>"active"===e.status).length}),ks.jsx("div",{className:"text-sm text-gray-500",children:"Empresas Ativas"})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[ks.jsx("div",{className:"text-2xl font-bold text-blue-600",children:m.filter(e=>"trial"===e.status).length}),ks.jsx("div",{className:"text-sm text-gray-500",children:"Em Trial"})]}),ks.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[ks.jsx("div",{className:"text-2xl font-bold text-red-600",children:m.filter(e=>"suspended"===e.status||"expired"===e.status).length}),ks.jsx("div",{className:"text-sm text-gray-500",children:"Suspensas/Expiradas"})]})]})]})},Fa=({children:e})=>{const{user:s,logout:a}=Ls(),{currentTheme:r}=Ps(),[n,i]=t.useState(!1),[l,c]=t.useState(!1),[o,d]=t.useState(!1),[x,h]=t.useState(!1),[u,p]=t.useState(null);t.useEffect(()=>{const e=localStorage.getItem("master-sidebar-pinned");e&&d(JSON.parse(e))},[]),t.useEffect(()=>{localStorage.setItem("master-sidebar-pinned",JSON.stringify(o))},[o]);const f=o||x,y=[{id:1,message:"Nova empresa cadastrada: TechCorp",time:"2 min atrás",unread:!0},{id:2,message:"Sistema atualizado com sucesso",time:"5 min atrás",unread:!0},{id:3,message:"Backup automático concluído",time:"1 hora atrás",unread:!1}],j=y.filter(e=>e.unread).length,b=[{id:"dashboard",name:"Dashboard",icon:te,path:"/master/dashboard"},{id:"companies",name:"Gestão de Contas",icon:g,path:"/master/companies"},{id:"themes",name:"Temas Globais",icon:ts,path:"/master/themes"},{id:"settings",name:"Configurações Globais",icon:Qe,path:"/master/settings"}],N=()=>{p(null)},v=e=>{const s=window.location.pathname,t=e.path===s;return ks.jsx("div",{className:`group relative flex items-center justify-between mx-2 rounded-xl cursor-pointer transition-all duration-200 ${t?"bg-primary-100 text-primary-700 shadow-sm border border-primary-200":"text-gray-600 hover:bg-gray-100 hover:text-gray-900 border border-transparent hover:border-gray-200"} ${f?"px-3 py-2.5":"p-2.5 mx-3 justify-center"}`,style:{backgroundColor:t?r.colors.primary[50]:void 0,color:t?r.colors.primary[700]:void 0,borderColor:t?r.colors.primary[200]:void 0},onClick:()=>{e.path&&(window.location.href=e.path)},onMouseEnter:s=>((e,s)=>{if(!f){const t=e.currentTarget.getBoundingClientRect();p({id:s.id,name:s.name,x:t.right+8,y:t.top+t.height/2})}})(s,e),onMouseLeave:N,children:ks.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[ks.jsx(e.icon,{className:"h-5 w-5 flex-shrink-0 transition-colors "+(t?"text-primary-600":"text-gray-400 group-hover:text-gray-600"),style:{color:t?r.colors.primary[600]:void 0}}),f&&ks.jsx("span",{className:"font-medium text-sm truncate",children:e.name})]})},e.id)};return ks.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[ks.jsxs("div",{className:(f?"w-72":"w-16")+" bg-white border-r border-gray-200 flex flex-col transition-all duration-300 shadow-sm relative z-30",onMouseEnter:()=>{h(!0)},onMouseLeave:()=>{h(!1),p(null)},children:[ks.jsx("div",{className:"border-b border-gray-200 "+(f?"p-4":"p-3"),children:ks.jsxs("div",{className:"flex items-center "+(f?"justify-between":"justify-center"),children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx("div",{className:"w-8 h-8 rounded-xl flex items-center justify-center shadow-sm",style:{backgroundColor:r.colors.primary[600]},children:ks.jsx(m,{className:"h-5 w-5 text-white"})}),f&&ks.jsxs("div",{className:"min-w-0 flex-1",children:[ks.jsx("h1",{className:"text-lg font-bold text-gray-900 truncate",children:"Gybachat Master"}),ks.jsx("p",{className:"text-xs text-gray-500",children:"Painel Administrativo"})]})]}),f&&ks.jsx("button",{onClick:()=>d(!o),className:"p-1.5 rounded-lg transition-all duration-200 "+(o?"text-primary-600 bg-primary-50 hover:bg-primary-100":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"),style:{color:o?r.colors.primary[600]:void 0,backgroundColor:o?r.colors.primary[50]:void 0},title:o?"Desafixar menu":"Fixar menu",children:o?ks.jsx(cs,{className:"h-4 w-4"}):ks.jsx(os,{className:"h-4 w-4"})})]})}),ks.jsx("div",{className:"flex-1 overflow-y-auto py-4",children:ks.jsx("nav",{className:"space-y-1",children:b.map(e=>v(e))})}),ks.jsx("div",{className:"border-t border-gray-200 "+(f?"p-4":"p-3 flex justify-center"),children:ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx("div",{className:"w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center flex-shrink-0",children:s?.avatar?ks.jsx("img",{src:s.avatar,alt:s.name,className:"w-8 h-8 rounded-full"}):ks.jsx(Ne,{className:"h-4 w-4 text-gray-600"})}),f&&ks.jsxs("div",{className:"flex-1 min-w-0",children:[ks.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:s?.name}),ks.jsx("p",{className:"text-xs text-gray-500 truncate",children:s?.email})]})]})})]}),u&&!f&&ks.jsxs("div",{className:"fixed z-50 px-3 py-2 text-sm font-medium text-white bg-gray-900 rounded-lg shadow-lg pointer-events-none",style:{left:u.x,top:u.y,transform:"translateY(-50%)"},children:[u.name,ks.jsx("div",{className:"absolute left-0 top-1/2 transform -translate-y-1/2 -translate-x-1 w-2 h-2 bg-gray-900 rotate-45"})]}),ks.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[ks.jsx("header",{className:"bg-white border-b border-gray-200 px-6 py-4 shadow-sm",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[ks.jsx(ds,{className:"h-4 w-4"}),ks.jsx(ms,{className:"h-4 w-4"}),ks.jsx("span",{className:"text-gray-900 font-medium",children:"Painel Master"})]}),ks.jsxs("div",{className:"flex items-center space-x-4",children:[ks.jsxs("div",{className:"relative",children:[ks.jsxs("button",{onClick:()=>c(!l),className:"p-2.5 text-gray-400 hover:text-gray-500 hover:bg-gray-100 rounded-xl transition-all duration-200 relative",children:[ks.jsx(is,{className:"h-5 w-5"}),j>0&&ks.jsx("span",{className:"absolute -top-1 -right-1 h-5 w-5 text-white text-xs rounded-full flex items-center justify-center font-bold shadow-sm",style:{backgroundColor:r.colors.primary[500]},children:j})]}),l&&ks.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-xl shadow-xl border border-gray-200 z-50 overflow-hidden",children:[ks.jsx("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Notificações"}),j>0&&ks.jsxs("span",{className:"px-2 py-1 text-xs font-medium text-white rounded-full",style:{backgroundColor:r.colors.primary[500]},children:[j," novas"]})]})}),ks.jsx("div",{className:"max-h-64 overflow-y-auto",children:y.map(e=>ks.jsx("div",{className:"p-4 border-b border-gray-100 hover:bg-gray-50 transition-colors cursor-pointer "+(e.unread?"bg-blue-50 border-l-4 border-l-blue-500":""),children:ks.jsxs("div",{className:"flex items-start space-x-3",children:[ks.jsx("div",{className:"w-2 h-2 rounded-full mt-2 "+(e.unread?"bg-blue-500":"bg-gray-300")}),ks.jsxs("div",{className:"flex-1 min-w-0",children:[ks.jsx("p",{className:"text-sm text-gray-900",children:e.message}),ks.jsx("p",{className:"text-xs text-gray-500 mt-1",children:e.time})]})]})},e.id))}),ks.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:ks.jsx("button",{className:"text-sm font-medium hover:text-primary-700 transition-colors",style:{color:r.colors.primary[600]},children:"Ver todas as notificações"})})]})]}),ks.jsx("button",{className:"p-2.5 text-gray-400 hover:text-gray-500 hover:bg-gray-100 rounded-xl transition-all duration-200",children:ks.jsx(xs,{className:"h-5 w-5"})}),ks.jsxs("div",{className:"relative",children:[ks.jsxs("button",{onClick:()=>i(!n),className:"flex items-center space-x-3 p-2 rounded-xl hover:bg-gray-100 transition-all duration-200",children:[ks.jsx("div",{className:"w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center",children:s?.avatar?ks.jsx("img",{src:s.avatar,alt:s.name,className:"w-8 h-8 rounded-full"}):ks.jsx(Ne,{className:"h-4 w-4 text-gray-600"})}),ks.jsxs("div",{className:"hidden md:block text-left",children:[ks.jsx("p",{className:"text-sm font-medium text-gray-900",children:s?.name}),ks.jsx("p",{className:"text-xs text-gray-500",children:s?.email})]}),ks.jsx(hs,{className:"h-4 w-4 text-gray-400"})]}),n&&ks.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-xl border border-gray-200 z-50 overflow-hidden",children:ks.jsxs("div",{className:"py-1",children:[ks.jsxs("button",{className:"flex items-center space-x-2 w-full px-4 py-3 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:[ks.jsx(Ne,{className:"h-4 w-4"}),ks.jsx("span",{children:"Meu Perfil"})]}),ks.jsxs("button",{className:"flex items-center space-x-2 w-full px-4 py-3 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:[ks.jsx(Qe,{className:"h-4 w-4"}),ks.jsx("span",{children:"Configurações"})]}),ks.jsx("hr",{className:"my-1"}),ks.jsxs("button",{onClick:e=>{e.preventDefault(),a()},className:"flex items-center space-x-2 w-full px-4 py-3 text-sm text-red-700 hover:bg-red-50 transition-colors",children:[ks.jsx(us,{className:"h-4 w-4"}),ks.jsx("span",{children:"Sair"})]})]})})]})]})]})}),ks.jsx("main",{className:"flex-1 overflow-auto",children:ks.jsx("div",{className:"p-6",children:e})})]}),u&&!f&&ks.jsxs("div",{className:"fixed z-50 px-3 py-2 text-sm font-medium text-white bg-gray-900 rounded-lg shadow-lg pointer-events-none",style:{left:u.x,top:u.y,transform:"translateY(-50%)"},children:[u.name,ks.jsx("div",{className:"absolute left-0 top-1/2 transform -translate-y-1/2 -translate-x-1 w-2 h-2 bg-gray-900 rotate-45"})]}),(n||l)&&ks.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>{i(!1),c(!1)}})]})},Ua=({children:e})=>{const{user:s,logout:a,hasPermission:r,isAdminOrSupervisor:n}=Ls(),{currentTheme:i}=Ps(),[l,c]=t.useState(!1),[o,d]=t.useState(!1),[m,x]=t.useState(!1),[h,u]=t.useState(!1),[p,g]=t.useState(["whatsapp","social-media","reports"]),[y,j]=t.useState(""),[b,N]=t.useState(null);t.useEffect(()=>{const e=localStorage.getItem("sidebar-pinned");e&&x(JSON.parse(e))},[]),t.useEffect(()=>{localStorage.setItem("sidebar-pinned",JSON.stringify(m))},[m]);const v=m||h,w=[{id:1,message:"Nova mensagem recebida",time:"2 min atrás",unread:!0},{id:2,message:"Agente João entrou online",time:"5 min atrás",unread:!0},{id:3,message:"Campanha finalizada com sucesso",time:"1 hora atrás",unread:!1}],C=w.filter(e=>e.unread).length,k=e=>e.filter(e=>!(e.permission&&!r(e.permission))&&(e.children&&(e.children=k(e.children)),!0)),_=k([{id:"dashboard",name:"Dashboard",icon:ds,path:"/client/dashboard"},{id:"conversations",name:"Conversas",icon:f,path:"/client/conversations",badge:5},{id:"whatsapp",name:"WhatsApp",icon:re,permission:"manage_users",children:[{id:"whatsapp-connection",name:"Conexão",icon:re,path:"/client/whatsapp"},{id:"whatsapp-monitoring",name:"Monitoramento",icon:te,path:"/client/whatsapp-monitoring"}]},{id:"social-media",name:"Redes Sociais",icon:Ke,permission:"manage_users",children:[{id:"social-integration",name:"Integração",icon:Qe,path:"/client/social-media"},{id:"instagram",name:"Instagram",icon:Ke,path:"/client/instagram"},{id:"facebook",name:"Facebook",icon:Je,path:"/client/facebook"}]},{id:"team",name:"Equipe",icon:z,permission:"manage_users",children:[{id:"users",name:"Usuários",icon:Ne,path:"/client/users"},{id:"queue",name:"Fila de Atendimento",icon:z,path:"/client/queue"}]},{id:"marketing",name:"Marketing",icon:O,permission:"manage_campaigns",children:[{id:"campaigns",name:"Campanhas",icon:ne,path:"/client/campaigns"},{id:"contacts",name:"Contatos",icon:$e,path:"/client/contacts",permission:"manage_contacts"}]},{id:"tags",name:"Tags",icon:fe,path:"/client/tags"},{id:"automations",name:"Automações",icon:F,path:"/client/automations",permission:"manage_automations"},{id:"reports",name:"Relatórios",icon:te,permission:"view_analytics",children:[{id:"whatsapp-report",name:"WhatsApp",icon:re,path:"/client/whatsapp-report"},{id:"conversations-report",name:"Conversas",icon:f,path:"/client/conversations-report"},{id:"users-report",name:"Usuários",icon:z,path:"/client/users-report"},{id:"contacts-report",name:"Contatos",icon:$e,path:"/client/contacts-report"},{id:"campaigns-report",name:"Campanhas",icon:ne,path:"/client/campaigns-report"},{id:"tags-report",name:"Tags",icon:fe,path:"/client/tags-report"},{id:"queue-report",name:"Fila",icon:z,path:"/client/queue-report"}]},{id:"settings",name:"Configurações",icon:Qe,path:"/client/settings",permission:"manage_settings"}]),S=()=>{N(null)},T=(e,s=0)=>{const t=p.includes(e.id),a=e.children&&e.children.length>0,r=window.location.pathname,n=e.path===r||e.children&&e.children.some(e=>e.path===r);return ks.jsxs("div",{children:[ks.jsxs("div",{className:`group relative flex items-center justify-between mx-2 rounded-xl cursor-pointer transition-all duration-200 ${n?"bg-primary-100 text-primary-700 shadow-sm border border-primary-200":"text-gray-600 hover:bg-gray-100 hover:text-gray-900 border border-transparent hover:border-gray-200"} ${s>0&&v?"ml-4":""} ${v?"px-3 py-2.5":"p-2.5 mx-3 justify-center"}`,style:{backgroundColor:n?i.colors.primary[50]:void 0,color:n?i.colors.primary[700]:void 0,borderColor:n?i.colors.primary[200]:void 0},onClick:()=>{var s;a&&v?(s=e.id,v&&g(e=>e.includes(s)?e.filter(e=>e!==s):[...e,s])):e.path&&(window.location.href=e.path)},onMouseEnter:s=>((e,s)=>{if(!v){const t=e.currentTarget.getBoundingClientRect();N({id:s.id,name:s.name,x:t.right+8,y:t.top+t.height/2})}})(s,e),onMouseLeave:S,children:[ks.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[ks.jsxs("div",{className:"relative",children:[ks.jsx(e.icon,{className:"h-5 w-5 flex-shrink-0 transition-colors "+(n?"text-primary-600":"text-gray-400 group-hover:text-gray-600"),style:{color:n?i.colors.primary[600]:void 0}}),e.badge&&e.badge>0&&ks.jsx("span",{className:"absolute -top-2 -right-2 inline-flex items-center justify-center text-xs font-bold text-white rounded-full min-w-[18px] h-[18px] px-1 "+(v?"hidden":"block"),style:{backgroundColor:i.colors.primary[500]},children:e.badge})]}),v&&ks.jsxs(ks.Fragment,{children:[ks.jsx("span",{className:"font-medium text-sm truncate",children:e.name}),e.badge&&e.badge>0&&ks.jsx("span",{className:"inline-flex items-center justify-center px-2 py-1 text-xs font-bold text-white rounded-full",style:{backgroundColor:i.colors.primary[500]},children:e.badge})]})]}),v&&a&&ks.jsx(ms,{className:"h-4 w-4 text-gray-400 transition-transform duration-200 "+(t?"rotate-90":"")})]}),a&&t&&v&&ks.jsx("div",{className:"mt-1 space-y-1 ml-2",children:e.children?.map(e=>T(e,s+1))})]},e.id)};return ks.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[ks.jsxs("div",{className:(v?"w-72":"w-16")+" bg-white border-r border-gray-200 flex flex-col transition-all duration-300 shadow-sm relative z-30",onMouseEnter:()=>{u(!0)},onMouseLeave:()=>{u(!1),N(null)},children:[ks.jsx("div",{className:"border-b border-gray-200 "+(v?"p-4":"p-3"),children:ks.jsxs("div",{className:"flex items-center "+(v?"justify-between":"justify-center"),children:[ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx("div",{className:"w-8 h-8 rounded-xl flex items-center justify-center shadow-sm",style:{backgroundColor:i.colors.primary[600]},children:ks.jsx(f,{className:"h-5 w-5 text-white"})}),v&&ks.jsxs("div",{className:"min-w-0 flex-1",children:[ks.jsx("h1",{className:"text-lg font-bold text-gray-900 truncate",children:"Gybachat"}),ks.jsx("p",{className:"text-xs text-gray-500 truncate",children:s?.companyName})]})]}),v&&ks.jsx("button",{onClick:()=>x(!m),className:"p-1.5 rounded-lg transition-all duration-200 "+(m?"text-primary-600 bg-primary-50 hover:bg-primary-100":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"),style:{color:m?i.colors.primary[600]:void 0,backgroundColor:m?i.colors.primary[50]:void 0},title:m?"Desafixar menu":"Fixar menu",children:m?ks.jsx(cs,{className:"h-4 w-4"}):ks.jsx(os,{className:"h-4 w-4"})})]})}),v&&ks.jsx("div",{className:"p-4 border-b border-gray-200",children:ks.jsxs("div",{className:"relative",children:[ks.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),ks.jsx("input",{type:"text",placeholder:"Buscar... (Ctrl+K)",value:y,onChange:e=>j(e.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-gray-50 border border-gray-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 focus:bg-white transition-all duration-200",style:{"--tw-ring-color":i.colors.primary[500]}})]})}),ks.jsx("div",{className:"flex-1 overflow-y-auto py-4",children:ks.jsx("nav",{className:"space-y-1",children:_.map(e=>T(e))})}),ks.jsx("div",{className:"border-t border-gray-200 "+(v?"p-4":"p-3 flex justify-center"),children:ks.jsxs("div",{className:"flex items-center space-x-3",children:[ks.jsx("div",{className:"w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center flex-shrink-0",children:s?.avatar?ks.jsx("img",{src:s.avatar,alt:s.name,className:"w-8 h-8 rounded-full"}):ks.jsx(Ne,{className:"h-4 w-4 text-gray-600"})}),v&&ks.jsxs("div",{className:"flex-1 min-w-0",children:[ks.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:s?.name}),ks.jsx("p",{className:"text-xs text-gray-500 truncate",children:"admin"===s?.role?"Administrador":"supervisor"===s?.role?"Supervisor":"Agente"})]})]})})]}),b&&!v&&ks.jsxs("div",{className:"fixed z-50 px-3 py-2 text-sm font-medium text-white bg-gray-900 rounded-lg shadow-lg pointer-events-none",style:{left:b.x,top:b.y,transform:"translateY(-50%)"},children:[b.name,ks.jsx("div",{className:"absolute left-0 top-1/2 transform -translate-y-1/2 -translate-x-1 w-2 h-2 bg-gray-900 rotate-45"})]}),ks.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[ks.jsx("header",{className:"bg-white border-b border-gray-200 px-6 py-4 shadow-sm",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[ks.jsx(ds,{className:"h-4 w-4"}),ks.jsx(ms,{className:"h-4 w-4"}),ks.jsx("span",{className:"text-gray-900 font-medium",children:"Dashboard"})]}),ks.jsxs("div",{className:"flex items-center space-x-4",children:[ks.jsxs("div",{className:"hidden md:block relative",children:[ks.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),ks.jsx("input",{type:"text",placeholder:"Busca global... (Ctrl+K)",className:"w-64 pl-10 pr-4 py-2.5 bg-gray-50 border border-gray-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 focus:bg-white transition-all duration-200",style:{"--tw-ring-color":i.colors.primary[500]}})]}),ks.jsxs("div",{className:"relative",children:[ks.jsxs("button",{onClick:()=>d(!o),className:"p-2.5 text-gray-400 hover:text-gray-500 hover:bg-gray-100 rounded-xl transition-all duration-200 relative",children:[ks.jsx(is,{className:"h-5 w-5"}),C>0&&ks.jsx("span",{className:"absolute -top-1 -right-1 h-5 w-5 text-white text-xs rounded-full flex items-center justify-center font-bold shadow-sm",style:{backgroundColor:i.colors.primary[500]},children:C})]}),o&&ks.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-xl shadow-xl border border-gray-200 z-50 overflow-hidden",children:[ks.jsx("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:ks.jsxs("div",{className:"flex items-center justify-between",children:[ks.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Notificações"}),C>0&&ks.jsxs("span",{className:"px-2 py-1 text-xs font-medium text-white rounded-full",style:{backgroundColor:i.colors.primary[500]},children:[C," novas"]})]})}),ks.jsx("div",{className:"max-h-64 overflow-y-auto",children:w.map(e=>ks.jsx("div",{className:"p-4 border-b border-gray-100 hover:bg-gray-50 transition-colors cursor-pointer "+(e.unread?"bg-blue-50 border-l-4 border-l-blue-500":""),children:ks.jsxs("div",{className:"flex items-start space-x-3",children:[ks.jsx("div",{className:"w-2 h-2 rounded-full mt-2 "+(e.unread?"bg-blue-500":"bg-gray-300")}),ks.jsxs("div",{className:"flex-1 min-w-0",children:[ks.jsx("p",{className:"text-sm text-gray-900",children:e.message}),ks.jsx("p",{className:"text-xs text-gray-500 mt-1",children:e.time})]})]})},e.id))}),ks.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:ks.jsx("button",{className:"text-sm font-medium hover:text-primary-700 transition-colors",style:{color:i.colors.primary[600]},children:"Ver todas as notificações"})})]})]}),ks.jsx("button",{className:"p-2.5 text-gray-400 hover:text-gray-500 hover:bg-gray-100 rounded-xl transition-all duration-200",children:ks.jsx(xs,{className:"h-5 w-5"})}),ks.jsxs("div",{className:"relative",children:[ks.jsxs("button",{onClick:()=>c(!l),className:"flex items-center space-x-3 p-2 rounded-xl hover:bg-gray-100 transition-all duration-200",children:[ks.jsx("div",{className:"w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center",children:s?.avatar?ks.jsx("img",{src:s.avatar,alt:s.name,className:"w-8 h-8 rounded-full"}):ks.jsx(Ne,{className:"h-4 w-4 text-gray-600"})}),ks.jsxs("div",{className:"hidden md:block text-left",children:[ks.jsx("p",{className:"text-sm font-medium text-gray-900",children:s?.name}),ks.jsx("p",{className:"text-xs text-gray-500",children:s?.email})]}),ks.jsx(hs,{className:"h-4 w-4 text-gray-400"})]}),l&&ks.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-xl border border-gray-200 z-50 overflow-hidden",children:ks.jsxs("div",{className:"py-1",children:[ks.jsxs("button",{className:"flex items-center space-x-2 w-full px-4 py-3 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:[ks.jsx(Ne,{className:"h-4 w-4"}),ks.jsx("span",{children:"Meu Perfil"})]}),ks.jsxs("button",{className:"flex items-center space-x-2 w-full px-4 py-3 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:[ks.jsx(Qe,{className:"h-4 w-4"}),ks.jsx("span",{children:"Configurações"})]}),ks.jsx("hr",{className:"my-1"}),ks.jsxs("button",{onClick:e=>{e.preventDefault(),a()},className:"flex items-center space-x-2 w-full px-4 py-3 text-sm text-red-700 hover:bg-red-50 transition-colors",children:[ks.jsx(us,{className:"h-4 w-4"}),ks.jsx("span",{children:"Sair"})]})]})})]})]})]})}),ks.jsx("main",{className:"flex-1 overflow-auto",children:ks.jsx("div",{className:"p-6",children:e})})]}),(l||o)&&ks.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>{c(!1),d(!1)}})]})},za=({title:e,description:s,icon:t,features:a,color:r})=>ks.jsxs("div",{className:"text-center py-12",children:[ks.jsx("div",{className:"mx-auto mb-4",children:t}),ks.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:e}),ks.jsx("p",{className:"text-gray-600 mb-6",children:s}),ks.jsxs("div",{className:`${r} rounded-lg p-6 max-w-2xl mx-auto`,children:[ks.jsxs("p",{className:"text-sm font-semibold mb-4",children:["🚧 ",ks.jsx("strong",{children:"Em desenvolvimento:"})]}),ks.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-left",children:a.map((e,s)=>ks.jsxs("div",{className:"flex items-center space-x-2",children:[ks.jsx("div",{className:"h-4 w-4 text-green-600",children:"✓"}),ks.jsx("span",{children:e})]},s))})]})]});function Wa(){const{user:e,userType:s}=Ls(),{currentTheme:a}=Ps(),[r,d]=n.useState(!1),[m,x]=n.useState("");t.useEffect(()=>{e&&e.token&&(()=>{const{user:e}=Ls.getState();e&&e.token&&ha.connect(e.token,e.companyId||"master",e.id,e.role)})()},[e]),t.useEffect(()=>{const e=document.documentElement,s=a;e.classList.remove("theme-blue","theme-green","theme-purple"),e.classList.add(`theme-${s.name}`),Object.entries(s.colors.primary).forEach(([s,t])=>{e.style.setProperty(`--primary-${s}`,t)}),e.style.setProperty("--color-primary",s.colors.primary[600]),e.style.setProperty("--color-primary-hover",s.colors.primary[700]),e.style.setProperty("--color-primary-light",s.colors.primary[100]),e.style.setProperty("--color-primary-dark",s.colors.primary[800])},[a]),t.useEffect(()=>{const e=()=>d(!1),s=()=>d(!0);return d(!navigator.onLine),window.addEventListener("online",e),window.addEventListener("offline",s),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s)}},[]),t.useEffect(()=>{m&&Os(m)},[m]);const h=()=>ks.jsx("div",{className:"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-80 bg-yellow-50 border border-yellow-200 rounded-lg p-4 shadow-lg z-50",children:ks.jsxs("div",{className:"flex items-start space-x-3",children:[ks.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-yellow-500 mt-0.5",viewBox:"0 0 20 20",fill:"currentColor",children:ks.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),ks.jsxs("div",{children:[ks.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Modo Offline"}),ks.jsx("p",{className:"mt-1 text-xs text-yellow-700",children:"Você está offline. Algumas funcionalidades podem estar limitadas."})]})]})});return ks.jsx(i,{children:ks.jsxs("div",{className:"min-h-screen bg-gray-50",children:[r&&ks.jsx(h,{}),ks.jsxs(l,{children:[ks.jsx(c,{path:"/master/login",element:e&&"master"===s?ks.jsx(o,{to:"/master"}):ks.jsx(ua,{})}),ks.jsx(c,{path:"/master/*",element:e&&"master"===s?ks.jsx(Fa,{children:ks.jsxs(l,{children:[ks.jsx(c,{path:"/",element:ks.jsx(ga,{})}),ks.jsx(c,{path:"/dashboard",element:ks.jsx(ga,{})}),ks.jsx(c,{path:"/companies",element:ks.jsx(qa,{})}),ks.jsx(c,{path:"/themes",element:ks.jsx($a,{})}),ks.jsx(c,{path:"/settings",element:ks.jsx(Ba,{})})]})}):ks.jsx(o,{to:"/master/login"})}),ks.jsx(c,{path:"/client/login",element:e&&"client"===s?ks.jsx(o,{to:"/client"}):ks.jsx(fa,{})}),ks.jsx(c,{path:"/client/*",element:e&&"client"===s?ks.jsx(Ua,{children:ks.jsxs(l,{children:[ks.jsx(c,{path:"/",element:ks.jsx(ba,{})}),ks.jsx(c,{path:"/dashboard",element:ks.jsx(ba,{})}),ks.jsx(c,{path:"/whatsapp",element:ks.jsx(Na,{companyId:e?.companyId||"company-1"})}),ks.jsx(c,{path:"/whatsapp-monitoring",element:ks.jsx(va,{})}),ks.jsx(c,{path:"/conversations",element:ks.jsx(wa,{})}),ks.jsx(c,{path:"/tags",element:ks.jsx(Ca,{})}),ks.jsx(c,{path:"/users",element:ks.jsx(ka,{})}),ks.jsx(c,{path:"/campaigns",element:ks.jsx(_a,{})}),ks.jsx(c,{path:"/queue",element:ks.jsx(Sa,{})}),ks.jsx(c,{path:"/social-media",element:ks.jsx(Aa,{})}),ks.jsx(c,{path:"/instagram",element:ks.jsx(Ta,{companyId:e?.companyId||"company-1",platform:"instagram"})}),ks.jsx(c,{path:"/facebook",element:ks.jsx(Ta,{companyId:e?.companyId||"company-1",platform:"facebook"})}),ks.jsx(c,{path:"/instagram-monitoring",element:ks.jsx(Ea,{platform:"instagram"})}),ks.jsx(c,{path:"/facebook-monitoring",element:ks.jsx(Ea,{platform:"facebook"})}),ks.jsx(c,{path:"/contacts",element:ks.jsx(za,{title:"Gerenciamento de Contatos",description:"Upload de planilhas e gerenciamento de listas",icon:ks.jsx("div",{className:"h-16 w-16 text-gray-400 mx-auto",children:"📊"}),features:["Upload CSV/Excel","Validação de números","Segmentação avançada","Tags personalizadas","Histórico de interações","Blacklist automática","Sincronização CRM","Backup automático"],color:"bg-indigo-50"})}),ks.jsx(c,{path:"/automations",element:ks.jsx(za,{title:"Automações Inteligentes",description:"Fluxos automatizados e chatbots avançados",icon:ks.jsx("div",{className:"h-16 w-16 text-gray-400 mx-auto",children:"⚡"}),features:["Triggers personalizados","Integração com CRM","IA conversacional","Workflows visuais","Condições complexas","Machine Learning","API integrations","Analytics preditivos"],color:"bg-orange-50"})}),ks.jsx(c,{path:"/settings",element:ks.jsx(za,{title:"Configurações da Empresa",description:"Personalize sua experiência na plataforma",icon:ks.jsx("div",{className:"h-16 w-16 text-gray-400 mx-auto",children:"⚙️"}),features:["Dados da empresa","Configurações de notificação","Integrações externas","Backup e segurança","Personalização visual","Webhooks","API keys","Logs de auditoria"],color:"bg-gray-50"})}),ks.jsx(c,{path:"/whatsapp-report",element:ks.jsx(Ra,{})}),ks.jsx(c,{path:"/conversations-report",element:ks.jsx(La,{})}),ks.jsx(c,{path:"/users-report",element:ks.jsx(Ia,{})}),ks.jsx(c,{path:"/contacts-report",element:ks.jsx(Ma,{})}),ks.jsx(c,{path:"/campaigns-report",element:ks.jsx(Pa,{})}),ks.jsx(c,{path:"/tags-report",element:ks.jsx(Da,{})}),ks.jsx(c,{path:"/queue-report",element:ks.jsx(Oa,{})})]})}):ks.jsx(o,{to:"/client/login"})}),ks.jsx(c,{path:"/",element:ks.jsx(o,{to:"/client/login"})}),ks.jsx(c,{path:"*",element:ks.jsx(o,{to:"/client/login"})})]})]})})}var Va;if("serviceWorker"in navigator&&window.addEventListener("load",()=>{const e=new Blob([zs],{type:"text/javascript"}),s=URL.createObjectURL(e);navigator.serviceWorker.register(s).then(e=>{}).catch(e=>{})}),Va=[],"undefined"!=typeof document&&Va.forEach(e=>{const s=document.createElement("link");s.rel="preload",s.as="image",s.href=function(e,s={}){if(!e)return"";if(e.includes("data:image")||e.endsWith(".svg"))return e;if(e.includes("unsplash.com")){const t=e.split("?")[0],a=s.width||800,r=s.height,n=s.quality||80;let i=`${t}?fm=${s.format||"webp"}&q=${n}&fit=${s.fit||"cover"}&w=${a}`;return r&&(i+=`&h=${r}`),i}return e.includes("pexels.com")?`${e.split("?")[0]}?auto=compress&cs=tinysrgb&w=${s.width||800}&q=${s.quality||80}`:e}(e,{width:800,format:"webp"}),document.head.appendChild(s)}),"undefined"!=typeof document){const e=document.createElement("meta");e.name="theme-color",e.content="#3B82F6",document.head.appendChild(e);const s=document.createElement("link");s.rel="apple-touch-icon",s.href="/icons/apple-touch-icon.png",document.head.appendChild(s);const t=document.createElement("link");t.rel="manifest",t.href="/manifest.json",document.head.appendChild(t)}window.socket=null,Cs(document.getElementById("root")).render(ks.jsx(t.StrictMode,{children:ks.jsx(Wa,{})}));
//# sourceMappingURL=index.DmIIp8Mh.js.map
